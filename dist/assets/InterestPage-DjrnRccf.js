import{y as P,z as L,A as B,B as U,C as r,D as e,L as g,E as $,F as q,G as z,q as F,f as H,a as c,w as O,e as T,g as p,d as y,H as A,I as R}from"./index-Eut2KIY5.js";import{U as Y}from"./user-check-BzH4u_-N.js";import"./pdfjs-CN6VhWT3.js";function J(){const{slug:o}=P(),[d]=L(),b=B(),{showSuccess:w,showError:j}=U(),n=d.get("leadId"),m=d.get("r"),[N,v]=r.useState(!0),[u,x]=r.useState(!1),[s,C]=r.useState(null),[h,I]=r.useState(""),[f,S]=r.useState("");r.useEffect(()=>{async function i(){try{let t=null;const D=F(H(c,"companies"),O("appSlug","==",o)),l=await T(D);if(!l.empty)t={id:l.docs[0].id,...l.docs[0].data()};else{const a=await p(y(c,"companies",o));a.exists()&&(t={id:a.id,...a.data()})}if(!t)throw new Error("Company not found.");if(C(t),n){const a=await p(y(c,"leads",n));a.exists()&&I(a.data().firstName||"Driver")}}catch(t){console.error("Load error:",t),S(t.message||"Invalid link.")}finally{v(!1)}}i()},[o,n]);const k=async()=>{x(!0);try{await A(R,"confirmDriverInterest")({leadId:n,companyIdOrSlug:s.id,recruiterId:m}),w("Interest confirmed! Redirecting to application..."),setTimeout(()=>{b(`/apply/${o}?r=${m}&prefill=${n}`)},1500)}catch(i){console.error("Interest Error:",i),j("Could not confirm interest. Please try again."),x(!1)}},E=()=>{alert("Thank you. We have noted your response."),window.location.href="https://google.com"};return N?e.jsx("div",{className:"h-screen flex items-center justify-center",children:e.jsx(g,{className:"animate-spin text-blue-600"})}):f?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white p-8 rounded-xl shadow text-center max-w-md",children:[e.jsx($,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Link Expired or Invalid"}),e.jsx("p",{className:"text-gray-500 mt-2",children:f})]})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-white flex flex-col items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white max-w-md w-full rounded-2xl shadow-xl overflow-hidden border border-gray-100",children:[e.jsxs("div",{className:"bg-blue-600 p-6 text-center",children:[s.logoUrl?e.jsx("img",{src:s.logoUrl,alt:s.companyName,className:"h-12 mx-auto bg-white p-1 rounded"}):e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-full flex items-center justify-center mx-auto text-white",children:e.jsx(q,{size:32})}),e.jsxs("h1",{className:"text-white font-bold text-xl mt-4",children:["Opportunity at ",s.companyName]})]}),e.jsxs("div",{className:"p-8 text-center",children:[e.jsxs("div",{className:"inline-flex items-center gap-2 bg-blue-50 text-blue-700 px-4 py-2 rounded-full text-sm font-medium mb-6",children:[e.jsx(Y,{size:16}),h?`Hi, ${h}!`:"Hello!"]}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Are you interested?"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Our recruiting team has identified you as a great match for our open lanes. Click below to confirm your interest and start your secure application."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:k,disabled:u,className:"w-full py-4 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-xl text-lg shadow-lg shadow-blue-200 transition-all flex items-center justify-center gap-2",children:[u?e.jsx(g,{className:"animate-spin"}):e.jsx(z,{}),"Yes, I'm Interested"]}),e.jsx("button",{onClick:E,className:"w-full py-4 bg-white border border-gray-200 text-gray-500 font-medium rounded-xl hover:bg-gray-50 transition-all",children:"No, not right now"})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-6",children:["By clicking Yes, you agree to share your contact profile with ",s.companyName,"."]})]})]})})}export{J as InterestPage};
