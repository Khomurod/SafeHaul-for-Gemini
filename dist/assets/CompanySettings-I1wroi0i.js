const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AudienceBuilder-CBhim3gH.js","assets/index-Eut2KIY5.js","assets/pdfjs-CN6VhWT3.js","assets/index-BZGRJBJ7.css","assets/useBulkImport-DleduGt8.js","assets/index-DjK99qPH.js","assets/ContentComposer-bZyOmz7y.js","assets/LaunchPad-o06JMcZn.js","assets/send-DbngQNm2.js","assets/beaker-BDw6Lckq.js","assets/save-xDZOd2sT.js","assets/check-D3G6pll6.js","assets/CustomQuestionsBuilder-C9bbau8M.js","assets/trash-2-RTc4kdO5.js","assets/plus-DHyG1REA.js","assets/circle-BoyhTIEe.js","assets/shield-alert-CyrU0uX3.js","assets/shield-B8dSCmK2.js","assets/storage-gYyq0gBL.js","assets/pen-DKw8HDfG.js","assets/credit-card-DXG0d7j1.js","assets/dollar-sign-DE8xXdSp.js","assets/history-1Q_UTirS.js"])))=>i.map(i=>d[i]);
import{c as U,C as l,B as q,q as G,w as oe,f as H,a as T,aa as ae,g as ie,d as L,D as e,aB as J,X as ye,L as $,ah as ce,o as ge,H as I,I as O,G as W,T as _e,U as de,a1 as se,aC as Ke,e as re,h as Xe,v as ee,a9 as Re,a8 as le,S as je,$ as Ze,aD as Se,aE as es,Y as te,as as $e,a7 as Ue,x as Z,a2 as xe,ae as ss,W as he,a3 as ts,az as me,ab as Ne,R as pe,_ as ve,aA as qe,M as Ie,af as ue,V as Oe,y as as,E as rs,Z as ls,A as ns,a4 as is}from"./index-Eut2KIY5.js";import{S as os}from"./send-DbngQNm2.js";import{B as cs}from"./beaker-BDw6Lckq.js";import{S as ne}from"./save-xDZOd2sT.js";import{C as Be}from"./check-D3G6pll6.js";import{E as ds,A as ze,B as He,H as Te,C as xs,S as Ae,a as ms,P as us,b as Ve,T as gs}from"./CustomQuestionsBuilder-C9bbau8M.js";import{S as Pe}from"./shield-B8dSCmK2.js";import{L as we,b as hs,S as ps,C as Ge,c as Je}from"./shield-alert-CyrU0uX3.js";import{u as bs}from"./storage-gYyq0gBL.js";import{P as Ye}from"./pen-DKw8HDfG.js";import{P as ke}from"./plus-DHyG1REA.js";import{C as fs,a as ys,b as Me}from"./credit-card-DXG0d7j1.js";import{D as js}from"./dollar-sign-DE8xXdSp.js";import{T as Ce}from"./trash-2-RTc4kdO5.js";import{C as Ns}from"./circle-BoyhTIEe.js";import{H as vs}from"./history-1Q_UTirS.js";const ws=[["path",{d:"M10 22V7a1 1 0 0 0-1-1H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-5a1 1 0 0 0-1-1H2",key:"1ah6g2"}],["rect",{x:"14",y:"2",width:"8",height:"8",rx:"1",key:"88lufb"}]],We=U("blocks",ws);const ks=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]],Cs=U("circle-pause",ks);const Ss=[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],zs=U("circle-play",Ss);const Ts=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],Le=U("facebook",Ts);const As=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Ps=U("layout-grid",As);const Ms=[["path",{d:"M13 5h8",key:"a7qcls"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 19h8",key:"c3s6r1"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}]],Ls=U("list-checks",Ms);const Es=[["path",{d:"M11 6a13 13 0 0 0 8.4-2.8A1 1 0 0 1 21 4v12a1 1 0 0 1-1.6.8A13 13 0 0 0 11 14H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2z",key:"q8bfy3"}],["path",{d:"M6 14a12 12 0 0 0 2.4 7.2 2 2 0 0 0 3.2-2.4A8 8 0 0 1 10 14",key:"1853fq"}],["path",{d:"M8 6v8",key:"15ugcq"}]],Ds=U("megaphone",Es);const Fs=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],_s=U("pencil",Fs);const Rs=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],fe=U("rocket",Rs);const $s=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],Us=U("smartphone",$s);const qs=[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]],Is=U("test-tube",qs);const Os=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],Bs=U("wifi",Os);function Hs({companyId:s,onClose:c}){const[x,t]=l.useState([]),[a,d]=l.useState(!0),[n,h]=l.useState(""),[g,m]=l.useState("Current Company"),[y,o]=l.useState(null),[j,b]=l.useState(null),{showSuccess:p,showInfo:N,showError:r}=q(),u=window.location.origin;l.useEffect(()=>{if(!s)return;(async()=>{try{const F=await ie(L(T,"companies",s));if(F.exists()){const D=F.data();h(D.appSlug||s),m(D.companyName||"Current Company")}}catch(F){console.warn("Error fetching company info:",F)}})();const w=G(H(T,"memberships"),oe("companyId","==",s)),A=ae(w,async F=>{const D=[];for(const V of F.docs){const k=V.data(),P=k.userId;let S={name:"Unknown",email:"No Email"};try{const M=await ie(L(T,"users",P));M.exists()&&(S=M.data())}catch(M){console.log("Error fetching user:",M)}let E={callGoal:150,contactGoal:50};try{const M=await ie(L(T,"companies",s,"team",P));if(M.exists()){const _=M.data();E={callGoal:_.callGoal||150,contactGoal:_.contactGoal||50}}}catch(M){console.log("Error fetching goals:",M)}D.push({id:P,...S,role:k.role,...E})}t(D),d(!1)});return()=>A()},[s]);const v=i=>{const A=`${u.replace(/\/$/,"")}/apply/${n}?recruiter=${i}`;navigator.clipboard.writeText(A),p("Custom recruiter link copied!")},f=async(i,w,A)=>{try{await ge(L(T,"companies",s,"team",i),{[w]:Number(A),updatedAt:new Date},{merge:!0})}catch(F){console.error(F),alert("Error saving goal")}},C=async(i,w)=>{if(window.confirm(`Are you sure you want to remove ${w||"this user"} from the team?`)){b(i);try{await I(O,"deletePortalUser")({userId:i,companyId:s}),p(`${w||"User"} has been removed from the team.`)}catch(A){console.error("Error deleting user:",A),r("Failed to remove user: "+(A.message||"Unknown error"))}finally{b(null)}}},z=l.useMemo(()=>{const i=new Map;return i.set(s,g),i},[s,g]);return e.jsxs("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl border border-gray-200 flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex justify-between items-center bg-gray-50 rounded-t-xl",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(J,{className:"text-blue-600"})," Manage Team & Links"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Set goals and get tracking links for your recruiters."})]}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-200 rounded-full",children:e.jsx(ye,{size:20})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:e.jsx("div",{children:a?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx($,{className:"animate-spin mx-auto mb-2"})," Loading team..."]}):x.length===0?e.jsx("p",{className:"text-center text-gray-400 italic py-4",children:"No members found."}):e.jsx("div",{className:"space-y-3",children:x.map(i=>e.jsxs("div",{className:"flex flex-col lg:flex-row items-center justify-between p-4 bg-white border border-gray-200 rounded-lg shadow-sm gap-4 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 w-full lg:w-1/3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-600 font-bold shrink-0",children:i.name?i.name.charAt(0).toUpperCase():"?"}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsx("p",{className:"font-bold text-gray-900 truncate",children:i.name||"Unknown"}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:i.email})]})]}),e.jsxs("div",{className:"flex gap-4 items-center w-full lg:w-auto",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded-lg border border-gray-100",children:[e.jsx(ce,{size:14,className:"text-blue-500"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"Dials"}),e.jsx("input",{type:"number",className:"w-12 p-0 text-sm bg-transparent border-none text-center font-bold focus:ring-0 outline-none",defaultValue:i.callGoal,onBlur:w=>f(i.id,"callGoal",w.target.value)})]})]}),e.jsxs("div",{className:"flex items-center gap-2 bg-gray-50 p-2 rounded-lg border border-gray-100",children:[e.jsx(J,{size:14,className:"text-green-600"}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"text-[8px] font-bold text-gray-400 uppercase",children:"Contacts"}),e.jsx("input",{type:"number",className:"w-12 p-0 text-sm bg-transparent border-none text-center font-bold focus:ring-0 outline-none",defaultValue:i.contactGoal,onBlur:w=>f(i.id,"contactGoal",w.target.value)})]})]}),e.jsxs("button",{onClick:()=>v(i.id),className:"flex items-center gap-2 px-3 py-2 bg-purple-50 text-purple-700 hover:bg-purple-100 rounded-lg border border-purple-200 transition-colors text-sm font-semibold ml-2",title:"Copy Custom Tracking Link",children:[e.jsx(we,{size:14})," Link"]}),e.jsx("button",{onClick:()=>o(i.id),className:"flex items-center gap-2 px-3 py-2 bg-blue-50 text-blue-700 hover:bg-blue-100 rounded-lg border border-blue-200 transition-colors text-sm font-semibold",title:"Edit User",children:e.jsx(_s,{size:14})}),e.jsx("button",{onClick:()=>C(i.id,i.name),disabled:j===i.id,className:"flex items-center gap-2 px-3 py-2 bg-red-50 text-red-700 hover:bg-red-100 rounded-lg border border-red-200 transition-colors text-sm font-semibold disabled:opacity-50",title:"Remove from Team",children:j===i.id?e.jsx($,{size:14,className:"animate-spin"}):e.jsx(Ce,{size:14})})]})]},i.id))})})})]}),y&&e.jsx(ds,{userId:y,companyId:s,allCompaniesMap:z,onClose:()=>o(null),onSave:()=>{}})]})}function Vs({companyId:s,inventory:c,onClose:x}){const{showSuccess:t,showError:a}=q(),[d,n]=l.useState(!1),[h,g]=l.useState(!1),[m,y]=l.useState(null),[o,j]=l.useState(""),[b,p]=l.useState(""),N=async()=>{g(!0),y(null);try{const v=await I(O,"verifySmsConfig")({companyId:s});y({success:!0,message:v.data.message})}catch(u){y({success:!1,message:u.message})}finally{g(!1)}},r=async u=>{if(u.preventDefault(),!o){a("Please enter a destination phone number.");return}n(!0);try{await I(O,"sendTestSMS")({companyId:s,testPhoneNumber:o,fromNumber:b||null}),t(`Test message sent to ${o}`),x()}catch(v){console.error(v),a(v.message||"Failed to send test.")}finally{n(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-50 p-4 animate-in fade-in",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-md w-full overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-100 flex justify-between items-center",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Us,{size:18,className:"text-blue-600"}),"SMS Diagnostic Lab"]}),e.jsx("button",{onClick:x,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(ye,{size:20})})]}),e.jsxs("form",{onSubmit:r,className:"p-6 space-y-5",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5",children:"Send From (Source)"}),e.jsxs("select",{className:"w-full p-2.5 border border-gray-300 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:b,onChange:u=>p(u.target.value),children:[e.jsx("option",{value:"",children:"System Default (Auto-Route)"}),e.jsx("optgroup",{label:"Inventory Numbers",children:c.map(u=>e.jsxs("option",{value:u.phoneNumber,children:[u.phoneNumber," ",u.usageType?`(${u.usageType})`:""]},u.phoneNumber))})]}),e.jsx("p",{className:"text-[10px] text-gray-400 mt-1",children:"Choose specific number to verify individual line functionality."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5",children:"Send To (Destination)"}),e.jsx("input",{type:"tel",placeholder:"+1 (555) 000-0000",className:"w-full p-2.5 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none",value:o,onChange:u=>j(u.target.value)})]}),e.jsxs("div",{className:"pt-2 space-y-3",children:[e.jsxs("button",{type:"button",onClick:N,disabled:h,className:"w-full py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold rounded-lg flex items-center justify-center gap-2 transition-all disabled:opacity-70",children:[h?e.jsx($,{size:18,className:"animate-spin"}):e.jsx(W,{size:18}),h?"Verifying...":"Verify Configuration"]}),m&&e.jsxs("div",{className:`p-3 rounded-lg text-xs flex items-start gap-2 ${m.success?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:[m.success?e.jsx(W,{className:"w-4 h-4 mt-0.5"}):e.jsx(_e,{className:"w-4 h-4 mt-0.5"}),e.jsx("span",{className:"flex-1",children:m.message})]}),e.jsxs("button",{type:"submit",disabled:d,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg flex items-center justify-center gap-2 transition-all disabled:opacity-70",children:[d?e.jsx($,{size:18,className:"animate-spin"}):e.jsx(os,{size:18}),d?"Sending Test...":"Send Test Message"]})]})]})]})})}function Gs({companyId:s}){const{showSuccess:c,showError:x}=q(),[t,a]=l.useState(null),[d,n]=l.useState([]),[h,g]=l.useState(!0),[m,y]=l.useState(!1),[o,j]=l.useState(null),[b,p]=l.useState({}),[N,r]=l.useState({}),[u,v]=l.useState({}),[f,C]=l.useState(""),[z,i]=l.useState(!1),w=k=>{if(!k)return"";const P=k.replace(/[^0-9+]/g,"");return P.startsWith("+")?P:`+${P}`},A=JSON.stringify(N)!==JSON.stringify(u)||f!==(t?.defaultPhoneNumber||t?.config?.defaultPhoneNumber||"");l.useEffect(()=>{if(!s)return;const k=ae(L(T,"companies",s,"integrations","sms_provider"),S=>{if(S.exists()){const E=S.data();console.log("[SMS Config] Loaded Data:",E),a(E);const M=E.assignments||{},_={};Object.keys(M).forEach(R=>{_[R]=w(M[R])}),r(_),v(JSON.parse(JSON.stringify(_))),C(w(E.defaultPhoneNumber||E.config?.defaultPhoneNumber||""))}else console.log("[SMS Config] Document does not exist."),a(null);g(!1)});return(async()=>{try{const S=G(H(T,"memberships"),oe("companyId","==",s)),E=await re(S),M={},_=[];if(E.docs.forEach(Q=>{const K=Q.data();K.userId&&(_.push(K.userId),M[K.userId]=K.role)}),_.length===0){n([]);return}const R=30,Y=[];for(let Q=0;Q<_.length;Q+=R){const K=_.slice(Q,Q+R),Qe=G(H(T,"users"),oe(Xe(),"in",K));(await re(Qe)).docs.forEach(be=>{Y.push({id:be.id,...be.data(),role:M[be.id]})})}n(Y)}catch(S){console.error("Error fetching users for assignment",S)}})(),()=>k()},[s]);const F=async k=>{if(k){j(k);try{const S=await I(O,"verifyLineConnection")({companyId:s,phoneNumber:k});p(E=>({...E,[k]:{success:!0,identity:S.data.identity,timestamp:S.data.timestamp}})),c(`Line ${k} is active (${S.data.identity})`)}catch(P){console.error(`Verification Failed: ${k}`,P),p(S=>({...S,[k]:{success:!1,error:P.message,timestamp:new Date().toISOString()}})),x(`Line ${k} connection failed: ${P.message}`)}finally{j(null)}}},D=async()=>{y(!0);try{const k=L(T,"companies",s,"integrations","sms_provider");await ee(k,{assignments:N,defaultPhoneNumber:w(f),updatedAt:new Date}),v(JSON.parse(JSON.stringify(N))),c("Assignments updated successfully.")}catch(k){console.error(k),x("Failed to save assignments.")}finally{y(!1)}};if(l.useEffect(()=>{const k=P=>{A&&(P.preventDefault(),P.returnValue="")};return window.addEventListener("beforeunload",k),()=>window.removeEventListener("beforeunload",k)},[A]),h)return e.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:"Loading inventory..."});if(!t||!t.isActive)return e.jsxs("div",{className:"bg-orange-50 p-6 rounded-xl border border-orange-100 text-center",children:[e.jsx(de,{className:"mx-auto text-orange-400 mb-2"}),e.jsx("h3",{className:"text-orange-800 font-bold",children:"SMS Integration Not Active"}),e.jsx("p",{className:"text-orange-600 text-sm mt-1",children:"Please contact a Super Admin to enable SMS for your company."})]});const V=t.inventory||[];return V.length===0?e.jsxs("div",{className:"bg-gray-50 p-8 rounded-xl border border-gray-200 text-center",children:[e.jsx(ce,{className:"mx-auto text-gray-400 mb-3",size:32}),e.jsx("h3",{className:"text-gray-900 font-bold",children:"No Numbers Found"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"We couldn't find any phone numbers connected to your provider account."}),e.jsxs("button",{className:"mt-4 text-blue-600 hover:underline text-sm font-medium flex items-center justify-center gap-2 mx-auto",children:[e.jsx(se,{size:14})," Refresh Inventory"]})]}):e.jsxs("div",{className:"space-y-6 max-w-5xl animate-in fade-in",children:[e.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200 pb-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(ce,{className:"text-blue-600",size:24})," Number Assignments"]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["inventory: ",V.length," numbers available"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[A&&e.jsxs("span",{className:"flex items-center gap-1.5 text-[10px] font-bold text-orange-600 bg-orange-50 px-2.5 py-1 rounded-full border border-orange-200 animate-pulse",children:[e.jsx(de,{size:12})," UNSAVED CHANGES"]}),e.jsxs("button",{onClick:()=>i(!0),className:"px-3 py-2 text-blue-700 bg-blue-50 border border-blue-200 rounded-lg hover:bg-blue-100 flex items-center gap-2 text-sm font-medium transition-colors",children:[e.jsx(cs,{size:16}),"Diagnostic Lab"]}),e.jsxs("button",{onClick:D,disabled:m,className:`px-4 py-2 rounded-lg font-bold transition-all flex items-center gap-2 shadow-sm disabled:opacity-50 ${A?"bg-orange-600 hover:bg-orange-700 text-white shadow-orange-200":"bg-blue-600 hover:bg-blue-700 text-white"}`,children:[m?e.jsx(se,{className:"animate-spin",size:18}):e.jsx(ne,{size:18}),A?"Save Changes Now":"Save Changes"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("div",{className:"flex justify-between items-start mb-4",children:e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Be,{className:"text-green-500",size:18})," Company Default Line"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Used for automated system messages and unassigned recruiters."})]})}),e.jsxs("div",{className:"flex gap-3 max-w-lg",children:[e.jsxs("select",{value:w(f),onChange:k=>C(w(k.target.value)),className:"flex-1 p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-mono text-sm",children:[e.jsx("option",{value:"",children:"-- Select Default Number --"}),V.map(k=>{const P=w(k.phoneNumber);return e.jsxs("option",{value:P,children:[P," (",k.usageType||"Line",")"]},k.phoneNumber)})]}),f&&e.jsx("button",{onClick:()=>F(f),disabled:o===f,className:"px-4 py-2 border border-gray-200 rounded-lg hover:bg-gray-50 disabled:opacity-50 text-gray-600 focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Verify Connectivity",children:o===f?e.jsx(se,{size:16,className:"animate-spin"}):b[f]?.success?e.jsx(Bs,{size:16,className:"text-green-500"}):b[f]?.success===!1?e.jsx(Ke,{size:16,className:"text-red-500"}):e.jsx(ze,{size:16})})]}),b[f]&&e.jsx("div",{className:`mt-3 p-2 rounded text-[10px] flex items-center gap-2 ${b[f].success?"bg-green-50 text-green-700":"bg-red-50 text-red-700"}`,children:b[f].success?e.jsxs(e.Fragment,{children:[e.jsx(Pe,{size:12}),"Verified: ",b[f].identity]}):e.jsxs(e.Fragment,{children:[e.jsx(hs,{size:12}),"Error: ",b[f].error]})})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100",children:[e.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(J,{className:"text-purple-500",size:18})," Recruiter Assignments"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Assign strict 1:1 lines for your team members."})]}),e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 text-xs font-bold text-gray-500 uppercase",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 border-b border-gray-100",children:"Team Member"}),e.jsx("th",{className:"px-6 py-3 border-b border-gray-100",children:"Role"}),e.jsx("th",{className:"px-6 py-3 border-b border-gray-100",children:"Assigned Number"}),e.jsx("th",{className:"px-6 py-3 border-b border-gray-100",children:"Connection"}),e.jsx("th",{className:"px-6 py-3 border-b border-gray-100 w-10 text-center",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:d.map(k=>{const P=N[k.id]||"",S=w(P),E=!!S,M=V.find(R=>w(R.phoneNumber)===S),_=M?.hasDedicatedCredentials;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 text-sm font-medium text-gray-900 border-r border-gray-50",children:[k.name||k.fullName||k.email,e.jsx("div",{className:"text-xs text-gray-400 font-normal",children:k.email})]}),e.jsx("td",{className:"px-6 py-4 text-xs text-gray-500 uppercase tracking-wider",children:k.role?.replace("_"," ")}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("select",{value:S,onChange:R=>r(Y=>({...Y,[k.id]:w(R.target.value)})),className:`w-full p-2 border rounded text-sm outline-none transition-all ${E?"border-purple-200 bg-purple-50 text-purple-700 font-mono":"border-gray-200 text-gray-400"}`,children:[e.jsx("option",{value:"",children:"No Direct Line"}),V.map(R=>{const Y=w(R.phoneNumber);return e.jsx("option",{value:Y,children:Y},R.phoneNumber)}),E&&!M&&e.jsxs("option",{value:S,children:[S," (Missing from sync)"]})]}),E&&_&&e.jsxs("div",{className:"flex items-center gap-1 text-[9px] text-blue-600 font-bold uppercase tracking-tighter",children:[e.jsx(Pe,{size:10})," Dedicated Credentials"]})]})}),e.jsx("td",{className:"px-6 py-4",children:E?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>F(S),disabled:o===S,className:"p-1.5 hover:bg-gray-100 rounded-md transition-colors disabled:opacity-50",title:"Verify Connection",children:o===S?e.jsx(se,{size:14,className:"animate-spin text-gray-400"}):e.jsx(ze,{size:14,className:b[S]?"text-blue-500":"text-gray-400"})}),b[S]?e.jsx("span",{className:`text-[10px] font-medium ${b[S].success?"text-green-600":"text-red-600"}`,children:b[S].success?"Connected":"Failed"}):E&&!M?e.jsx("span",{className:"text-[10px] text-orange-500 font-medium",children:"Inventory Mismatch"}):e.jsx("span",{className:"text-[10px] text-gray-400",children:"Untested"})]}):e.jsx("span",{className:"text-gray-300",children:"-"})}),e.jsx("td",{className:"px-6 py-4 text-center",children:E?e.jsx("div",{className:`w-2 h-2 rounded-full mx-auto ${b[S]?b[S].success===!1?"bg-red-500":"bg-green-500":M?"bg-blue-400":"bg-orange-400"}`,title:b[S]?b[S].success===!1?"Connection Error":"Active":"Untested"}):e.jsx("div",{className:"w-2 h-2 rounded-full bg-gray-200 mx-auto",title:"No Assignment"})})]},k.id)})})]}),d.length===0&&e.jsx("div",{className:"p-8 text-center text-gray-400 text-sm",children:"No team members found."})]}),z&&e.jsx(Vs,{companyId:s,inventory:V,onClose:()=>i(!1)})]})}const Js=[{value:"cpm",label:"Cents Per Mile (CPM)"},{value:"percentage",label:"Percentage of Load (%)"},{value:"flatRate",label:"Flat Weekly Rate ($)"},{value:"hourly",label:"Hourly Rate ($)"}],Ys=[{value:"lessThan6Months",label:"Less than 6 Months"},{value:"lessThan1Year",label:"Less than 1 Year"},{value:"moreThan1Year",label:"More than 1 Year"},{value:"moreThan2Years",label:"More than 2 Years"},{value:"moreThan5Years",label:"More than 5 Years"}],Ws=["Dry Van","Reefer","Flatbed","Tanker","Box Truck","Car Hauler","Step Deck","Lowboy","Conestoga","Intermodal","Power Only","Hotshot"],Qs=[{id:"healthInsurance",label:"Health Insurance"},{id:"dental",label:"Dental Insurance"},{id:"vision",label:"Vision Insurance"},{id:"retirement401k",label:"401(k) Retirement"},{id:"signOnBonus",label:"Sign-on Bonus"},{id:"petPolicy",label:"Pet Policy"},{id:"riderPolicy",label:"Rider Policy"},{id:"newEquipment",label:"New Equipment (2022+)"},{id:"fuelCard",label:"Fuel Card / Discounts"},{id:"paidOrientation",label:"Paid Orientation"}],X={enabled:!1,payType:"cpm",cpm:{min:"",max:""},percentage:{min:"",max:""},flatRate:{amount:""},hourly:{amount:""},experienceRequired:"moreThan1Year",hiringGeography:{nationwide:!0,states:[]},freightTypes:[],homeTime:"Weekly",benefits:{}},Ks={companyDriver:{enabled:!1,solo:{...X},team:{...X}},ownerOperator:{enabled:!1,solo:{...X},team:{...X}},leaseOperator:{enabled:!1,solo:{...X},team:{...X}},benefits:{coversTransportation:!1,coversHotel:!1}};function Xs({companyLogoUrl:s,isEditing:c,logoUploading:x,onLogoUpload:t}){return e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-32 h-32 bg-gray-50 rounded-xl flex items-center justify-center border border-gray-200 overflow-hidden shadow-inner",children:s?e.jsx("img",{src:s,alt:"Logo",className:"w-full h-full object-contain"}):e.jsx(He,{className:"text-gray-400",size:48})}),c&&e.jsxs("label",{className:"cursor-pointer px-3 py-1.5 bg-blue-50 text-blue-600 rounded-md text-xs font-bold hover:bg-blue-100 transition-colors",children:[x?"Uploading...":"Change Logo",e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:t,disabled:x})]})]})}function Zs({compData:s,isEditing:c,logoUploading:x,onLogoUpload:t,onFieldChange:a}){return e.jsxs("div",{className:"space-y-6 animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 flex flex-col md:flex-row gap-8 shadow-sm",children:[e.jsx(Xs,{companyLogoUrl:s.companyLogoUrl,isEditing:c,logoUploading:x,onLogoUpload:t}),e.jsxs("div",{className:"flex-1 space-y-4 w-full",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Company Name"}),c?e.jsx("input",{type:"text",value:s.companyName||"",onChange:d=>a("companyName",d.target.value),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none font-bold text-gray-900"}):e.jsx("p",{className:"text-xl font-bold text-gray-900",children:s.companyName||"Not Set"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"MC Number"}),c?e.jsxs("div",{className:"relative",children:[e.jsx(Te,{size:14,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",value:s.mcNumber||"",onChange:d=>a("mcNumber",d.target.value),className:"w-full pl-9 p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}):e.jsx("p",{className:"text-sm font-medium text-gray-800 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200",children:s.mcNumber||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"DOT Number"}),c?e.jsxs("div",{className:"relative",children:[e.jsx(Te,{size:14,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",value:s.dotNumber||"",onChange:d=>a("dotNumber",d.target.value),className:"w-full pl-9 p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"})]}):e.jsx("p",{className:"text-sm font-medium text-gray-800 bg-gray-50 px-3 py-2 rounded-lg border border-gray-200",children:s.dotNumber||"N/A"})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsx(et,{compData:s,isEditing:c,onFieldChange:a}),e.jsx(st,{compData:s,isEditing:c,onFieldChange:a})]})]})}function et({compData:s,isEditing:c,onFieldChange:x}){return e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-gray-900 border-b border-gray-100 pb-2 mb-4 flex items-center gap-2",children:[e.jsx(ce,{size:18,className:"text-blue-600"})," Contact Info"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Phone"}),c?e.jsx("input",{type:"text",value:s.phone||"",onChange:t=>x("phone",t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}):e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Email"}),c?e.jsx("input",{type:"email",value:s.email||"",onChange:t=>x("email",t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}):e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.email||"N/A"})]})]})]})}function st({compData:s,isEditing:c,onFieldChange:x}){return e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-gray-900 border-b border-gray-100 pb-2 mb-4 flex items-center gap-2",children:[e.jsx(Re,{size:18,className:"text-blue-600"})," HQ Address"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Street"}),c?e.jsx("input",{type:"text",value:s.street||"",onChange:t=>x("street",t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}):e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.street||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"City"}),c?e.jsx("input",{type:"text",value:s.city||"",onChange:t=>x("city",t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}):e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.city||"N/A"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"State"}),c?e.jsx("input",{type:"text",value:s.state||"",onChange:t=>x("state",t.target.value),maxLength:2,className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}):e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.state||"XX"})]}),e.jsxs("div",{className:"col-span-1",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Zip"}),c?e.jsx("input",{type:"text",value:s.zip||"",onChange:t=>x("zip",t.target.value),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none"}):e.jsx("p",{className:"text-sm font-medium text-gray-800",children:s.zip||"00000"})]})]})]})]})}const Ee=[{id:"ssn",label:"Social Security Number",defaultReq:!0},{id:"dob",label:"Date of Birth",defaultReq:!0},{id:"addressHistory",label:"3 Years Address History",defaultReq:!0},{id:"employmentHistory",label:"Employment History (3-10 Yrs)",defaultReq:!0},{id:"cdlUpload",label:"CDL Document Upload",defaultReq:!0},{id:"medCardUpload",label:"Medical Card Upload",defaultReq:!1},{id:"mvrConsent",label:"MVR Consent Form",defaultReq:!0},{id:"referralSource",label:"Referral Source",defaultReq:!1}];function tt({config:s,onChange:c}){const x=s||{},t=(a,d)=>{let h={...x[a]||{required:Ee.find(g=>g.id===a)?.defaultReq||!1,hidden:!1}};d==="required"?(h.required=!h.required,h.required&&(h.hidden=!1)):d==="hidden"&&(h.hidden=!h.hidden,h.hidden&&(h.required=!1)),c({...x,[a]:h})};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl shadow-sm overflow-hidden mb-8",children:[e.jsxs("div",{className:"p-4 bg-gray-50 border-b border-gray-200 flex items-center gap-2",children:[e.jsx(ps,{size:18,className:"text-gray-500"}),e.jsx("h3",{className:"font-bold text-gray-800",children:"Standard DOT Questions Configuration"})]}),e.jsx("div",{className:"p-0",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-white text-gray-500 font-bold border-b border-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"p-4",children:"Field Name"}),e.jsx("th",{className:"p-4 text-center w-32",children:"Required"}),e.jsx("th",{className:"p-4 text-center w-32",children:"Hidden"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:Ee.map(a=>{const d=x[a.id]||{required:a.defaultReq,hidden:!1};return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"p-4 font-medium text-gray-700",children:a.label}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("button",{onClick:()=>t(a.id,"required"),className:`w-10 h-6 rounded-full relative transition-colors ${d.required?"bg-green-500":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow-sm transition-transform ${d.required?"translate-x-4":"translate-x-0"}`})})}),e.jsx("td",{className:"p-4 text-center",children:e.jsx("button",{onClick:()=>t(a.id,"hidden"),className:`w-10 h-6 rounded-full relative transition-colors ${d.hidden?"bg-red-500":"bg-gray-200"}`,children:e.jsx("div",{className:`absolute top-1 left-1 w-4 h-4 bg-white rounded-full shadow-sm transition-transform ${d.hidden?"translate-x-4":"translate-x-0"}`})})})]},a.id)})})]})}),e.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-200 text-xs text-gray-500",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," Hiding DOT required fields (like SSN or Employment History) may make your application non-compliant."]})})]})}function at({compData:s,isCompanyAdmin:c,onConfigChange:x,onQuestionsChange:t,onSave:a,loading:d}){return e.jsxs("div",{className:"space-y-8 animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Standard DOT Questions"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Configure visibility and requirements for standard application fields."})]}),c?e.jsx(tt,{config:s.applicationConfig,onChange:x}):e.jsx("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded-lg text-center text-gray-500",children:e.jsx("p",{children:"Read-only view for standard questions."})})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Ge,{size:20,className:"text-blue-600"})," Custom Questions"]}),e.jsx("p",{className:"text-sm text-gray-500",children:'Add specific questions for your company (e.g. "Do you have flatbed experience?").'})]}),c?e.jsx(xs,{questions:s.customQuestions||[],onChange:t,onSave:a,loading:d}):e.jsx("div",{className:"p-6 bg-gray-50 border border-gray-200 rounded-xl text-center text-gray-500",children:e.jsx("p",{children:"Only Company Admins can edit application questions."})})]})]})}function rt(){return e.jsxs("div",{className:"animate-in slide-in-from-bottom-2",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(le,{size:20,className:"text-blue-600"})," Hiring Positions & Offers"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"This section has moved to the new Job Board."})]}),e.jsxs("div",{className:"p-10 bg-blue-50 border border-blue-100 rounded-xl text-center",children:[e.jsx(le,{size:40,className:"mx-auto text-blue-500 mb-4"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"We've moved!"}),e.jsxs("p",{className:"text-gray-600 max-w-md mx-auto mb-6",children:["Job postings are now managed in the dedicated ",e.jsx("strong",{children:"Job Board"})," section of your company settings."]})]})]})}function lt({currentCompanyProfile:s}){const{showSuccess:c,showError:x}=q(),{currentUserClaims:t}=je(),[a,d]=l.useState("info"),[n,h]=l.useState({}),[g,m]=l.useState(!1),[y,o]=l.useState(!1),[j,b]=l.useState(!1),p=t?.roles?.[s.id]==="company_admin"||t?.roles?.globalRole==="super_admin";l.useEffect(()=>{s&&h({companyName:s.companyName||"",phone:s.contact?.phone||"",email:s.contact?.email||"",street:s.address?.street||"",city:s.address?.city||"",state:s.address?.state||"",zip:s.address?.zip||"",mcNumber:s.legal?.mcNumber||"",dotNumber:s.legal?.dotNumber||"",companyLogoUrl:s.companyLogoUrl||"",applicationConfig:s.applicationConfig||{},customQuestions:s.customQuestions||[],hiringPositions:s.hiringPositions||Ks})},[s]);const N=async()=>{m(!0);try{const f={companyName:n.companyName,contact:{phone:n.phone,email:n.email},address:{street:n.street,city:n.city,state:n.state,zip:n.zip},legal:{mcNumber:n.mcNumber,dotNumber:n.dotNumber},applicationConfig:n.applicationConfig,customQuestions:n.customQuestions,hiringPositions:n.hiringPositions,companyLogoUrl:n.companyLogoUrl};await Se(s.id,f),c("Company settings saved successfully."),b(!1)}catch(f){console.error("Save failed",f),x("Failed to save settings: "+f.message)}finally{m(!1)}},r=async f=>{const C=f.target.files[0];if(C){o(!0);try{const z=await bs(s.id,C);await Se(s.id,{companyLogoUrl:z}),h(i=>({...i,companyLogoUrl:z})),c("Logo uploaded successfully!")}catch(z){console.error("Logo failed",z),x("Logo upload failed: "+z.message)}finally{o(!1)}}},u=(f,C)=>{h(z=>({...z,[f]:C}))},v=[{id:"info",label:"Company Information",icon:Ze},{id:"questions",label:"Application Form Questions",icon:Ls}];return e.jsxs("div",{className:"space-y-6 max-w-6xl animate-in fade-in",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-end border-b border-gray-200 pb-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Company Profile"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage your public presence and application settings."})]}),p&&!j&&e.jsxs("button",{onClick:()=>b(!0),className:"px-4 py-2 bg-white border border-gray-300 text-gray-700 font-bold rounded-lg hover:bg-gray-50 flex items-center gap-2 shadow-sm transition-all",children:[e.jsx(Ye,{size:16})," Edit Profile"]}),j&&e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg font-medium transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:N,disabled:g,className:"px-4 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 shadow-md flex items-center gap-2 disabled:opacity-50",children:[g?e.jsx($,{className:"animate-spin",size:16}):e.jsx(ne,{size:16})," Save Changes"]})]})]}),e.jsx("div",{className:"flex border-b border-gray-200 overflow-x-auto no-scrollbar",children:v.map(f=>e.jsxs("button",{onClick:()=>d(f.id),className:`px-4 py-3 text-sm font-medium border-b-2 flex items-center gap-2 whitespace-nowrap transition-colors ${a===f.id?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(f.icon,{size:16})," ",f.label]},f.id))}),a==="info"&&e.jsx(Zs,{compData:n,isEditing:j,logoUploading:y,onLogoUpload:r,onFieldChange:u}),a==="questions"&&e.jsx(at,{compData:n,isCompanyAdmin:p,onConfigChange:f=>h(C=>({...C,applicationConfig:f})),onQuestionsChange:f=>h(C=>({...C,customQuestions:f})),onSave:N,loading:g}),a==="hiring"&&e.jsx(rt,{compData:n,isCompanyAdmin:p,onHiringChange:f=>h(C=>({...C,hiringPositions:f}))})]})}function nt({currentCompanyProfile:s,isCompanyAdmin:c,onShowManageTeam:x}){const{showSuccess:t,showError:a}=q(),[d,n]=l.useState({fullName:"",email:"",password:"",role:"hr_user"}),[h,g]=l.useState(!1),[m,y]=l.useState(!1),o=`${window.location.origin}/join/${s?.id}`,j=async()=>{try{await navigator.clipboard.writeText(o),y(!0),t("Invite link copied to clipboard!"),setTimeout(()=>y(!1),3e3)}catch{a("Failed to copy link")}},b=async p=>{p.preventDefault(),g(!0);try{await I(O,"createPortalUser")({fullName:d.fullName,email:d.email,password:d.password,companyId:s.id,role:d.role}),t(`User ${d.fullName} created successfully!`),n({fullName:"",email:"",password:"",role:"hr_user"})}catch(N){console.error(N),a("Failed to create user: "+N.message)}finally{g(!1)}};return c?e.jsxs("div",{className:"space-y-8 max-w-3xl animate-in fade-in",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Team Management"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Add new recruiters or admins to your company dashboard."})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-blue-900 mb-2 flex items-center gap-2",children:[e.jsx(we,{size:20})," Team Invite Link"]}),e.jsx("p",{className:"text-sm text-blue-700 mb-4",children:"Share this link with new team members. They can create their own account and join your company."}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",readOnly:!0,value:o,className:"flex-1 p-3 bg-white border border-blue-300 rounded-lg text-sm text-gray-700 font-mono"}),e.jsxs("button",{onClick:j,className:`px-4 py-3 font-bold rounded-lg flex items-center gap-2 transition-all ${m?"bg-green-600 text-white":"bg-blue-600 text-white hover:bg-blue-700"}`,children:[m?e.jsx(W,{size:18}):e.jsx(Je,{size:18}),m?"Copied!":"Copy"]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(es,{size:20})," Add New User"]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Full Name"}),e.jsx("input",{required:!0,className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:d.fullName,onChange:p=>n({...d,fullName:p.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Email"}),e.jsx("input",{required:!0,type:"email",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:d.email,onChange:p=>n({...d,email:p.target.value})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Password"}),e.jsx("input",{required:!0,type:"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:d.password,onChange:p=>n({...d,password:p.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Role"}),e.jsxs("select",{className:"w-full p-3 border border-gray-300 rounded-lg bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:d.role,onChange:p=>n({...d,role:p.target.value}),children:[e.jsx("option",{value:"hr_user",children:"Recruiter (Standard)"}),e.jsx("option",{value:"company_admin",children:"Company Admin (Full Access)"})]})]})]}),e.jsx("div",{className:"pt-2 flex justify-end",children:e.jsxs("button",{type:"submit",disabled:h,className:"px-6 py-2.5 bg-green-600 text-white font-bold rounded-lg hover:bg-green-700 flex items-center gap-2 disabled:opacity-50",children:[h?e.jsx($,{className:"animate-spin"}):e.jsx(ke,{size:18})," Create User"]})})]})]}),e.jsx("div",{className:"text-center pt-4",children:e.jsx("button",{onClick:x,className:"text-blue-600 hover:underline text-sm font-semibold",children:"View All Team Members & Goals"})})]}):e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Access Denied. Only Admins can manage the team."})}function it({currentCompanyProfile:s}){const{showSuccess:c,showError:x}=q(),[t,a]=l.useState({smtpHost:"",smtpPort:587,smtpUser:"",smtpPass:"",email:"",signature:""}),[d,n]=l.useState(!1),[h,g]=l.useState(!1),[m,y]=l.useState(null),[o,j]=l.useState(!1);l.useEffect(()=>{s?.emailSettings&&a(N=>({...N,...s.emailSettings}))},[s]);const b=async()=>{g(!0),y(null);try{const r=await I(O,"testEmailConnection")({smtpHost:t.smtpHost,smtpPort:t.smtpPort,smtpUser:t.smtpUser,smtpPass:t.smtpPass});r.data.success?(y({success:!0,message:r.data.message}),c("✅ Connection successful! You can now save these settings.")):(y({success:!1,message:r.data.error}),x(`Connection failed: ${r.data.error}`))}catch(N){console.error("Test connection error:",N),y({success:!1,message:N.message||"Failed to test connection"}),x("Connection test failed. Please check your credentials.")}finally{g(!1)}},p=async()=>{if(!t.smtpHost||!t.smtpUser||!t.smtpPass){x("Please fill in all SMTP fields (Host, User, Password)");return}n(!0);try{const N=L(T,"companies",s.id);await ee(N,{emailSettings:t}),c("Email settings saved successfully!"),y(null)}catch(N){console.error("Error saving email settings:",N),x("Failed to save email settings.")}finally{n(!1)}};return e.jsxs("div",{className:"space-y-8 max-w-4xl animate-in fade-in",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Email Integration"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Configure your company's email server to send automated messages directly from your domain."})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-4",children:[e.jsxs("h3",{className:"font-bold text-gray-800 border-b pb-2 mb-4 flex items-center gap-2",children:[e.jsx(Ae,{size:20,className:"text-blue-600"}),"SMTP Server Configuration"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["SMTP Host ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:t.smtpHost||"",onChange:N=>a({...t,smtpHost:N.target.value}),placeholder:"smtp.gmail.com"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Example: smtp.gmail.com, smtp.office365.com"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["SMTP Port ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:t.smtpPort||587,onChange:N=>a({...t,smtpPort:parseInt(N.target.value)}),placeholder:"587",min:"1",max:"65535"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Common: 587 (TLS), 465 (SSL), 25"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[e.jsx(te,{size:14}),"SMTP Username ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"email",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:t.smtpUser||"",onChange:N=>a({...t,smtpUser:N.target.value}),placeholder:"your-email@company.com"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1 flex items-center gap-1",children:[e.jsx($e,{size:14}),"SMTP Password ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"password",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:t.smtpPass||"",onChange:N=>a({...t,smtpPass:N.target.value}),placeholder:"••••••••••••"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["For Gmail, use an ",e.jsx("strong",{children:"App Password"}),", not your regular password."]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:b,disabled:h||!t.smtpHost||!t.smtpUser||!t.smtpPass,className:"px-6 py-3 bg-purple-600 text-white font-bold rounded-lg hover:bg-purple-700 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-md transition-all",children:h?e.jsxs(e.Fragment,{children:[e.jsx($,{className:"animate-spin",size:18}),"Testing Connection..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Is,{size:18}),"Test Connection"]})}),m&&e.jsx("div",{className:`mt-4 p-4 rounded-lg border ${m.success?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[m.success?e.jsx(W,{size:20,className:"text-green-600 shrink-0 mt-0.5"}):e.jsx(_e,{size:20,className:"text-red-600 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-bold ${m.success?"text-green-800":"text-red-800"}`,children:m.success?"Connection Successful!":"Connection Failed"}),e.jsx("p",{className:`text-sm ${m.success?"text-green-700":"text-red-700"} mt-1`,children:m.message})]})]})})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 shadow-sm space-y-4",children:[e.jsx("h3",{className:"font-bold text-gray-800 border-b pb-2 mb-4",children:"Email Signature (Optional)"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Default Signature"}),e.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg h-24 focus:ring-2 focus:ring-blue-500 outline-none",value:t.signature||"",onChange:N=>a({...t,signature:N.target.value}),placeholder:`Best regards,
[Your Name]
[Your Company]`}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"This signature will be automatically appended to all outgoing emails."})]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6 shadow-sm",children:[e.jsxs("button",{type:"button",onClick:()=>j(!o),className:"w-full flex items-center justify-between text-left group",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-600 rounded-lg",children:e.jsx(Ge,{className:"text-white",size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900 text-lg",children:"How to Set Up SMTP"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Step-by-step guides for Gmail, Outlook, and SendGrid"})]})]}),o?e.jsx(fs,{className:"text-blue-600",size:24}):e.jsx(ys,{className:"text-blue-600",size:24})]}),o&&e.jsxs("div",{className:"mt-6 space-y-6 animate-in fade-in slide-in-from-top-2",children:[e.jsxs("div",{className:"bg-white rounded-lg p-5 border border-gray-200 shadow-sm",children:[e.jsxs("h4",{className:"font-bold text-gray-900 text-lg mb-3 flex items-center gap-2",children:[e.jsx(te,{className:"text-red-500",size:20}),"Gmail / Google Workspace"]}),e.jsxs("ol",{className:"space-y-2 text-sm text-gray-700 list-decimal list-inside",children:[e.jsxs("li",{children:["Go to your ",e.jsx("a",{href:"https://myaccount.google.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"Google Account"})]}),e.jsxs("li",{children:["Navigate to ",e.jsx("strong",{children:"Security"})," → ",e.jsx("strong",{children:"2-Step Verification"})," (you must enable this first)"]}),e.jsxs("li",{children:["Scroll down and click ",e.jsx("strong",{children:"App passwords"})]}),e.jsxs("li",{children:["Select app: ",e.jsx("strong",{children:"Mail"}),", Select device: ",e.jsx("strong",{children:"Other (Custom name)"})]}),e.jsxs("li",{children:['Enter "SafeHaul" and click ',e.jsx("strong",{children:"Generate"})]}),e.jsxs("li",{children:["Copy the 16-character password (e.g., ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"xxxx xxxx xxxx xxxx"}),")"]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded border border-blue-200",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900",children:"Configuration:"}),e.jsxs("ul",{className:"text-xs text-blue-800 mt-1 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Host:"})," smtp.gmail.com"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Port:"})," 587"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Username:"})," your-email@gmail.com"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Password:"})," [App Password from step 6]"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-5 border border-gray-200 shadow-sm",children:[e.jsxs("h4",{className:"font-bold text-gray-900 text-lg mb-3 flex items-center gap-2",children:[e.jsx(te,{className:"text-blue-600",size:20}),"Outlook / Microsoft 365"]}),e.jsxs("ol",{className:"space-y-2 text-sm text-gray-700 list-decimal list-inside",children:[e.jsxs("li",{children:["Ensure your Microsoft account has ",e.jsx("strong",{children:"SMTP authentication enabled"})]}),e.jsxs("li",{children:["For Microsoft 365 admins: Go to ",e.jsx("strong",{children:"Exchange Admin Center"})," → ",e.jsx("strong",{children:"Settings"})," → Enable SMTP AUTH"]}),e.jsx("li",{children:"Use your regular Outlook email and password (or create an app-specific password if using MFA)"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded border border-blue-200",children:[e.jsx("p",{className:"text-sm font-semibold text-blue-900",children:"Configuration:"}),e.jsxs("ul",{className:"text-xs text-blue-800 mt-1 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Host:"})," smtp.office365.com"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Port:"})," 587"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Username:"})," your-email@outlook.com (or company domain)"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Password:"})," [Your Outlook password or app password]"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-5 border border-gray-200 shadow-sm",children:[e.jsxs("h4",{className:"font-bold text-gray-900 text-lg mb-3 flex items-center gap-2",children:[e.jsx(Ae,{className:"text-indigo-600",size:20}),"SendGrid (Recommended for High Volume)"]}),e.jsxs("ol",{className:"space-y-2 text-sm text-gray-700 list-decimal list-inside",children:[e.jsxs("li",{children:["Sign up for a free SendGrid account at ",e.jsx("a",{href:"https://sendgrid.com/",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 underline",children:"sendgrid.com"})]}),e.jsxs("li",{children:["Go to ",e.jsx("strong",{children:"Settings"})," → ",e.jsx("strong",{children:"API Keys"})]}),e.jsxs("li",{children:["Click ",e.jsx("strong",{children:"Create API Key"})]}),e.jsxs("li",{children:['Name: "SafeHaul SMTP", Permissions: ',e.jsx("strong",{children:"Full Access"})," (or Mail Send only)"]}),e.jsxs("li",{children:["Copy the generated API key (starts with ",e.jsx("code",{className:"bg-gray-100 px-1 rounded",children:"SG."}),")"]})]}),e.jsxs("div",{className:"mt-4 p-3 bg-indigo-50 rounded border border-indigo-200",children:[e.jsx("p",{className:"text-sm font-semibold text-indigo-900",children:"Configuration:"}),e.jsxs("ul",{className:"text-xs text-indigo-800 mt-1 space-y-1",children:[e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Host:"})," smtp.sendgrid.net"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Port:"})," 587"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Username:"})," apikey (exactly as written)"]}),e.jsxs("li",{children:["• ",e.jsx("strong",{children:"Password:"})," [Your SendGrid API key from step 5]"]})]})]})]})]})]}),e.jsx("div",{className:"pt-4 flex justify-end gap-3",children:e.jsxs("button",{onClick:p,disabled:d||!t.smtpHost||!t.smtpUser||!t.smtpPass,className:"px-8 py-3 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed shadow-md transition-all",children:[d?e.jsx($,{className:"animate-spin"}):e.jsx(ne,{size:18}),"Save Settings"]})})]})}function ot({currentUser:s,currentCompanyProfile:c}){const{showSuccess:x,showError:t}=q(),[a,d]=l.useState({name:""}),[n,h]=l.useState(null),[g,m]=l.useState(!1),[y,o]=l.useState(!0),[j,b]=l.useState(!1),p=window.location.origin;l.useEffect(()=>{(async()=>{if(s?.uid)try{const i=L(T,"users",s.uid),w=await ie(i);if(w.exists()){const A=w.data();d({name:A.name||""}),A.recruitingCode?(h(A.recruitingCode),o(!1)):await N(s.uid)}}catch(i){console.error("Error fetching profile:",i),o(!1)}})()},[s]);const N=async z=>{o(!0);try{const i=Math.random().toString(36).substring(2,8).toUpperCase();await ge(L(T,"recruiter_links",i),{userId:z,companyId:c.id,createdAt:new Date}),await ee(L(T,"users",z),{recruitingCode:i}),h(i)}catch(i){console.error("Error generating link:",i),t("Could not generate tracking link.")}finally{o(!1)}},r=async()=>{m(!0);try{const z=L(T,"users",s.uid);await ee(z,{name:a.name}),x("Personal profile updated successfully.")}catch(z){console.error("User save failed",z),t("Failed to update profile.")}finally{m(!1)}},u=c?.appSlug||"general",v=p.replace(/\/$/,""),f=n?`${v}/apply/${u}?r=${n}`:`${v}/apply/${u}?recruiter=${s?.uid}`,C=()=>{f&&(navigator.clipboard.writeText(f),b(!0),x("Short link copied!"),setTimeout(()=>b(!1),2e3))};return e.jsxs("div",{className:"space-y-8 max-w-4xl animate-in fade-in",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Personal Profile"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Update your personal details and access your recruiting tools."})]}),e.jsx("div",{className:"border rounded-xl p-6 shadow-sm bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-100",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 rounded-lg shadow-sm bg-white text-blue-600",children:e.jsx(we,{size:24})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-bold mb-1 text-blue-900",children:"Your Short Recruiting Link"}),e.jsxs("p",{className:"text-sm text-blue-700 mb-4",children:["Share this link. Drivers who apply will be ",e.jsx("strong",{children:"automatically assigned to you"}),"."]}),y?e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[e.jsx($,{className:"animate-spin",size:16})," Generating unique code..."]}):e.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-lg border border-blue-200",children:[e.jsx("code",{className:"flex-1 text-xs sm:text-sm font-mono text-gray-600 truncate px-2",children:f}),e.jsxs("button",{onClick:C,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm font-bold rounded-md transition-all flex items-center gap-2",children:[j?e.jsx(W,{size:16}):e.jsx(Je,{size:16}),j?"Copied":"Copy"]})]})]})]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-8 space-y-6 shadow-sm",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",className:"w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 outline-none",value:a.name,onChange:z=>d({...a,name:z.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"text",className:"w-full p-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-500 cursor-not-allowed",value:s?.email||"",readOnly:!0}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Email cannot be changed directly."})]}),e.jsx("div",{className:"flex justify-end pt-4",children:e.jsxs("button",{onClick:r,disabled:g,className:"flex items-center gap-2 px-6 py-2.5 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:opacity-50 shadow-md transition-all",children:[g?e.jsx($,{className:"animate-spin"}):e.jsx(ne,{size:18})," Update Profile"]})})]})]})}function ct(){const{showSuccess:s,showError:c}=q(),[x,t]=l.useState(!1),[a,d]=l.useState(!1),[n,h]=l.useState(null);l.useEffect(()=>{if(window.FB){t(!0);return}window.fbAsyncInit=function(){window.FB.init({appId:void 0,cookie:!0,xfbml:!0,version:"v19.0"}),t(!0)},(function(y,o,j){var b,p=y.getElementsByTagName(o)[0];y.getElementById(j)||(b=y.createElement(o),b.id=j,b.src="https://connect.facebook.net/en_US/sdk.js",p.parentNode.insertBefore(b,p))})(document,"script","facebook-jssdk")},[]);const g=()=>{if(!x){c("Facebook SDK not loaded yet. Please refresh.");return}d(!0),window.FB.login(function(y){if(y.authResponse){const o=y.authResponse.accessToken;m(o)}else d(!1),y.status!=="unknown"&&c("Facebook login failed or was cancelled.")},{scope:"pages_show_list,pages_read_engagement,leads_retrieval,pages_manage_metadata,pages_manage_ads"})},m=async y=>{try{const o=await fetch(`https://graph.facebook.com/v19.0/me/accounts?access_token=${y}`).then(p=>p.json());if(!o.data||o.data.length===0)throw new Error("No Facebook Pages found for this user.");const j=o.data[0];await I(O,"connectFacebookPage")({shortLivedUserToken:y,pageId:j.id,pageName:j.name}),h(j.name),s(`Successfully connected Facebook Page: ${j.name}`)}catch(o){console.error(o),c(o.message||"Failed to connect Facebook Page.")}finally{d(!1)}};return e.jsxs("div",{className:"space-y-6 max-w-4xl animate-in fade-in",children:[e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Integrations"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Manage connections with third-party platforms."})]}),e.jsxs("div",{className:"grid gap-6",children:[e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6 flex flex-col sm:flex-row items-center justify-between gap-6 hover:shadow-sm transition-shadow",children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-[#1877F2]/10 text-[#1877F2] rounded-lg flex items-center justify-center shrink-0",children:e.jsx(Le,{size:24})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-bold text-gray-900 flex items-center gap-2",children:["Facebook Lead Ads",n&&e.jsx("span",{className:"text-[10px] bg-green-100 text-green-700 px-2 py-0.5 rounded-full uppercase tracking-wide",children:"Connected"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1 max-w-md",children:"Automatically import leads from your Facebook Lead Gen forms. We'll sync new leads directly to your dashboard in real-time."}),n&&e.jsxs("p",{className:"text-xs text-gray-400 mt-2 flex items-center gap-1.5",children:[e.jsx(W,{size:12,className:"text-green-500"}),"Active Page: ",e.jsx("span",{className:"font-medium text-gray-700",children:n})]})]})]}),e.jsxs("div",{className:"flex-shrink-0",children:[n?e.jsx("button",{disabled:!0,className:"px-4 py-2 bg-gray-100 text-gray-400 font-semibold rounded-lg text-sm cursor-not-allowed border border-gray-200",children:"Connected"}):e.jsxs("button",{onClick:g,disabled:a||!x,className:`
                                    flex items-center gap-2 px-4 py-2 rounded-lg font-semibold text-sm transition-all shadow-sm
                                    ${a||!x?"bg-gray-100 text-gray-400 cursor-wait":"bg-[#1877F2] text-white hover:bg-[#166fe5] hover:shadow-md"}
                                `,children:[a?e.jsx($,{size:16,className:"animate-spin"}):e.jsx(Le,{size:16}),a?"Connecting...":"Connect Facebook"]}),!x&&!a&&e.jsx("p",{className:"text-[10px] text-red-400 mt-1 text-center",children:"SDK Loading..."})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-dashed border-gray-200 rounded-xl p-6 flex flex-col items-center justify-center text-center opacity-70",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-200 text-gray-400 rounded-full flex items-center justify-center mb-3",children:e.jsx(We,{size:20})}),e.jsx("h4",{className:"font-semibold text-gray-500",children:"More Integrations Coming Soon"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Tenstreet, Driver Pulse, and more."})]})]})]})}const dt=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],xt=[{id:1,label:"Position Details",icon:e.jsx(le,{size:18})},{id:2,label:"The Offer",icon:e.jsx(js,{size:18})},{id:3,label:"Requirements",icon:e.jsx(Re,{size:18})}];function mt({isOpen:s,onClose:c,onSave:x,initialData:t}){const[a,d]=l.useState(1),[n,h]=l.useState(t||{title:"",description:"",positionType:"companyDriver",teamMode:"solo",routeType:"regional",freightTypes:[],payModel:"cpm",payMin:"",payMax:"",estimatedWeeklyPay:"",minExperience:"moreThan1Year",hiringStates:[],benefits:{},status:"active"});if(!s)return null;const g=(r,u)=>{h(v=>({...v,[r]:u}))},m=(r,u)=>{h(v=>{const f=v[r]||[],C=f.includes(u)?f.filter(z=>z!==u):[...f,u];return{...v,[r]:C}})},y=r=>{h(u=>({...u,benefits:{...u.benefits,[r]:!u.benefits[r]}}))},o=()=>{a<3?d(r=>r+1):x(n)},j=()=>{a>1&&d(r=>r-1)},b=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Job Title"}),e.jsx("input",{type:"text",placeholder:"e.g. CDL-A Regional Dry Van",className:"w-full p-3 border border-gray-200 rounded-lg text-lg font-semibold outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all",value:n.title,onChange:r=>g("title",r.target.value)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Position Type"}),e.jsxs("select",{className:"w-full p-3 border border-gray-200 rounded-lg bg-white",value:n.positionType,onChange:r=>g("positionType",r.target.value),children:[e.jsx("option",{value:"companyDriver",children:"Company Driver"}),e.jsx("option",{value:"ownerOperator",children:"Owner Operator"}),e.jsx("option",{value:"leaseOperator",children:"Lease Purchase"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Team Mode"}),e.jsx("div",{className:"flex bg-gray-100 p-1 rounded-lg",children:["solo","team"].map(r=>e.jsx("button",{onClick:()=>g("teamMode",r),className:`flex-1 py-2 text-sm font-bold capitalize rounded-md transition-all ${n.teamMode===r?"bg-white shadow-sm text-blue-900":"text-gray-500"}`,children:r},r))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Route Type"}),e.jsx("div",{className:"flex gap-2",children:["otr","regional","local"].map(r=>e.jsx("button",{onClick:()=>g("routeType",r),className:`px-4 py-2 rounded-full border text-sm font-bold capitalize transition-all ${n.routeType===r?"bg-blue-50 border-blue-500 text-blue-700":"bg-white border-gray-200 text-gray-600 hover:bg-gray-50"}`,children:r.toUpperCase()},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Freight Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Ws.map(r=>e.jsx("button",{onClick:()=>m("freightTypes",r),className:`px-3 py-1.5 rounded-md text-xs font-bold transition-all ${n.freightTypes?.includes(r)?"bg-slate-800 text-white shadow-lg shadow-slate-200":"bg-gray-100 text-gray-500 hover:bg-gray-200"}`,children:r},r))})]})]}),p=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Pay Model"}),e.jsx("select",{className:"w-full p-3 border border-gray-200 rounded-lg bg-white",value:n.payModel,onChange:r=>g("payModel",r.target.value),children:Js.filter(r=>n.positionType==="ownerOperator"||n.positionType==="leaseOperator"?r.value==="percentage"||r.value==="flatRate":!0).map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Min Pay"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold",children:"$"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full pl-7 p-3 border border-gray-200 rounded-lg font-mono font-bold",value:n.payMin,onChange:r=>g("payMin",r.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Max Pay"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold",children:"$"}),e.jsx("input",{type:"number",step:"0.01",className:"w-full pl-7 p-3 border border-gray-200 rounded-lg font-mono font-bold",value:n.payMax,onChange:r=>g("payMax",r.target.value)})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Estimated Weekly Pay (Avg)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-emerald-500 font-bold",children:"$"}),e.jsx("input",{type:"number",placeholder:"1500",className:"w-full pl-7 p-3 border border-emerald-200 bg-emerald-50/30 rounded-lg font-mono font-bold text-emerald-800 focus:ring-2 focus:ring-emerald-500/20 focus:border-emerald-500 outline-none",value:n.estimatedWeeklyPay,onChange:r=>g("estimatedWeeklyPay",r.target.value)})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Used for 'Min Pay' filtering on the job board."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block",children:"Benefits included"}),e.jsx("div",{className:"grid grid-cols-2 gap-2 max-h-40 overflow-y-auto pr-1 custom-scrollbar",children:Qs.map(r=>e.jsxs("div",{onClick:()=>y(r.id),className:`flex items-center gap-2 p-2 rounded-lg border cursor-pointer transition-all ${n.benefits?.[r.id]?"bg-emerald-50 border-emerald-200":"bg-white border-gray-100"}`,children:[e.jsx("div",{className:`w-4 h-4 rounded border flex items-center justify-center ${n.benefits?.[r.id]?"bg-emerald-500 border-emerald-500":"border-gray-300"}`,children:n.benefits?.[r.id]&&e.jsx(Be,{size:12,className:"text-white"})}),e.jsx("span",{className:"text-xs font-medium text-gray-700",children:r.label})]},r.id))})]})]}),N=()=>e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-1 block",children:"Minimum Experience"}),e.jsx("select",{className:"w-full p-3 border border-gray-200 rounded-lg bg-white",value:n.minExperience,onChange:r=>g("minExperience",r.target.value),children:Ys.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2 block",children:"Hiring Zone (States)"}),e.jsx("div",{className:"p-2 border border-gray-200 rounded-xl bg-gray-50 max-h-[300px] overflow-y-auto grid grid-cols-6 gap-2",children:dt.map(r=>{const u=n.hiringStates?.includes(r);return e.jsx("button",{onClick:()=>m("hiringStates",r),className:`text-xs font-bold py-2 rounded transition-all ${u?"bg-blue-600 text-white shadow-md":"bg-white text-gray-400 hover:bg-gray-100 border border-gray-100"}`,children:r},r)})}),e.jsx("p",{className:"text-xs text-gray-400 mt-2 text-center",children:"Leave empty for Nationwide (if applicable) or select specific states."})]})]});return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/20 backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-100 flex items-center justify-between bg-white shrink-0",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:t?"Edit Job Post":"Create New Job Post"}),e.jsx("button",{onClick:c,className:"p-2 hover:bg-gray-100 rounded-full text-gray-500",children:e.jsx(ye,{size:20})})]}),e.jsx("div",{className:"px-6 py-4 bg-gray-50/50 border-b border-gray-100 shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between relative",children:[e.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 w-full h-1 bg-gray-200 -z-10 rounded-full"}),e.jsx("div",{className:"absolute left-0 top-1/2 -translate-y-1/2 h-1 bg-blue-500 -z-10 rounded-full transition-all duration-300",style:{width:`${(a-1)/2*100}%`}}),xt.map(r=>{const u=a>=r.id,v=a===r.id;return e.jsxs("div",{className:"flex flex-col items-center gap-2 bg-white px-2",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-xs font-bold transition-all ${u?"bg-blue-600 text-white":"bg-gray-200 text-gray-500"} ${v?"ring-4 ring-blue-100":""}`,children:r.id}),e.jsx("span",{className:`text-[10px] font-bold uppercase tracking-wider ${u?"text-blue-900":"text-gray-400"}`,children:r.label})]},r.id)})]})}),e.jsxs("div",{className:"p-6 flex-1 overflow-y-auto",children:[a===1&&b(),a===2&&p(),a===3&&N()]}),e.jsxs("div",{className:"p-6 border-t border-gray-100 bg-gray-50 flex justify-between shrink-0",children:[e.jsx("button",{onClick:j,disabled:a===1,className:`px-4 py-2 font-bold text-gray-600 hover:bg-gray-200 rounded-lg transition-colors ${a===1?"invisible":""}`,children:"Back"}),e.jsxs("button",{onClick:o,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-sm transition-all flex items-center gap-2",children:[a===3?t?"Update Job":"Post Job":"Continue",a<3&&e.jsx(Ue,{size:16})]})]})]})})}function ut({companyId:s,companyName:c,logoUrl:x}){const[t,a]=l.useState([]),[d,n]=l.useState(!0),[h,g]=l.useState(!1),[m,y]=l.useState(null),o=async()=>{if(s){n(!0);try{const u=G(H(T,"job_posts"),oe("companyId","==",s)),f=(await re(u)).docs.map(C=>({id:C.id,...C.data()}));a(f.sort((C,z)=>(z.updatedAt?.toMillis()||0)-(C.updatedAt?.toMillis()||0)))}catch(u){console.error("Error fetching jobs:",u)}finally{n(!1)}}};l.useEffect(()=>{o()},[s]);const j=async u=>{try{const v={...u,companyId:s,companyName:c||"Company",companyLogo:x||"",updatedAt:Z()};m?await ee(L(T,"job_posts",m.id),v):(v.createdAt=Z(),await ss(H(T,"job_posts"),v)),g(!1),y(null),o()}catch(v){console.error("Error saving job:",v),alert("Failed to save job post.")}},b=async u=>{try{const v=u.status==="active"?"paused":"active";await ee(L(T,"job_posts",u.id),{status:v,updatedAt:Z()}),a(f=>f.map(C=>C.id===u.id?{...C,status:v}:C))}catch(v){console.error("Error updating status:",v)}},p=async u=>{if(confirm("Are you sure you want to delete this job post?"))try{await xe(L(T,"job_posts",u)),a(v=>v.filter(f=>f.id!==u))}catch(v){console.error("Error deleting job:",v)}},N=u=>{y(u),g(!0)},r=()=>{y(null),g(!0)};return d?e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading job posts..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Internal Job Board"}),e.jsx("p",{className:"text-gray-500",children:"Manage your active job listings visible to drivers on the SafeHaul network."})]}),e.jsxs("button",{onClick:r,className:"px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg shadow-sm flex items-center gap-2 transition-colors",children:[e.jsx(ke,{size:20}),"Post New Job"]})]}),t.length===0?e.jsxs("div",{className:"text-center py-20 bg-gray-50 rounded-2xl border border-dashed border-gray-300",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100/50 text-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(le,{size:32})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:"No Active Job Posts"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto mb-6",children:"Create your first job post to start accepting applications from qualified drivers."}),e.jsx("button",{onClick:r,className:"px-6 py-2.5 bg-white border border-gray-300 hover:bg-gray-50 text-gray-700 font-bold rounded-lg shadow-sm transition-colors",children:"Create Job Post"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:t.map(u=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-5 flex flex-col md:flex-row gap-6 items-start md:items-center hover:border-blue-300 transition-colors group relative",children:[e.jsx("div",{className:`absolute left-0 top-0 bottom-0 w-1.5 rounded-l-xl ${u.status==="active"?"bg-emerald-500":"bg-gray-300"}`}),e.jsxs("div",{className:"flex-1 pl-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:u.title}),e.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold uppercase rounded-full tracking-wider ${u.status==="active"?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-500"}`,children:u.status})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-500",children:[e.jsxs("span",{className:"capitalize",children:[u.positionType?.replace(/([A-Z])/g," $1").trim()," • ",u.teamMode]}),e.jsx("span",{children:"•"}),e.jsx("span",{className:"capitalize",children:u.routeType}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"font-medium text-gray-700",children:["$",u.estimatedWeeklyPay?.toLocaleString(),"/wk"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 self-end md:self-center",children:[e.jsx("button",{onClick:()=>b(u),className:`p-2 rounded-lg transition-colors flex items-center gap-2 text-sm font-semibold ${u.status==="active"?"text-amber-600 hover:bg-amber-50":"text-emerald-600 hover:bg-emerald-50"}`,children:u.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(Cs,{size:18})," Pause"]}):e.jsxs(e.Fragment,{children:[e.jsx(zs,{size:18})," Activate"]})}),e.jsx("div",{className:"h-6 w-px bg-gray-200 mx-1"}),e.jsx("button",{onClick:()=>N(u),className:"p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(Ye,{size:18})}),e.jsx("button",{onClick:()=>p(u.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(Ce,{size:18})})]})]},u.id))}),e.jsx(mt,{isOpen:h,onClose:()=>g(!1),onSave:j,initialData:m})]})}function gt({title:s,message:c}){return e.jsxs("div",{className:"flex flex-col items-center justify-center p-12 bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl border-2 border-dashed border-gray-200 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-amber-50 text-amber-500 rounded-2xl flex items-center justify-center mb-6 shadow-lg",children:e.jsx($e,{size:40})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:s||"Paid Feature"}),e.jsx("p",{className:"text-gray-600 max-w-md mb-6 leading-relaxed",children:c||"This feature is only available to premium subscribers."}),e.jsxs("a",{href:"mailto:info@safehaul.io",className:"flex items-center gap-2 px-6 py-3 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition shadow-lg",children:[e.jsx(te,{size:18})," Contact info@safehaul.io"]})]})}function ht({campaign:s,onClick:c,onDelete:x,onViewReport:t}){const[a,d]=l.useState(!1),n=l.useRef(null);l.useEffect(()=>{const g=m=>{n.current&&!n.current.contains(m.target)&&d(!1)};return document.addEventListener("mousedown",g),()=>document.removeEventListener("mousedown",g)},[]);const h=g=>{switch(g){case"active":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"draft":return"bg-slate-100 text-slate-600 border-slate-200";case"completed":return"bg-blue-100 text-blue-700 border-blue-200";case"scheduled":return"bg-amber-100 text-amber-700 border-amber-200";default:return"bg-slate-100 text-slate-600 border-slate-200"}};return e.jsxs("div",{onClick:c,className:"group bg-white border border-slate-200 rounded-2xl p-5 hover:border-blue-300 hover:shadow-lg hover:shadow-blue-500/5 transition-all cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-black uppercase tracking-widest border ${h(s.status)}`,children:s.status}),e.jsxs("div",{className:"relative",ref:n,children:[e.jsx("button",{onClick:g=>{g.stopPropagation(),d(!a)},className:`p-1 rounded-lg transition-colors ${a?"bg-slate-100 text-slate-900":"text-slate-400 hover:text-slate-600"}`,children:e.jsx(ms,{size:18})}),a&&e.jsx("div",{className:"absolute right-0 top-8 w-48 bg-white rounded-xl shadow-xl border border-slate-100 py-1 z-10 animate-in fade-in zoom-in-95 duration-200",children:e.jsxs("button",{onClick:g=>{g.stopPropagation(),d(!1),x&&x(s)},className:"w-full flex items-center gap-2 px-4 py-2 text-sm text-red-600 hover:bg-red-50 font-medium text-left",children:[e.jsx(Ce,{size:14})," Delete Campaign"]})})]})]}),e.jsx("h3",{className:"text-lg font-black text-slate-900 group-hover:text-blue-600 transition-colors truncate mb-1",children:s.name||"Untitled Campaign"}),e.jsx("p",{className:"text-slate-500 text-sm font-medium mb-6 line-clamp-2",children:s.messageConfig?.message||"No content defined..."}),e.jsx("div",{className:"border-t border-slate-100 pt-5",children:s.progress?e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-[10px] font-black uppercase tracking-widest text-slate-400",children:"Progress"}),e.jsxs("span",{className:"text-[10px] font-bold text-slate-600",children:[s.progress.processedCount," / ",s.progress.totalCount]})]}),e.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-500",style:{width:`${s.progress.processedCount/(s.progress.totalCount||1)*100}%`}})}),e.jsxs("div",{className:"mt-3 flex gap-4",children:[s.progress.failedCount>0&&e.jsxs("span",{className:"text-[10px] font-bold text-red-500",children:[s.progress.failedCount," Failed"]}),e.jsx("span",{className:"text-[10px] font-bold text-slate-400 ml-auto uppercase",children:s.messageConfig?.method||"SMS"})]})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(J,{size:16}),e.jsxs("span",{className:"text-xs font-bold text-slate-600",children:[s.matchCount||0," leads"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-slate-400",children:[e.jsx(he,{size:16}),e.jsx("span",{className:"text-xs font-bold text-slate-600 uppercase",children:s.messageConfig?.method||"SMS"})]})]})}),e.jsxs("div",{className:"mt-4 flex items-center justify-between text-[10px] uppercase tracking-widest font-black",children:[e.jsxs("span",{className:"flex items-center gap-1.5 text-slate-400",children:[e.jsx(ts,{size:12}),s.updatedAt?.toDate()?new Date(s.updatedAt.toDate()).toLocaleDateString():"Just now"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t&&s.status!=="draft"&&e.jsx("button",{onClick:g=>{g.stopPropagation(),t()},className:"text-blue-500 hover:text-blue-700 hover:underline",children:"View Report"}),e.jsxs("span",{className:"flex items-center gap-0.5 text-slate-400 group-hover:text-blue-500 transition-all",children:["Details ",e.jsx(Ue,{size:12})]})]})]})]})}function pt(s){const{showSuccess:c,showError:x}=q(),[t,a]=l.useState(!1),d=l.useCallback(async(h,g)=>{if(!(!s||!h)){a(!0);try{const m=L(T,"companies",s,"campaign_drafts",h),y=JSON.parse(JSON.stringify(g));await ge(m,{...y,updatedAt:Z(),companyId:s},{merge:!0})}catch(m){console.error("Draft Save Error:",m),x("Failed to save draft")}finally{a(!1)}}},[s]),n=l.useCallback(async h=>{if(window.confirm("Delete this draft?"))try{await xe(L(T,"companies",s,"campaign_drafts",h)),c("Draft deleted")}catch(g){x(g.message)}},[s]);return{saveDraft:d,deleteDraft:n,isSaving:t}}const bt=pe.lazy(()=>ve(()=>import("./AudienceBuilder-CBhim3gH.js"),__vite__mapDeps([0,1,2,3,4,5])).then(s=>({default:s.AudienceBuilder}))),ft=pe.lazy(()=>ve(()=>import("./ContentComposer-bZyOmz7y.js"),__vite__mapDeps([6,1,2,3])).then(s=>({default:s.ContentComposer}))),yt=pe.lazy(()=>ve(()=>import("./LaunchPad-o06JMcZn.js"),__vite__mapDeps([7,1,2,3,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22])).then(s=>({default:s.LaunchPad}))),jt=[{id:"audience",label:"Audience",icon:J},{id:"content",label:"Content",icon:he},{id:"launch",label:"Launch",icon:fe}];function Nt({companyId:s,campaignId:c,onClose:x}){const[t,a]=l.useState("audience"),[d,n]=l.useState({name:"Untitled Campaign",filters:{},messageConfig:{method:"sms",message:""},status:"draft"}),{saveDraft:h,isSaving:g}=pt(s);l.useEffect(()=>{if(!s||!c)return;const o=ae(L(T,"companies",s,"campaign_drafts",c),j=>{j.exists()&&n(b=>({...b,...j.data()}))});return()=>o()},[s,c]),l.useEffect(()=>{const o=setTimeout(()=>{c&&h(c,d)},2e3);return()=>clearTimeout(o)},[d,c,h]);const m=(o,j)=>{n(b=>({...b,[o]:{...b[o],...j}}))},y=o=>o==="audience"?d.matchCount>0:o==="content"?!!d.messageConfig?.message:!1;return e.jsxs("div",{className:"flex h-screen bg-slate-50 overflow-hidden",children:[e.jsxs("aside",{className:"w-64 bg-white border-r border-slate-200 flex flex-col z-20",children:[e.jsx("div",{className:"h-16 flex items-center px-6 border-b border-slate-100",children:e.jsxs("button",{onClick:x,className:"flex items-center gap-2 text-slate-500 hover:text-slate-800 font-bold text-sm transition-colors",children:[e.jsx(me,{size:16})," Exit"]})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"block text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-1",children:"Campaign Name"}),e.jsx("input",{type:"text",value:d.name,onChange:o=>n(j=>({...j,name:o.target.value})),className:"w-full text-lg font-black text-slate-900 bg-transparent border-b border-slate-200 focus:border-blue-500 outline-none transition-all pb-1 truncate placeholder-slate-300",placeholder:"Enter campaign name..."})]}),e.jsx("nav",{className:"space-y-2",children:jt.map(o=>{const j=t===o.id,b=y(o.id),p=o.icon;return e.jsxs("button",{onClick:()=>a(o.id),className:`w-full flex items-center justify-between p-3 rounded-xl transition-all ${j?"bg-blue-50 text-blue-700 shadow-sm":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(p,{size:18,className:j?"text-blue-600":"text-slate-400"}),e.jsx("span",{className:"text-sm font-bold",children:o.label})]}),b?e.jsx(Ne,{size:16,className:"text-emerald-500"}):e.jsx(Ns,{size:16,className:"text-slate-200"})]},o.id)})})]}),e.jsx("div",{className:"mt-auto p-6 border-t border-slate-100",children:e.jsxs("div",{className:"flex items-center justify-between text-xs font-bold text-slate-400",children:[e.jsx("span",{children:g?"Saving...":"Auto-Saved"}),e.jsx(ne,{size:14,className:g?"animate-pulse text-blue-500":""})]})})]}),e.jsx("main",{className:"flex-1 overflow-y-auto bg-slate-50 p-8 relative",children:e.jsxs(pe.Suspense,{fallback:e.jsx("div",{className:"p-10 text-center text-slate-400",children:"Loading Module..."}),children:[t==="audience"&&e.jsx(bt,{companyId:s,filters:d.filters||{},onChange:(o,j)=>{n(b=>({...b,filters:o,matchCount:j}))}}),t==="content"&&e.jsx(ft,{messageConfig:d.messageConfig||{},onChange:o=>m("messageConfig",o)}),t==="launch"&&e.jsx(yt,{companyId:s,campaign:d,onLaunchSuccess:x})]})})]})}function vt({companyId:s,campaignId:c}){const[x,t]=l.useState([]),[a,d]=l.useState(!0),[n,h]=l.useState("");l.useEffect(()=>{(async()=>{if(!s||!c){d(!1);return}try{const y=G(H(T,"companies",s,"bulk_sessions",c,"logs"),ue("timestamp","desc"),Oe(200)),o=await re(y);t(o.docs.map(j=>({id:j.id,...j.data()})))}catch(y){console.error("Failed to fetch logs:",y)}finally{d(!1)}})()},[s,c]);const g=x.filter(m=>m.recipientName?.toLowerCase().includes(n.toLowerCase())||m.recipientIdentity?.includes(n));return a?e.jsx("div",{className:"p-8 text-center text-slate-400 text-sm font-medium animate-pulse",children:"Loading detailed results..."}):x.length===0?e.jsx("div",{className:"p-8 text-center text-slate-400 text-sm font-medium",children:"No messages sent yet."}):e.jsxs("div",{className:"bg-white rounded-2xl border border-slate-200 shadow-sm overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-100 flex items-center justify-between bg-slate-50/50",children:[e.jsx("h3",{className:"font-bold text-slate-900 text-sm uppercase tracking-wider",children:"Recipient Log"}),e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),e.jsx("input",{type:"text",placeholder:"Search name or phone...",value:n,onChange:m=>h(m.target.value),className:"pl-9 pr-4 py-2 bg-white border border-slate-200 rounded-lg text-xs font-bold outline-none focus:border-blue-300 w-48 transition-all"})]})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto custom-scrollbar",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-slate-50 sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Recipient"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Contact"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-[10px] font-black text-slate-400 uppercase tracking-widest",children:"Time"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:g.map(m=>e.jsxs("tr",{className:"hover:bg-slate-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-3",children:e.jsx("div",{className:"text-sm font-bold text-slate-900",children:m.recipientName||"Unknown"})}),e.jsx("td",{className:"px-6 py-3",children:e.jsx("div",{className:"text-xs font-mono text-slate-500",children:m.recipientIdentity})}),e.jsxs("td",{className:"px-6 py-3",children:[e.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-bold uppercase tracking-wide ${m.status==="delivered"?"text-emerald-600":"text-red-500"}`,children:[m.status==="delivered"?e.jsx(Ne,{size:14}):e.jsx(de,{size:14}),m.status==="delivered"?"Delivered":"Failed"]}),m.error&&e.jsx("div",{className:"text-[10px] text-red-400 mt-1 font-medium",children:m.error})]}),e.jsx("td",{className:"px-6 py-3",children:e.jsxs("div",{className:"text-xs text-slate-400 font-medium flex items-center gap-1",children:[e.jsx(Ie,{size:12}),m.timestamp?.toDate?m.timestamp.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Pending"]})})]},m.id))})]})})]})}function wt({campaign:s,onClose:c}){const{companyId:x}=as(),{currentCompanyProfile:t}=je(),[a,d]=l.useState(!1),n=s?.companyId||t?.id||x,[h,g]=l.useState(!1),[m,y]=l.useState(!1),{showSuccess:o,showError:j}=q();if(!s)return null;const b=i=>{switch(i){case"active":return"bg-emerald-100 text-emerald-700 border-emerald-200";case"draft":return"bg-slate-100 text-slate-600 border-slate-200";case"completed":return"bg-blue-100 text-blue-700 border-blue-200";case"scheduled":return"bg-amber-100 text-amber-700 border-amber-200";case"queued":return"bg-purple-100 text-purple-700 border-purple-200";case"failed":return"bg-red-100 text-red-700 border-red-200";case"paused":return"bg-orange-100 text-orange-700 border-orange-200";case"cancelled":return"bg-gray-100 text-gray-700 border-gray-200";default:return"bg-slate-100 text-slate-600 border-slate-200"}},p=i=>i?(i.toDate?i.toDate():new Date(i)).toLocaleString():"N/A",N=async()=>{if(confirm("Start a new campaign for FAILED recipients only? This will retry permanent errors too."))try{d(!0);const w=await I(O,"retryFailedAttempts")({companyId:n,originalSessionId:s.id});w.data.success?(o(`Retry session started with ${w.data.targetCount} targets.`),c()):j(w.data.message||"Retry failed to start.")}catch(i){console.error(i),j(i.message)}finally{d(!1)}},r=async()=>{try{g(!0),await I(O,"pauseBulkSession")({companyId:n,sessionId:s.id}),o("Campaign paused."),c()}catch(i){j(i.message)}finally{g(!1)}},u=async()=>{if(confirm("Are you sure you want to cancel this campaign? This action cannot be undone."))try{y(!0),await I(O,"cancelBulkSession")({companyId:n,sessionId:s.id}),o("Campaign cancelled."),c()}catch(i){j(i.message)}finally{y(!1)}},v=s.progress?s.progress.processedCount/(s.progress.totalCount||1)*100:0,f=s.progress?.failedCount>0,C=["active","queued","scheduled"].includes(s.status),z=s.status==="paused";return e.jsxs("div",{className:"flex flex-col h-screen bg-slate-50 overflow-hidden animate-in slide-in-from-right duration-300",children:[e.jsxs("div",{className:"h-16 flex items-center justify-between px-8 border-b border-slate-200 bg-white",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:c,className:"p-2 -ml-2 text-slate-400 hover:text-slate-700 hover:bg-slate-100 rounded-full transition-all",children:e.jsx(me,{size:20})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-black text-slate-900 leading-none",children:s.name||"Untitled Campaign"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:`px-2 py-0.5 rounded-full text-[10px] font-black uppercase tracking-widest border ${b(s.status)}`,children:s.status}),e.jsxs("span",{className:"text-xs font-medium text-slate-400 flex items-center gap-1",children:[e.jsx(Ie,{size:12})," ",p(s.createdAt)]})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[C&&e.jsxs("button",{onClick:r,disabled:h,className:"flex items-center gap-2 px-3 py-1.5 bg-orange-50 text-orange-600 rounded-lg text-xs font-bold uppercase tracking-widest border border-orange-200 hover:bg-orange-100 transition-colors disabled:opacity-50",children:[e.jsx(us,{size:14,className:h?"animate-pulse":""}),h?"Pausing...":"Pause"]}),(C||z)&&e.jsxs("button",{onClick:u,disabled:m,className:"flex items-center gap-2 px-3 py-1.5 bg-slate-50 text-slate-600 rounded-lg text-xs font-bold uppercase tracking-widest border border-slate-200 hover:bg-slate-100 transition-colors disabled:opacity-50",children:[e.jsx(rs,{size:14,className:m?"animate-pulse":""}),m?"Cancelling...":"Details & Cancel"]}),f&&!C&&e.jsxs("button",{onClick:N,disabled:a,className:"flex items-center gap-2 px-3 py-1.5 bg-red-50 text-red-600 rounded-lg text-xs font-bold uppercase tracking-widest border border-red-200 hover:bg-red-100 transition-colors disabled:opacity-50",children:[e.jsx(se,{size:14,className:a?"animate-spin":""}),a?"Starting...":"Retry Failed"]})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:e.jsxs("div",{className:"max-w-5xl mx-auto space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-blue-50 text-blue-600 rounded-lg",children:e.jsx(J,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Audience"})]}),e.jsx("div",{className:"text-2xl font-black text-slate-900",children:s.progress?s.progress.totalCount:s.matchCount||0})]}),e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-emerald-50 text-emerald-600 rounded-lg",children:e.jsx(Ne,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Sent"})]}),e.jsx("div",{className:"text-2xl font-black text-slate-900",children:s.progress?s.progress.successCount:0})]}),e.jsxs("div",{className:"bg-white p-5 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"p-2 bg-red-50 text-red-600 rounded-lg",children:e.jsx(de,{size:20})}),e.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Failed"})]}),e.jsx("div",{className:"text-2xl font-black text-slate-900",children:s.progress?s.progress.failedCount:0})]})]}),s.progress&&e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(Ve,{size:16,className:"text-blue-500"})," Campaign Progress"]}),e.jsx("div",{className:"h-4 w-full bg-slate-100 rounded-full overflow-hidden mb-2",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all duration-1000 ease-out",style:{width:`${v}%`}})}),e.jsxs("div",{className:"flex justify-between text-xs font-medium text-slate-500",children:[e.jsxs("span",{children:[Math.round(v),"% Complete"]}),e.jsxs("span",{children:[s.progress.processedCount," / ",s.progress.totalCount," leads processed"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsxs("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-4 flex items-center gap-2",children:[e.jsx(he,{size:16,className:"text-purple-500"})," Message Content"]}),e.jsx("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-100 text-slate-600 font-medium whitespace-pre-wrap",children:s.messageConfig?.message||"No message content defined."}),e.jsx("div",{className:"mt-4 flex gap-2",children:e.jsx("span",{className:"px-3 py-1 bg-slate-100 text-slate-600 rounded-lg text-xs font-bold uppercase tracking-widest",children:s.messageConfig?.method||"SMS"})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-2xl border border-slate-200 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-bold text-slate-900 uppercase tracking-widest mb-4",children:"Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"block text-slate-400 text-xs font-bold uppercase mb-1",children:"Campaign ID"}),e.jsx("span",{className:"font-mono text-slate-600",children:s.id})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-slate-400 text-xs font-bold uppercase mb-1",children:"Created At"}),e.jsx("span",{className:"text-slate-600",children:p(s.createdAt)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-slate-400 text-xs font-bold uppercase mb-1",children:"Updated At"}),e.jsx("span",{className:"text-slate-600",children:p(s.updatedAt)})]}),s.scheduledFor&&e.jsxs("div",{children:[e.jsx("span",{className:"block text-slate-400 text-xs font-bold uppercase mb-1",children:"Scheduled For"}),e.jsx("span",{className:"text-slate-600",children:p(s.scheduledFor)})]})]})]}),e.jsx(vt,{companyId:s.companyId,campaignId:s.id})]})})]})}function kt({companyId:s,sessionId:c,isOpen:x,onClose:t}){const[a,d]=l.useState([]),[n,h]=l.useState(!0),[g,m]=l.useState(!1),{showSuccess:y,showError:o}=q();l.useEffect(()=>{if(!x||!s||!c)return;(async()=>{try{h(!0);const N=H(T,"companies",s,"bulk_sessions",c,"logs"),r=G(N,ue("timestamp","desc"),Oe(200)),v=(await re(r)).docs.map(f=>({id:f.id,...f.data()}));d(v)}catch(N){console.error("Error fetching logs:",N),o("Failed to load delivery details. Check permissions.")}finally{h(!1)}})()},[x,s,c]);const j=async()=>{if(confirm("Start a new campaign for FAILED recipients only? This will retry permanent errors too."))try{m(!0);const N=await I(O,"retryFailedAttempts")({companyId:s,originalSessionId:c});N.data.success?(y(`Retry session started with ${N.data.targetCount} targets.`),t()):o(N.data.message||"Retry failed to start.")}catch(p){console.error(p),o(p.message)}finally{m(!1)}},b=a.some(p=>p.status==="failed"||p.isSuccess===!1);return x?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t}),e.jsx("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full sm:p-6",children:[e.jsx("div",{className:"absolute top-0 right-0 pt-4 pr-4",children:e.jsxs("button",{type:"button",className:"bg-white rounded-md text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500",onClick:t,children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})]})}),e.jsx("div",{className:"sm:flex sm:items-start",children:e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Delivery Report"}),b&&e.jsx("button",{onClick:j,disabled:g,className:"bg-red-50 text-red-600 px-3 py-1 rounded-md text-sm font-bold border border-red-200 hover:bg-red-100 transition-colors",children:g?"Starting...":"Retry Failed Requests"})]}),e.jsx("div",{className:"mt-4 flex flex-col",children:e.jsx("div",{className:"-my-2 overflow-x-auto sm:-mx-6 lg:-mx-8",children:e.jsx("div",{className:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8",children:e.jsx("div",{className:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg max-h-96 overflow-y-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Recipient"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Error Detail"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:n?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-500",children:"Loading logs..."})}):a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"px-6 py-4 text-center text-sm text-gray-500",children:"No activity logs found. Ensure permissions are set."})}):a.map(p=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:p.recipientName||"Unknown"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:p.recipientIdentity||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${p.status==="delivered"||p.isSuccess?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:p.status==="delivered"||p.isSuccess?"Delivered":"Failed"})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:p.error||"-"})]},p.id))})]})})})})})]})}),e.jsx("div",{className:"mt-5 sm:mt-4 sm:flex sm:flex-row-reverse",children:e.jsx("button",{type:"button",className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm",onClick:t,children:"Close"})})]})]})}):null}function De({companyId:s}){const[c,x]=l.useState([]),[t,a]=l.useState([]),[d,n]=l.useState(!0),[h,g]=l.useState("drafts"),[m,y]=l.useState(null),[o,j]=l.useState(null),[b,p]=l.useState(null),{showSuccess:N,showError:r}=q();l.useEffect(()=>{if(!s)return;const i=G(H(T,"companies",s,"campaign_drafts"),ue("updatedAt","desc")),w=ae(i,A=>{x(A.docs.map(F=>({id:F.id,...F.data()}))),n(!1)});return()=>w()},[s]),l.useEffect(()=>{if(!s)return;const i=G(H(T,"companies",s,"bulk_sessions"),ue("createdAt","desc")),w=ae(i,A=>{a(A.docs.map(F=>{const D=F.data();return{id:F.id,name:D.name,status:D.status,createdAt:D.createdAt,updatedAt:D.lastUpdateAt||D.createdAt,messageConfig:D.config,matchCount:D.progress?.totalCount||D.targetIds?.length||0,progress:D.progress,...D}}))});return()=>w()},[s]);const u=t.filter(i=>["active","queued","scheduled"].includes(i.status)).length,v=t.reduce((i,w)=>i+(w.progress?.processedCount||0),0),f="0%",C=async()=>{if(!s)return;const i=`camp_${Date.now()}`;try{await ge(L(T,"companies",s,"campaign_drafts",i),{name:"Untitled Campaign",status:"draft",createdAt:Z(),updatedAt:Z(),filters:{},messageConfig:{method:"sms",message:""}}),y(i)}catch(w){r("Failed to create campaign: "+w.message)}},z=async i=>{if(!(!s||!i.id)&&window.confirm(`Are you sure you want to delete "${i.name}"?`))try{h==="drafts"?(await xe(L(T,"companies",s,"campaign_drafts",i.id)),N("Campaign draft deleted")):(await xe(L(T,"companies",s,"bulk_sessions",i.id)),N("Campaign record deleted"))}catch(w){r("Failed to delete campaign: "+w.message)}};return m?e.jsx(Nt,{companyId:s,campaignId:m,onClose:()=>y(null)}):o?e.jsx(wt,{campaign:o,onClose:()=>j(null)}):e.jsxs("div",{className:"p-8 max-w-[1600px] mx-auto min-h-screen bg-slate-50/50",children:[e.jsxs("div",{className:"flex flex-col md:flex-row items-start md:items-end justify-between mb-12 gap-6",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-600 rounded-2xl flex items-center justify-center text-white shadow-lg shadow-blue-500/20 rotate-[-10deg]",children:e.jsx(fe,{size:24})}),e.jsx("h1",{className:"text-4xl font-black text-slate-900 tracking-tight uppercase",children:"Campaigns"})]}),e.jsx("p",{className:"text-slate-500 font-medium text-lg max-w-xl",children:"Design and deploy bulk engagement sequences to reactivate your driver database."})]}),e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:C,className:"flex items-center gap-2 px-8 py-4 bg-slate-900 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-xl shadow-slate-900/10 hover:bg-blue-600 hover:shadow-blue-500/20 transition-all active:scale-95 group",children:[e.jsx(ke,{size:18,className:"group-hover:rotate-90 transition-transform"}),"Create Campaign"]})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-12",children:[{label:"Live Campaigns",value:u,icon:ls,color:"blue"},{label:"Total Outreach",value:v,icon:J,color:"emerald"},{label:"Response Rate",value:f,icon:gs,color:"amber"},{label:"Carrier Score",value:"100",icon:Ve,color:"indigo"}].map((i,w)=>e.jsxs("div",{className:"bg-white p-6 rounded-[2.5rem] border border-slate-200 shadow-sm flex items-center gap-5",children:[e.jsx("div",{className:`w-14 h-14 rounded-2xl bg-${i.color}-50 flex items-center justify-center text-${i.color}-600 ring-1 ring-${i.color}-100`,children:e.jsx(i.icon,{size:26})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-[10px] font-black text-slate-400 uppercase tracking-widest leading-none mb-1",children:i.label}),e.jsx("div",{className:"text-2xl font-black text-slate-900 tracking-tight",children:i.value})]})]},w))}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"bg-white p-1 rounded-2xl border border-slate-200 flex gap-1",children:[e.jsxs("button",{onClick:()=>g("drafts"),className:`flex items-center gap-2 px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${h==="drafts"?"bg-slate-900 text-white shadow-lg":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(Ps,{size:16})," Drafts"]}),e.jsxs("button",{onClick:()=>g("history"),className:`flex items-center gap-2 px-6 py-3 rounded-xl text-xs font-black uppercase tracking-widest transition-all ${h==="history"?"bg-slate-900 text-white shadow-lg":"text-slate-500 hover:bg-slate-50"}`,children:[e.jsx(vs,{size:16})," Past Sequences"]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsxs("div",{className:"relative",children:[e.jsx(qe,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-slate-400",size:16}),e.jsx("input",{type:"text",placeholder:"Search campaigns...",className:"pl-11 pr-6 py-3 bg-white border border-slate-200 rounded-2xl text-sm font-medium focus:ring-2 focus:ring-blue-100 outline-none w-64"})]})})]}),d?e.jsxs("div",{className:"py-32 flex flex-col items-center justify-center text-slate-400 animate-in fade-in",children:[e.jsx($,{size:48,className:"animate-spin mb-4"}),e.jsx("span",{className:"font-bold text-lg tracking-tight uppercase tracking-widest",children:"Synchronizing..."})]}):(h==="drafts"?c:t).length===0?e.jsxs("div",{className:"py-32 bg-white rounded-[3rem] border-2 border-dashed border-slate-200 flex flex-col items-center justify-center animate-in zoom-in-95 duration-700",children:[e.jsx("div",{className:"w-24 h-24 bg-slate-50 rounded-full flex items-center justify-center text-slate-300 mb-6",children:e.jsx(fe,{size:48})}),e.jsxs("h3",{className:"text-2xl font-black text-slate-900 uppercase tracking-tight mb-2",children:["No ",h==="drafts"?"Drafts":"Campaigns"," Found"]}),e.jsx("p",{className:"text-slate-500 font-medium mb-10 text-center max-w-sm",children:"Ready to reactivate your driver database? Create your first automated messaging sequence."}),e.jsx("button",{onClick:C,className:"px-10 py-4 bg-blue-600 text-white rounded-2xl font-black text-xs uppercase tracking-widest shadow-xl shadow-blue-500/20 hover:bg-blue-700 transition-all active:scale-95",children:"Define Initial Campaign"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 animate-in slide-in-from-bottom-5 duration-700",children:(h==="drafts"?c:t).map(i=>e.jsx(ht,{campaign:i,onClick:()=>h==="drafts"?y(i.id):j(i),onDelete:z,onViewReport:()=>p(i.id)},i.id))}),e.jsx(kt,{companyId:s,sessionId:b,isOpen:!!b,onClose:()=>p(null)})]})}const B=({id:s,label:c,icon:x,activeTab:t,onClick:a})=>e.jsxs("button",{onClick:()=>a(s),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 text-left ${t===s?"bg-blue-50 text-blue-700 border-l-4 border-blue-600":"text-gray-600 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(x,{size:18,className:t===s?"text-blue-600":"text-gray-400"}),c]}),Fe=({title:s,subtitle:c})=>e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:s}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:c})]});function Ct(){const{currentCompanyProfile:s,currentUser:c,currentUserClaims:x}=je(),[t,a]=l.useState("company"),[d,n]=l.useState(""),[h,g]=l.useState(!1),m=ns(),y=x?.roles?.[s?.id]==="company_admin"||x?.roles?.globalRole==="super_admin",o=b=>{n(b),setTimeout(()=>n(""),3e3)},j=()=>{switch(t){case"company":return e.jsx(lt,{currentCompanyProfile:s,onShowSuccess:o});case"team":return e.jsx(nt,{currentCompanyProfile:s,isCompanyAdmin:y,onShowSuccess:o,onShowManageTeam:()=>g(!0)});case"personal":return e.jsx(ot,{currentUser:c,currentCompanyProfile:s,onShowSuccess:o});case"email":return e.jsx(it,{currentCompanyProfile:s,onShowSuccess:o});case"sms":return e.jsx(Gs,{companyId:s?.id});case"hiring":return e.jsx(ut,{companyId:s?.id,companyName:s?.name,logoUrl:s?.logoUrl});case"integrations":return e.jsx(ct,{});case"billing":return e.jsxs("div",{className:"space-y-8 max-w-4xl animate-in fade-in",children:[e.jsx(Fe,{title:"Billing & Plan",subtitle:"Manage your subscription."}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-10 text-center text-gray-500",children:[e.jsx(Me,{size:48,className:"mx-auto mb-4 opacity-20"}),e.jsxs("p",{children:["Current Plan: ",e.jsx("strong",{children:s?.planType==="paid"?"Pro Plan":"Free Plan"})]}),e.jsx("p",{className:"text-sm mt-2",children:"To upgrade or cancel, please contact support."})]})]});case"bulk-actions":return s?.features?.campaignsEnabled?e.jsx(De,{companyId:s?.id}):e.jsxs("div",{className:"space-y-8 max-w-4xl animate-in fade-in",children:[e.jsx(Fe,{title:"Bulk Actions",subtitle:"Manage reactivation campaigns and mass messaging."}),e.jsx(gt,{title:"Bulk Actions - Paid Feature",message:"This is a paid feature. Please contact your account manager or reach out to SafeHaul at info@safehaul.io to get more information."})]});default:return e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Select a tab to view settings."})}};return s?t==="bulk-actions"&&s?.features?.campaignsEnabled?e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col",children:[e.jsxs("div",{className:"h-16 bg-white border-b border-gray-200 flex items-center px-8 sticky top-0 z-10 shrink-0",children:[e.jsxs("button",{onClick:()=>m("/company/dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors font-medium",children:[e.jsx(me,{size:20})," Back to Dashboard"]}),e.jsx("div",{className:"h-6 w-px bg-slate-200 mx-4"}),e.jsx("button",{onClick:()=>a("company"),className:"text-sm font-bold text-slate-500 hover:text-slate-800",children:"Settings"})]}),e.jsx("div",{className:"flex-1",children:e.jsx(De,{companyId:s?.id})})]}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"h-16 bg-white border-b border-gray-200 mb-8 flex items-center px-8 sticky top-0 z-10",children:e.jsxs("button",{onClick:()=>m("/company/dashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 transition-colors font-medium",children:[e.jsx(me,{size:20})," Back to Dashboard"]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 pb-20",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsx("aside",{className:"w-full md:w-64 flex-shrink-0",children:e.jsxs("div",{className:"sticky top-24 space-y-1 bg-white/50 backdrop-blur-md rounded-2xl p-2 border border-slate-200/60 shadow-sm",children:[e.jsx("h3",{className:"px-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest mb-3 mt-2",children:"Organization"}),e.jsx(B,{id:"company",label:"Company Profile",icon:He,activeTab:t,onClick:a}),e.jsx(B,{id:"hiring",label:"Job Board",icon:le,activeTab:t,onClick:a}),e.jsx(B,{id:"team",label:"Team & Users",icon:J,activeTab:t,onClick:a}),e.jsx("h3",{className:"px-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-6 mb-3",children:"Communication"}),e.jsx(B,{id:"email",label:"Email Settings",icon:te,activeTab:t,onClick:a}),e.jsx(B,{id:"sms",label:"SMS Settings",icon:he,activeTab:t,onClick:a}),e.jsx("h3",{className:"px-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-6 mb-3",children:"Revenue & Reach"}),e.jsx(B,{id:"integrations",label:"Integrations",icon:We,activeTab:t,onClick:a}),e.jsx(B,{id:"bulk-actions",label:"Bulk Actions",icon:Ds,activeTab:t,onClick:a}),e.jsx("h3",{className:"px-4 text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-6 mb-3",children:"Account Control"}),e.jsx(B,{id:"billing",label:"Billing & Plan",icon:Me,activeTab:t,onClick:a}),e.jsx(B,{id:"personal",label:"Security Profile",icon:is,activeTab:t,onClick:a})]})}),e.jsxs("main",{className:"flex-1 min-h-[600px] relative",children:[d&&e.jsxs("div",{className:"fixed bottom-8 right-8 bg-green-600 text-white px-6 py-3 rounded-lg shadow-xl flex items-center gap-3 animate-in slide-in-from-bottom-5 z-50",children:[e.jsx(W,{size:20})," ",d]}),j()]})]})}),h&&e.jsx(Hs,{companyId:s.id,onClose:()=>g(!1)})]}):null}const Bt=Object.freeze(Object.defineProperty({__proto__:null,CompanySettings:Ct},Symbol.toStringTag,{value:"Module"}));export{Bt as C,fe as R};
