import{c as te,j as e,a1 as Ee,r as a,$ as He,X as se,a2 as he,a3 as Be,V as re,a as X,d as R,e as pe,q as Z,n as H,F as q,a4 as ce,l as be,a5 as tt,g as ae,o as ie,A as qe,Z as fe,a6 as st,a7 as ve,W as Te,L as le,D as Ne,a8 as at,a9 as rt,m as oe,aa as lt,Q as nt,_ as it,z as Ve,H as J,p as W,G as _e,s as G,E as We,I as Re,x as ye,y as je,ab as Ue,ac as Le,ad as ze,ae as Se,af as Ye,ag as De,h as K,a0 as Ae,S as we,Y as ot,C as ct,k as Qe,w as xe,U as ue,ah as Ge,ai as Xe,f as dt,aj as xt}from"./index-DL8sidqm.js";import{L as ut,g as mt}from"./userService-CF_Ufzlf.js";import{C as Ze,A as ht,W as pt,S as gt}from"./wrench-C8_VYHIS.js";import{F as Ce}from"./file-text-CIYiZE-Y.js";import{s as bt,m as ft,b as yt,E as Ke,c as jt,D as vt,S as Pe,d as Nt,u as wt,B as kt,e as St,A as Ct}from"./ApplicationDetailView-BbGvLvgh.js";import{S as Tt}from"./save-BKvBBKs-.js";import{F as Lt}from"./file-check-DflsTgv3.js";import{S as zt,U as Dt}from"./upload-CA7-GPEs.js";import{S as At}from"./trash-2-wanxsFLc.js";import"./dollar-sign-Dv4Qb7XK.js";const Pt=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M15 8h6",key:"8ybuxh"}],["path",{d:"M18 5v6",key:"g5ayrv"}],["path",{d:"M20.002 14.464a9 9 0 0 0 .738.863A1 1 0 0 1 20 17H4a1 1 0 0 1-.74-1.673C4.59 13.956 6 12.499 6 8a6 6 0 0 1 8.75-5.332",key:"1abcvy"}]],Et=te("bell-plus",Pt);const _t=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],Ie=te("bell",_t);const Rt=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],me=te("check",Rt);const Ut=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],It=te("chevron-down",Ut);const Mt=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],ne=te("globe",Mt);const $t=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],Ot=te("panels-top-left",$t);const Ft=[["path",{d:"M14 4a1 1 0 0 1 1-1",key:"dhj8ez"}],["path",{d:"M15 10a1 1 0 0 1-1-1",key:"1mnyi5"}],["path",{d:"M21 4a1 1 0 0 0-1-1",key:"sfs9ap"}],["path",{d:"M21 9a1 1 0 0 1-1 1",key:"mp6qeo"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5a2 2 0 0 1 2-2h2",key:"15xut4"}],["rect",{x:"3",y:"14",width:"7",height:"7",rx:"1",key:"1bkyp8"}]],Ht=te("replace",Ft);const Bt=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],qt=te("shield-alert",Bt);const Vt=[["path",{d:"M10 14.66v1.626a2 2 0 0 1-.976 1.696A5 5 0 0 0 7 21.978",key:"1n3hpd"}],["path",{d:"M14 14.66v1.626a2 2 0 0 0 .976 1.696A5 5 0 0 1 17 21.978",key:"rfe1zi"}],["path",{d:"M18 9h1.5a1 1 0 0 0 0-5H18",key:"7xy6bh"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M6 9a6 6 0 0 0 12 0V3a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z",key:"1mhfuq"}],["path",{d:"M6 9H4.5a1 1 0 0 1 0-5H6",key:"tex48p"}]],Me=te("trophy",Vt);function ge({title:t,value:r,icon:l,active:o,onClick:x,colorClass:p,id:i}){return e.jsx("div",{id:i,onClick:x,className:`p-4 rounded-xl shadow-sm border transition-all cursor-pointer flex flex-col justify-between h-full relative overflow-hidden group min-h-[90px]
        ${o?`ring-2 ring-offset-1 ${p} bg-white`:"bg-white border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-gray-500 truncate",title:t,children:t}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1 truncate",title:r,children:r})]}),e.jsx("div",{className:`p-2 rounded-lg shrink-0 ${o?p.replace("ring-","bg-").replace("500","50")+" text-"+p.split("-")[1]+"-600":"bg-gray-100 text-gray-500 group-hover:bg-gray-200"}`,children:Ee.isValidElement(l)?Ee.cloneElement(l,{size:18}):l})]})})}const Wt="https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3";function Yt(t){const[r,l]=a.useState([]),[o,x]=a.useState(0),p=a.useRef(new Set),i=a.useRef(null);a.useEffect(()=>(i.current=new Audio(Wt),()=>{i.current&&(i.current.pause(),i.current=null)}),[]),a.useEffect(()=>{if(!t)return;const g=bt(t,d=>{l(d)});return()=>g()},[t]);const{general:v,callbacks:b}=a.useMemo(()=>{const g=[],d=[];return r.forEach(s=>{s.type==="callback"&&s.scheduledFor?d.push(s):g.push(s)}),g.sort((s,u)=>(u.createdAt?.seconds||0)-(s.createdAt?.seconds||0)),d.sort((s,u)=>new Date(s.scheduledFor)-new Date(u.scheduledFor)),{general:g,callbacks:d}},[r]);return a.useEffect(()=>{const g=()=>{const s=new Date,u=new Date(s.getTime()+5*6e4);let C=0,S=!1;b.forEach(j=>{if(j.isRead)return;new Date(j.scheduledFor)<=u&&(C++,p.current.has(j.id)||(S=!0,p.current.add(j.id)))}),x(C),S&&i.current&&i.current.play().catch(j=>console.warn("Audio play blocked:",j))};g();const d=setInterval(g,3e4);return()=>clearInterval(d)},[b]),{notifications:r,general:v,callbacks:b,upcomingCount:o,markAsRead:g=>ft(g),markListAsRead:g=>{yt(g==="callbacks"?b:v)}}}function $e({notification:t,onClick:r}){const{id:l,title:o,message:x,isRead:p,status:i,createdAt:v,scheduledFor:b,type:f,link:h}=t,g=f==="callback"&&b,d=i==="completed";let s,u,C;if(g){s=new Date(b);const c=new Date;u=c>s&&!d,C=c>new Date(s.getTime()-5*6e4)&&!d}let S="p-4 hover:bg-gray-50 transition-colors cursor-pointer flex gap-3 group relative border-b border-gray-100 last:border-0";d?S+=" bg-gray-50 opacity-75":p?S+=" bg-white":g?S+=" bg-orange-50/40":S+=" bg-blue-50/40";const j=async(c,N)=>{c.stopPropagation(),await jt(l,N)},n=()=>{if(d)return e.jsx("div",{className:"mt-1 w-8 h-8 rounded-full flex items-center justify-center shrink-0 bg-green-100 text-green-600",children:e.jsx(me,{size:16})});if(g){let c=u?"bg-red-100 text-red-600":"bg-orange-100 text-orange-600";return e.jsx("div",{className:`mt-1 w-8 h-8 rounded-full flex items-center justify-center shrink-0 ${c}`,children:e.jsx(he,{size:16})})}else return e.jsx("div",{className:`mt-1 w-2 h-2 rounded-full shrink-0 ${p?"bg-gray-300":"bg-blue-500"}`})};return e.jsxs("li",{onClick:r,className:S,children:[n(),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h4",{className:`text-sm truncate pr-6 ${p?"font-medium text-gray-700":"font-bold text-gray-900"} ${d?"line-through text-gray-500":""}`,children:o}),g&&!d&&e.jsx("span",{className:`text-[10px] font-bold px-1.5 py-0.5 rounded ${u?"bg-red-100 text-red-600":"bg-gray-100 text-gray-500"}`,children:s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("p",{className:`text-xs text-gray-500 mt-1 line-clamp-2 ${d?"line-through opacity-70":""}`,children:x}),e.jsx("div",{className:"mt-2 flex items-center gap-2 text-[10px] text-gray-400",children:g?e.jsxs(e.Fragment,{children:[e.jsx(He,{size:10})," ",s.toLocaleDateString(),u&&!d&&e.jsx("span",{className:"text-red-500 font-bold ml-auto",children:"Overdue"}),!u&&C&&!d&&e.jsx("span",{className:"text-orange-500 font-bold ml-auto",children:"Due Soon"})]}):e.jsx("span",{children:v?.seconds?new Date(v.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"})})]}),e.jsxs("div",{className:"absolute right-2 top-2 flex flex-col gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[!d&&e.jsx("button",{onClick:c=>j(c,"completed"),className:"p-1.5 bg-green-100 text-green-600 rounded-full hover:bg-green-200 shadow-sm",title:"Mark as Complete",children:e.jsx(me,{size:12})}),e.jsx("button",{onClick:c=>j(c,"dismissed"),className:"p-1.5 bg-gray-100 text-gray-500 rounded-full hover:bg-red-100 hover:text-red-600 shadow-sm",title:"Dismiss",children:e.jsx(se,{size:12})})]}),h&&e.jsx("div",{className:"absolute bottom-2 right-2 opacity-50",children:e.jsx(Ke,{size:12})})]})}function Qt({userId:t}){const[r,l]=a.useState(!1),[o,x]=a.useState("general"),p=a.useRef(null),i=Be(),{general:v,callbacks:b,upcomingCount:f,markAsRead:h,markListAsRead:g}=Yt(t),d=v.filter(j=>!j.isRead).length,s=b.filter(j=>!j.isRead).length,u=d+s,C=()=>{r||(f>0||b.length>0&&v.length===0?x("callbacks"):x("general")),l(!r)};a.useEffect(()=>{const j=n=>{p.current&&!p.current.contains(n.target)&&l(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const S=j=>{h(j.id),j.link&&(i(j.link),l(!1))};return e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("button",{onClick:C,className:`p-2 rounded-full transition-all relative ${f>0?"bg-orange-100 text-orange-600 hover:bg-orange-200 animate-pulse":"text-gray-500 hover:bg-gray-100"}`,children:[f>0?e.jsx(re,{size:20,className:"fill-orange-500"}):e.jsx(Ie,{size:20}),u>0&&e.jsx("span",{className:`absolute top-0 right-0 w-4 h-4 text-[10px] font-bold flex items-center justify-center rounded-full shadow-sm ring-2 ring-white ${f>0?"bg-red-600 text-white":"bg-blue-600 text-white"}`,children:u>9?"9+":u})]}),r&&e.jsxs("div",{className:"absolute right-0 mt-2 w-80 sm:w-96 bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden z-[9999] animate-in fade-in zoom-in-95 duration-100",children:[e.jsxs("div",{className:"bg-gray-50 border-b border-gray-200 flex",children:[e.jsxs("button",{onClick:()=>x("general"),className:`flex-1 py-3 text-xs font-bold uppercase tracking-wide border-b-2 transition-colors ${o==="general"?"border-blue-600 text-blue-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["General ",d>0&&e.jsx("span",{className:"ml-1 bg-gray-200 text-gray-700 px-1.5 py-0.5 rounded-full",children:d})]}),e.jsxs("button",{onClick:()=>x("callbacks"),className:`flex-1 py-3 text-xs font-bold uppercase tracking-wide border-b-2 transition-colors ${o==="callbacks"?"border-orange-500 text-orange-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700"}`,children:["Callbacks ",s>0&&e.jsx("span",{className:"ml-1 bg-orange-100 text-orange-700 px-1.5 py-0.5 rounded-full",children:s})]})]}),e.jsxs("div",{className:"p-2 px-4 bg-white border-b border-gray-50 flex justify-between items-center",children:[e.jsx("span",{className:"text-xs text-gray-400 font-medium",children:o==="callbacks"?"Scheduled Calls":"Recent Activity"}),(o==="callbacks"?s:d)>0&&e.jsxs("button",{onClick:()=>g(o),className:"text-xs font-semibold text-blue-600 hover:text-blue-800 flex items-center gap-1",children:[e.jsx(me,{size:12})," Mark read"]})]}),e.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:o==="callbacks"?b.length===0?e.jsxs("div",{className:"p-10 text-center text-gray-400",children:[e.jsx(re,{size:32,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No scheduled callbacks."})]}):e.jsx("ul",{className:"divide-y divide-gray-100",children:b.map(j=>e.jsx($e,{notification:j,onClick:()=>S(j)},j.id))}):v.length===0?e.jsxs("div",{className:"p-10 text-center text-gray-400",children:[e.jsx(Ie,{size:32,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{className:"text-sm",children:"No notifications yet."})]}):e.jsx("ul",{className:"divide-y divide-gray-100",children:v.map(j=>e.jsx($e,{notification:j,onClick:()=>S(j)},j.id))})})]})]})}function Gt(t){const[r,l]=a.useState([]),[o,x]=a.useState(!1),[p,i]=a.useState(""),[v,b]=a.useState(null),[f,h]=a.useState({applications:0,platformLeads:0,companyLeads:0,myLeads:0}),[g,d]=a.useState(20),[s,u]=a.useState(1),[C,S]=a.useState({}),[j,n]=a.useState(1),[c,N]=a.useState("applications"),[w,L]=a.useState(""),[y,k]=a.useState(""),[z,A]=a.useState({state:"",driverType:"",dob:"",assignee:""});a.useEffect(()=>{const E=setTimeout(()=>{k(w)},800);return()=>clearTimeout(E)},[w]);const P=a.useCallback(async()=>{if(t)try{const E=X(R,"companies",t,"applications"),D=await pe(E),T=X(R,"companies",t,"leads"),$=Z(T,H("isPlatformLead","==",!0)),Y=await pe($),M=Z(T,H("isPlatformLead","==",!1)),O=await pe(M);let U=0;if(q.currentUser){const B=Z(T,H("assignedTo","==",q.currentUser.uid));U=(await pe(B)).data().count}h({applications:D.data().count,platformLeads:Y.data().count,companyLeads:O.data().count,myLeads:U})}catch(E){console.error("Error fetching stats:",E)}},[t]),F=(E,D=!1)=>{let T=[];return c==="applications"?D||T.push(ie("submittedAt","desc")):c==="find_driver"?(T.push(H("isPlatformLead","==",!0)),D||T.push(ie("distributedAt","desc"))):c==="company_leads"?(T.push(H("isPlatformLead","==",!1)),D||T.push(ie("createdAt","desc"))):c==="my_leads"&&q.currentUser&&(T.push(H("assignedTo","==",q.currentUser.uid)),D||T.push(ie("createdAt","desc"))),z.state&&T.push(H("state","==",z.state.toUpperCase())),z.driverType&&T.push(H("driverType","array-contains",z.driverType)),z.assignee&&T.push(H("assignedTo","==",z.assignee)),T},I=a.useCallback(async()=>{if(t){x(!0),i("");try{const D=X(R,"companies",t,c==="applications"?"applications":"leads");let T;const $=!!y;if($){const U=y.trim();let B=F(D,!0);const ee=/^[0-9+() -]{7,}$/.test(U);if(U.includes("@"))B.push(H("email","==",U.toLowerCase()));else if(ee){const Q=ce(U);B.push(H("phone","==",U))}else{const Q=U.charAt(0).toUpperCase()+U.slice(1);B.push(H("lastName",">=",Q)),B.push(H("lastName","<=",Q+"ï£¿"))}B.push(be(50)),T=Z(D,...B)}else{let U=F(D,!1);if(s>1){const B=C[s-1];if(B)U.push(tt(B));else{u(1);return}}U.push(be(g)),T=Z(D,...U)}const Y=await ae(T),M=Y.docs.map(U=>({id:U.id,companyId:t,...U.data()}));if(l(M),!$&&Y.docs.length>0){const U=Y.docs[Y.docs.length-1];S(B=>({...B,[s]:U}))}const O=c==="applications"?f.applications:c==="find_driver"?f.platformLeads:c==="company_leads"?f.companyLeads:f.myLeads;n($?1:Math.ceil(O/g)||1)}catch(E){console.error("Dashboard fetch error:",E),E.message.includes("requires an index")?(i("Missing Index: Please verify Firebase Console indexes."),console.warn("Index Link:",E)):i("Failed to load data.")}finally{x(!1)}}},[t,c,s,g,y,z,C,f]);a.useEffect(()=>{(async()=>{if(!t||c!=="find_driver"){b(null);return}try{const D=X(R,"companies",t,"leads"),T=Z(D,H("isPlatformLead","==",!0),ie("distributedAt","desc"),be(1)),$=await ae(T);if($.empty)b(null);else{const Y=$.docs[0].data();b(Y.distributedAt||Y.createdAt)}}catch{b(null)}})()},[t,c]),a.useEffect(()=>{P()},[t,P]),a.useEffect(()=>{l([]),S({}),u(1)},[c,t,y,z]),a.useEffect(()=>{I()},[I]);const m=E=>{d(E),u(1),S({})},_=(E,D)=>{A(T=>({...T,[E]:D}))};return{paginatedData:r,counts:f,latestBatchTime:v,loading:o,error:p,refreshData:()=>{P(),I()},currentPage:s,itemsPerPage:g,totalPages:j,totalCount:c==="applications"?f.applications:c==="find_driver"?f.platformLeads:c==="company_leads"?f.companyLeads:f.myLeads,setItemsPerPage:m,nextPage:()=>u(E=>E+1),prevPage:()=>u(E=>Math.max(1,E-1)),activeTab:c,setActiveTab:N,searchQuery:w,setSearchQuery:L,filters:z,setFilters:_}}function Xt({onClose:t,onGoToLeads:r,featureName:l="Search For Drivers"}){return e.jsx("div",{className:"fixed inset-0 bg-gray-900/70 flex items-center justify-center p-4 z-[60] backdrop-blur-sm animate-in fade-in duration-300",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-2xl border border-white/20 overflow-hidden relative",children:[e.jsx("button",{onClick:t,className:"absolute top-4 right-4 p-2 bg-white/80 hover:bg-white rounded-full transition-colors z-30 text-gray-500 hover:text-gray-800 shadow-sm",children:e.jsx(se,{size:20})}),e.jsxs("div",{className:"relative bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 p-12 text-center overflow-hidden",children:[e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-64 h-64 bg-blue-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse",style:{animationDuration:"8s"}}),e.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-64 h-64 bg-purple-200 rounded-full mix-blend-multiply filter blur-3xl opacity-30 animate-pulse",style:{animationDuration:"10s"}}),e.jsx("div",{className:"absolute top-[40%] left-[30%] w-32 h-32 bg-indigo-200 rounded-full mix-blend-multiply filter blur-3xl opacity-20 animate-pulse",style:{animationDuration:"12s"}})]}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center",children:[e.jsxs("div",{className:"relative mb-8 group cursor-default",children:[e.jsx("div",{className:"absolute inset-0 bg-blue-500 rounded-full blur opacity-20 group-hover:opacity-30 transition-opacity duration-500"}),e.jsxs("div",{className:"relative bg-white p-6 rounded-full shadow-xl border border-blue-100 ring-4 ring-blue-50",children:[e.jsx(qe,{size:40,className:"text-blue-600"}),e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-yellow-400 p-1.5 rounded-full border-2 border-white shadow-sm animate-bounce",style:{animationDuration:"3s"},children:e.jsx(vt,{size:14,className:"text-yellow-900"})})]})]}),e.jsx("h2",{className:"text-3xl font-extrabold text-gray-900 mb-3 tracking-tight",children:l}),e.jsx("div",{className:"mb-6",children:e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-4 py-1.5 rounded-full text-xs font-bold bg-gradient-to-r from-blue-600 to-indigo-600 text-white shadow-md uppercase tracking-wider",children:[e.jsx(fe,{size:12,fill:"currentColor"})," Coming Soon"]})}),e.jsxs("div",{className:"w-full max-w-xs mx-auto mb-8",children:[e.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-500 uppercase mb-2",children:[e.jsx("span",{children:"Development Progress"}),e.jsx("span",{children:"92%"})]}),e.jsx("div",{className:"h-2.5 bg-gray-200 rounded-full overflow-hidden shadow-inner",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 w-[92%] rounded-full relative",children:e.jsx("div",{className:"absolute inset-0 bg-white/30 w-full h-full animate-[shimmer_2s_infinite]"})})})]}),e.jsxs("p",{className:"text-gray-600 text-lg max-w-md mx-auto mb-8 leading-relaxed",children:["We are finalizing the global driver search engine.",e.jsx("br",{}),"In the meantime, you can still access high-intent drivers through our distribution system."]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 w-full max-w-md justify-center",children:[e.jsxs("button",{onClick:r,className:"flex-1 px-6 py-3.5 bg-blue-600 text-white font-bold rounded-xl hover:bg-blue-700 transition-all shadow-lg hover:shadow-blue-200 hover:-translate-y-0.5 flex items-center justify-center gap-2 group",children:[e.jsx(fe,{size:18,className:"fill-blue-200 text-blue-100"}),"Go to SafeHaul Leads",e.jsx(st,{size:18,className:"group-hover:translate-x-1 transition-transform"})]}),e.jsx("button",{onClick:t,className:"px-6 py-3.5 bg-white text-gray-700 font-bold rounded-xl border border-gray-200 hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm",children:"Close"})]})]})]}),e.jsx("style",{children:`
          @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
          }
        `})]})})}const Zt=[{id:"interested",label:"Connected / Interested",icon:e.jsx(Ne,{size:18,className:"text-green-600"}),color:"border-green-200 bg-green-50 text-green-800"},{id:"callback",label:"Connected / Scheduled Callback",icon:e.jsx(he,{size:18,className:"text-blue-600"}),color:"border-blue-200 bg-blue-50 text-blue-800"},{id:"not_qualified",label:"Connected / Not Qualified",icon:e.jsx(at,{size:18,className:"text-orange-600"}),color:"border-orange-200 bg-orange-50 text-orange-800"},{id:"not_interested",label:"Connected / Not Interested",icon:e.jsx(rt,{size:18,className:"text-gray-600"}),color:"border-gray-200 bg-gray-50 text-gray-800"},{id:"hired_elsewhere",label:"Connected / Hired Elsewhere",icon:e.jsx(oe,{size:18,className:"text-purple-600"}),color:"border-purple-200 bg-purple-50 text-purple-800"},{id:"voicemail",label:"Left Voicemail",icon:e.jsx(lt,{size:18,className:"text-yellow-600"}),color:"border-yellow-200 bg-yellow-50 text-yellow-800"},{id:"no_answer",label:"No Answer",icon:e.jsx(nt,{size:18,className:"text-red-600"}),color:"border-red-200 bg-red-50 text-red-800"},{id:"wrong_number",label:"Wrong Number",icon:e.jsx(it,{size:18,className:"text-red-400"}),color:"border-red-200 bg-red-50 text-red-800"}],Kt=["Dry Van","Reefer","Flatbed","Tanker","Box Truck","Car Hauler","Step Deck","Lowboy","Conestoga","Intermodal","Power Only","Hotshot"],Jt=["Company Driver (Solo)","Company Driver (Team)","Lease Operator (Solo)","Lease Operator (Team)","Owner Operator (Solo)","Owner Operator (Team)","Lease to Purchase (Solo)","Lease to Purchase (Team)"],es=["Less than 6 months","Less than 1 year","More than 1 year","More than 2 years","More than 5 years"],ts=t=>{if(!t)return"";let r=ce(t);return r.length===10&&(r="1"+r),`https://t.me/+${r}`};function ss({lead:t,onClose:r,outcome:l,setOutcome:o,notes:x,setNotes:p,driverType:i,setDriverType:v,experienceLevel:b,setExperienceLevel:f,position:h,setPosition:g,callbackDate:d,setCallbackDate:s,callbackTime:u,setCallbackTime:C,saving:S,handleSave:j,showDetailInputs:n,showCallbackSelect:c,onQuickReminder:N,companySlug:w}){const[L,y]=a.useState(!1),k=()=>{const m=new Date;m.setHours(m.getHours()+1);const _=m.toISOString().split("T")[0],E=m.toTimeString().split(" ")[0].substring(0,5);s(_),C(E),o("callback"),p("Quick reminder set: No Answer (1 hr follow-up)")},z=window.location.origin,A=q.currentUser?.uid,P=w||"general",F=`${z.replace(/\/$/,"")}/interest/${P}?r=${A}&l=${t.id}`,I=()=>{navigator.clipboard.writeText(F),y(!0),setTimeout(()=>y(!1),2e3)};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[70] backdrop-blur-sm",onClick:r,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-md border border-gray-200 overflow-hidden max-h-[90vh] flex flex-col",onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"bg-blue-600 p-4 text-white flex justify-between items-center shrink-0",children:[e.jsxs("h3",{className:"font-bold flex items-center gap-2",children:[e.jsx(re,{size:20})," Log Call Result"]}),e.jsx("button",{onClick:r,className:"p-1 hover:bg-white/20 rounded-full",children:e.jsx(se,{size:20})})]}),e.jsxs("div",{className:"p-3 bg-gray-50 border-b border-gray-200 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"text-sm",children:[e.jsx("span",{className:"text-gray-500",children:"Driver: "}),e.jsxs("span",{className:"font-bold text-gray-900",children:[t.firstName," ",t.lastName]})]}),t.phone&&e.jsxs("a",{href:`tel:${t.phone}`,className:"text-xs bg-green-100 text-green-700 px-3 py-1.5 rounded-full font-bold flex items-center gap-1 hover:bg-green-200 transition-colors",title:"Call now",children:[e.jsx(re,{size:12,fill:"currentColor"})," ",ve(t.phone)]})]}),e.jsxs("form",{onSubmit:j,className:"p-5 space-y-5 overflow-y-auto",children:[e.jsx("div",{className:"grid grid-cols-2 gap-3",children:Zt.map(m=>{if(m.id==="hired_elsewhere"&&!t.isPlatformLead)return null;const _=l===m.id;return e.jsxs("button",{type:"button",onClick:()=>o(m.id),className:`p-3 rounded-lg border text-xs font-bold flex flex-col items-center gap-2 transition-all text-center ${_?`${m.color} ring-2 ring-offset-1 ring-blue-500`:"border-gray-200 hover:bg-gray-50 text-gray-600"}`,children:[m.icon,m.label]},m.id)})}),l==="interested"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-xl animate-in fade-in slide-in-from-top-2",children:e.jsxs("div",{className:"flex gap-3 items-start",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg text-blue-600 shrink-0",children:e.jsx(Pe,{size:20})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h4",{className:"text-sm font-bold text-blue-900",children:"Next Step: Send Invite"}),e.jsxs("p",{className:"text-xs text-blue-700 mt-1 mb-3 break-words",children:['Send this specific link. It asks "Are you interested?" and assigns them to ',e.jsx("strong",{children:"YOU"})," upon confirmation."]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded border border-blue-100 w-full",children:[e.jsx("code",{className:"flex-1 text-xs font-mono text-gray-500 truncate block",children:F}),e.jsx("button",{type:"button",onClick:I,className:"text-blue-600 hover:text-blue-800 shrink-0",children:L?e.jsx(me,{size:14}):e.jsx(Ze,{size:14})})]})]})]})}),l==="no_answer"&&e.jsx("div",{className:"flex justify-center animate-in fade-in",children:e.jsxs("button",{type:"button",onClick:k,className:"flex items-center gap-2 px-4 py-2 bg-orange-100 text-orange-700 text-xs font-bold rounded-full hover:bg-orange-200 transition-colors",children:[e.jsx(Et,{size:14})," Remind me in 1 Hour"]})}),c&&e.jsxs("div",{className:"animate-in fade-in slide-in-from-top-2 bg-blue-50 p-3 rounded-lg border border-blue-100",children:[e.jsxs("label",{className:"block text-xs font-bold text-blue-800 uppercase mb-2 flex items-center gap-1",children:[e.jsx(he,{size:12})," Schedule Callback"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-500 mb-1",children:"Date"}),e.jsx("input",{type:"date",className:"w-full p-2 border border-blue-200 rounded text-sm focus:ring-2 focus:ring-blue-500 outline-none",value:d,onChange:m=>s(m.target.value),min:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-500 mb-1",children:"Time"}),e.jsx("input",{type:"time",className:"w-full p-2 border border-blue-200 rounded text-sm focus:ring-2 focus:ring-blue-500 outline-none",value:u,onChange:m=>C(m.target.value)})]})]})]}),n&&e.jsxs("div",{className:"space-y-3 pt-2 border-t border-gray-100 animate-in fade-in slide-in-from-top-2",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase",children:"Verify Driver Details"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-400 mb-1",children:"Position"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:h,onChange:m=>g(m.target.value),children:[e.jsx("option",{value:"",children:"-- Select Position --"}),Jt.map(m=>e.jsx("option",{value:m,children:m},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-400 mb-1",children:"Experience"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:b,onChange:m=>f(m.target.value),children:[e.jsx("option",{value:"",children:"-- Select Experience --"}),es.map(m=>e.jsx("option",{value:m,children:m},m))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[10px] text-gray-400 mb-1",children:"Freight Type"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg text-sm bg-white focus:ring-2 focus:ring-blue-500 outline-none",value:i,onChange:m=>v(m.target.value),children:[e.jsx("option",{value:"",children:"-- Select Type --"}),Kt.map(m=>e.jsx("option",{value:m,children:m},m))]})]}),e.jsxs("p",{className:"text-[10px] text-gray-400 italic flex items-center gap-1",children:[e.jsx(Te,{size:10})," Updating these fields helps the network."]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1",children:"Recruiter Notes"}),e.jsx("textarea",{className:"w-full p-3 border border-gray-300 rounded-lg text-sm focus:ring-2 focus:ring-blue-500 outline-none",rows:"3",placeholder:"Add specific details...",value:x,onChange:m=>p(m.target.value)})]}),l==="interested"&&t.phone&&e.jsxs("div",{className:"bg-green-50 p-3 rounded-lg border border-green-100 text-sm text-green-800 animate-in fade-in flex justify-between items-center",children:[e.jsx("span",{className:"text-xs font-medium",children:"Chat open?"}),e.jsxs("a",{href:ts(t.phone),target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-1 text-xs text-green-700 hover:text-green-900 hover:underline font-bold",children:[e.jsx(Ke,{size:12})," Open Telegram"]})]})]}),e.jsxs("div",{className:"p-4 bg-gray-50 border-t border-gray-200 flex justify-end gap-3 shrink-0",children:[e.jsx("button",{onClick:r,className:"px-4 py-2 text-gray-600 font-medium hover:bg-gray-200 rounded-lg text-sm",children:"Cancel"}),e.jsxs("button",{type:"submit",onClick:j,disabled:S,className:"px-6 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 disabled:opacity-50 flex items-center gap-2 text-sm shadow-md",children:[S?e.jsx(le,{className:"animate-spin",size:16}):e.jsx(Tt,{size:16}),c?"Schedule & Save":"Save Result"]})]})]})})}const Oe=[{id:"interested",isContact:!0,label:"Connected / Interested",status:"Contacted",archive:!1},{id:"callback",isContact:!0,label:"Connected / Scheduled Callback",status:"Contacted",archive:!1},{id:"not_qualified",isContact:!0,label:"Connected / Not Qualified",status:"Disqualified",archive:!0},{id:"not_interested",isContact:!0,label:"Connected / Not Interested",status:"Rejected",archive:!0},{id:"hired_elsewhere",isContact:!0,label:"Connected / Hired Elsewhere",status:"Disqualified",archive:!0},{id:"voicemail",isContact:!1,label:"Left Voicemail",status:"Attempted",archive:!1},{id:"no_answer",isContact:!1,label:"No Answer",status:"Attempted",archive:!1},{id:"wrong_number",isContact:!1,label:"Wrong Number",status:"Disqualified",archive:!0}];function as(t,r,l,o){const{showSuccess:x,showError:p}=Ve(),[i,v]=a.useState("interested"),[b,f]=a.useState(""),[h,g]=a.useState(t.driverType||""),[d,s]=a.useState(t.experienceLevel||t.experience||""),[u,C]=a.useState(t.positionApplyingTo||""),[S,j]=a.useState(""),[n,c]=a.useState(""),[N,w]=a.useState(!1),[L,y]=a.useState("Recruiter"),[k,z]=a.useState("");a.useEffect(()=>{(async()=>{if(!q.currentUser)return;let m=q.currentUser.displayName;if(!m){const _=await J(W(R,"users",q.currentUser.uid));_.exists()&&_.data().name&&(m=_.data().name)}if(m&&y(m),r)try{const _=await J(W(R,"companies",r));_.exists()&&z(_.data().appSlug||r)}catch(_){console.error("Error fetching company slug",_)}})()},[r]);const A=["interested","callback","not_qualified","not_interested","hired_elsewhere"].includes(i),P=i==="callback";return{outcome:i,setOutcome:v,notes:b,setNotes:f,driverType:h,setDriverType:g,experienceLevel:d,setExperienceLevel:s,position:u,setPosition:C,callbackDate:S,setCallbackDate:j,callbackTime:n,setCallbackTime:c,saving:N,handleSave:async I=>{if(I&&I.preventDefault(),!q.currentUser)return;if(P&&(!S||!n)){p("Please select a date and time for the callback.");return}w(!0);const m=Oe.find($=>$.id===i)||Oe[0],_=m.label,E=m.status,D=m.archive,T=t.submittedAt||t.sourceType==="Company App"?"applications":"leads";try{const $=W(R,"companies",r,T,t.id);(await J($)).exists()||await _e($,{...t,status:"Attempted",createdAt:G(),updatedAt:G(),source:"Search DB Call",isPlatformLead:!0,originalLeadId:t.id});const M={lastContactedAt:G(),lastContactedBy:q.currentUser.uid,lastCallOutcome:_,status:E};D&&(M.archived=!0,M.archivedAt=G());let O=!1;A&&(h!==(t.driverType||"")&&(M.driverType=h,O=!0),d!==(t.experienceLevel||"")&&(M.experienceLevel=d,M.experience=d,O=!0),u!==(t.positionApplyingTo||"")&&(M.positionApplyingTo=u,O=!0),O&&(M.infoSource="recruiter",M.driverTypeSource="recruiter")),await We($,M),await Re(X(R,"companies",r,T,t.id,"activities"),{type:"call",outcome:i,outcomeLabel:_,isContact:m.isContact,notes:b,dataChanged:O,performedBy:q.currentUser.uid,performedByName:L,companyId:r,leadId:t.id,timestamp:G()});let U=`[Call Log: ${_}]`;A&&O&&(U+=`
[Updated Details]: Type: ${h}, Exp: ${d}, Pos: ${u}`),P&&(U+=`
ðŸ“… Callback: ${S} at ${n}`),b&&(U+=`
${b}`),await Re(X(R,"companies",r,T,t.id,"internal_notes"),{text:U,author:L,createdAt:G(),type:"call_log"});const B=W(R,"drivers",t.id),ee={lastNetworkCall:{outcome:_,timestamp:G()}};if(O&&(h&&(ee["driverProfile.type"]=h),d&&(ee["qualifications.experienceYears"]=d),ee.infoSource="recruiter"),await _e(B,ee,{merge:!0}).catch(V=>console.log("Skipped global update:",V)),t.isPlatformLead&&(i==="hired_elsewhere"||i==="not_interested"||i==="not_qualified")&&ye(je,"handleLeadOutcome")({leadId:t.originalLeadId||t.id,companyId:r,outcome:i}).catch(Q=>console.error("Failed to report outcome to pool:",Q)),P){const V=new Date(`${S}T${n}`);await Nt({recipientId:q.currentUser.uid,title:`ðŸ“ž Callback: ${t.firstName} ${t.lastName}`,message:b||"Scheduled followup call.",type:"callback",scheduledFor:V,metadata:{leadId:t.id,companyId:r,phone:t.phone}})}["no_answer","voicemail"].includes(i)&&t.email&&!t.email.includes("placeholder.com")&&ye(je,"sendAutomatedEmail")({companyId:r,recipientEmail:t.email,triggerType:"no_answer",placeholders:{driverfullname:`${t.firstName} ${t.lastName}`,driverfirstname:t.firstName,recruitername:L}}).catch(Q=>console.error("Automation failed silently:",Q)),x(`Call logged as ${_}`),l&&l(),o()}catch($){console.error("Error logging call:",$),p(`Failed to save call log. Error: ${$.message}`)}finally{w(!1)}},showDetailInputs:A,showCallbackSelect:P,showSuccess:x,companySlug:k,onQuickReminder:()=>{}}}function Je({lead:t,companyId:r,onClose:l,onUpdate:o}){const x=as(t,r,o,l);return e.jsx(ss,{lead:t,onClose:l,...x})}function rs({onClose:t}){return e.jsx("div",{className:"fixed inset-0 bg-gray-900/60 flex items-center justify-center p-4 z-[60] backdrop-blur-sm animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl border border-gray-200 overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 bg-gradient-to-r from-purple-700 to-indigo-800 text-white flex justify-between items-start shrink-0",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ne,{className:"text-purple-200",size:24}),e.jsx("h2",{className:"text-2xl font-bold",children:"How SafeHaul Leads Work"})]}),e.jsx("p",{className:"text-purple-100 text-sm max-w-lg",children:"Our exclusive lead generation system matches high-intent drivers with your company requirements."})]}),e.jsx("button",{onClick:t,className:"p-2 bg-white/10 hover:bg-white/20 rounded-full transition-colors",children:e.jsx(se,{size:20})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-8 space-y-10",children:[e.jsxs("section",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx(Ue,{className:"text-purple-600"})," The Lead Lifecycle"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 relative",children:[e.jsx("div",{className:"hidden md:block absolute top-12 left-[16%] right-[16%] h-0.5 bg-gray-200 -z-10"}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm relative text-center group hover:border-purple-300 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center mx-auto mb-4 font-bold text-xl border-4 border-white shadow-sm",children:e.jsx(he,{size:24})}),e.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"24-Hour Window"}),e.jsxs("p",{className:"text-sm text-gray-500 leading-relaxed",children:["You receive ",e.jsx("strong",{className:"text-purple-700",children:"50 (Free)"})," or ",e.jsx("strong",{className:"text-purple-700",children:"200 (Pro)"})," leads daily. You have exactly 24 hours to contact them. Unused leads rotate to other carriers."]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm relative text-center group hover:border-blue-300 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 font-bold text-xl border-4 border-white shadow-sm",children:e.jsx(Pe,{size:24})}),e.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Engage & Confirm"}),e.jsxs("p",{className:"text-sm text-gray-500 leading-relaxed",children:["Send your recruiter link. Once a driver replies or clicks, they are locked to your company for ",e.jsx("strong",{className:"text-blue-700",children:"7 Days"}),"."]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm relative text-center group hover:border-green-300 transition-colors",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 text-green-600 rounded-full flex items-center justify-center mx-auto mb-4 font-bold text-xl border-4 border-white shadow-sm",children:e.jsx(Lt,{size:24})}),e.jsx("h4",{className:"font-bold text-gray-800 mb-2",children:"Application"}),e.jsxs("p",{className:"text-sm text-gray-500 leading-relaxed",children:["The driver completes the full application. Once submitted, they are permanently added to your ",e.jsx("strong",{className:"text-green-700",children:"Direct Applications"})," list."]})]})]})]}),e.jsx("section",{className:"bg-gray-50 rounded-2xl p-6 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(zt,{className:"text-green-600"})," Data Privacy Guarantee"]}),e.jsxs("p",{className:"text-sm text-gray-600 leading-relaxed mb-4",children:["We value your proprietary data. Any leads or applications you upload directly or receive via your custom links are ",e.jsx("strong",{className:"text-gray-900",children:"exclusively yours"}),"."]}),e.jsxs("ul",{className:"space-y-3",children:[e.jsxs("li",{className:"flex items-start gap-3 text-sm text-gray-600",children:[e.jsx(qe,{size:18,className:"text-green-600 shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Encrypted Storage:"})," Your company data is encrypted. Even SafeHaul personnel cannot access your private driver lists."]})]}),e.jsxs("li",{className:"flex items-start gap-3 text-sm text-gray-600",children:[e.jsx(Ue,{size:18,className:"text-blue-600 shrink-0 mt-0.5"}),e.jsxs("span",{children:[e.jsx("strong",{children:"No Co-mingling:"})," We never recycle your private leads into the public SafeHaul pool."]})]})]})]}),e.jsx("div",{className:"w-px bg-gray-200 hidden md:block"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ne,{className:"text-blue-600"})," Lead Sources"]}),e.jsx("p",{className:"text-sm text-gray-600 leading-relaxed mb-4",children:'The "SafeHaul Leads" you see in this dashboard are generated independently by our marketing team through targeted campaigns across:'}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[e.jsx("span",{className:"px-3 py-1 bg-white border border-gray-300 rounded-full text-xs font-bold text-gray-600",children:"Facebook Ads"}),e.jsx("span",{className:"px-3 py-1 bg-white border border-gray-300 rounded-full text-xs font-bold text-gray-600",children:"Google Search"}),e.jsx("span",{className:"px-3 py-1 bg-white border border-gray-300 rounded-full text-xs font-bold text-gray-600",children:"Indeed"}),e.jsx("span",{className:"px-3 py-1 bg-white border border-gray-300 rounded-full text-xs font-bold text-gray-600",children:"TikTok"})]}),e.jsx("p",{className:"text-xs text-gray-400 italic",children:"*Any overlap with your existing drivers is purely coincidental based on market activity."})]})]})})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex justify-end",children:e.jsx("button",{onClick:t,className:"px-8 py-3 bg-purple-600 hover:bg-purple-700 text-white font-bold rounded-xl transition shadow-lg shadow-purple-200",children:"Got it, thanks!"})})]})})}function ls({className:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"})]})}function ns({lead:t,onClose:r,onCallStart:l}){const[o,x]=a.useState("overview"),[p,i]=a.useState(null),[v,b]=a.useState(!1),f=t.firstName||"Unknown",h=t.lastName||"Driver",g=`${f} ${h}`,d=t.city||"Unknown City",s=t.state||"XX",u=t.positionApplyingTo||"Unidentified",C=t.experienceLevel||t.experience||t["experience-years"],S=C?t.experienceLevel||Le(C):"Unidentified";let j="None";t.infoSource==="driver"&&(j="Driver Input"),t.infoSource==="recruiter"&&(j="User Input");let n=[];Array.isArray(t.driverType)?n=t.driverType:typeof t.driverType=="string"&&t.driverType&&(n=t.driverType.split(",").map(y=>y.trim())),a.useEffect(()=>{o==="insights"&&!p&&(async()=>{b(!0);try{const k=t.originalLeadId||t.id,z=W(R,"leads",k),A=await J(z);if(A.exists())i(A.data());else{const P=W(R,"drivers",k),F=await J(P);F.exists()&&i(F.data())}}catch(k){console.error("Error fetching insights:",k)}finally{b(!1)}})()},[o,t,p]);const c=p?.sharedHistory||t.sharedHistory||[],N=()=>{t.phone?(window.location.href=`tel:${t.phone}`,l()):alert("No phone number on record.")},w=()=>{t.email&&!t.email.includes("placeholder")?(window.location.href=`mailto:${t.email}`,l()):alert("No valid email address.")},L=()=>{if(t.phone){let y=ce(t.phone);y.length===10&&(y="1"+y);const k=`https://t.me/+${y}`;window.open(k,"_blank"),l()}else alert("No phone number for Telegram.")};return e.jsx("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl border border-gray-200 overflow-hidden flex flex-col max-h-[90vh] animate-in zoom-in-95 duration-200",children:[e.jsxs("div",{className:"bg-gradient-to-r from-slate-50 to-white border-b border-gray-200 p-6 flex justify-between items-start shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 text-white rounded-2xl flex items-center justify-center text-2xl font-bold shadow-blue-200 shadow-lg",children:f.charAt(0)}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:g}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"flex items-center gap-1 bg-gray-100 px-2 py-0.5 rounded text-gray-600",children:[e.jsx(ze,{size:12})," ",d,", ",s]}),e.jsxs("span",{className:"flex items-center gap-1 bg-purple-50 text-purple-700 px-2 py-0.5 rounded border border-purple-100 font-medium",children:[e.jsx(At,{size:12})," SafeHaul Lead"]})]})]})]}),e.jsx("button",{onClick:r,className:"p-2 hover:bg-gray-100 rounded-full text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(se,{size:24})})]}),e.jsxs("div",{className:"flex border-b border-gray-200 px-6 shrink-0 bg-white",children:[e.jsx("button",{onClick:()=>x("overview"),className:`py-3 px-4 text-sm font-bold border-b-2 transition-colors ${o==="overview"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-800"}`,children:"Driver Overview"}),e.jsxs("button",{onClick:()=>x("insights"),className:`py-3 px-4 text-sm font-bold border-b-2 transition-colors flex items-center gap-2 ${o==="insights"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-800"}`,children:[e.jsx(ne,{size:16})," Network Insights"]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 bg-gray-50",children:[o==="overview"&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-4 border-b border-gray-100 pb-2",children:"Qualifications"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 font-medium",children:"Position Applying For"}),e.jsxs("p",{className:"text-lg font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(oe,{size:18,className:"text-blue-500"}),u]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 font-medium",children:"Experience"}),e.jsxs("p",{className:"text-base font-semibold text-gray-800 flex items-center gap-2",children:[e.jsx(he,{size:16,className:"text-green-500"}),S]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 font-medium",children:"Source Input"}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsxs("span",{className:`inline-flex px-2 py-1 text-xs rounded font-medium border ${j==="None"?"bg-gray-100 text-gray-500 border-gray-200":j==="User Input"?"bg-blue-50 text-blue-700 border-blue-200":"bg-green-50 text-green-700 border-green-200"}`,children:[j==="User Input"&&e.jsx(Te,{size:10,className:"mr-1 mt-0.5"}),j]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs text-gray-500 font-medium block mb-2",children:"Freight Types"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:n.length>0&&n[0].toLowerCase()!=="unidentified"?n.map(y=>e.jsxs("span",{className:"px-3 py-1 bg-blue-50 text-blue-700 border border-blue-100 rounded-lg text-xs font-bold flex items-center gap-1",children:[e.jsx(Se,{size:12})," ",y]},y)):e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-gray-100 text-gray-500 border border-gray-200 rounded-lg text-xs font-bold",children:[e.jsx(Se,{size:12})," Unidentified"]})})]})]})]}),t.otherPreferences&&e.jsxs("div",{className:"bg-white p-5 rounded-xl border border-gray-200 shadow-sm",children:[e.jsx("h3",{className:"text-sm font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Driver Preferences"}),e.jsxs("p",{className:"text-sm text-gray-700 italic bg-gray-50 p-3 rounded-lg border border-gray-100",children:['"',t.otherPreferences,'"']})]})]}),e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-indigo-700 rounded-xl p-6 text-white shadow-lg relative overflow-hidden",children:[e.jsxs("div",{className:"relative z-10",children:[e.jsx("h3",{className:"text-xl font-bold mb-2",children:"Contact Driver"}),e.jsx("p",{className:"text-blue-100 text-sm mb-6",children:"Contact details are hidden for privacy. Use the secure actions below to connect."}),e.jsxs("div",{className:"space-y-3",children:[t.phone?e.jsxs("button",{onClick:N,className:"w-full py-3 px-4 bg-white text-blue-700 font-bold rounded-lg shadow-sm hover:bg-blue-50 transition-all flex items-center justify-center gap-3 group",children:[e.jsx("div",{className:"p-1.5 bg-blue-100 rounded-full group-hover:bg-blue-200 transition-colors",children:e.jsx(re,{size:18,className:"fill-blue-600"})}),e.jsx("span",{children:"Call Driver"})]}):e.jsx("div",{className:"w-full py-3 px-4 bg-white/10 text-white/50 font-bold rounded-lg border border-white/20 text-center text-sm",children:"No Phone Available"}),t.email&&!t.email.includes("placeholder")?e.jsxs("button",{onClick:w,className:"w-full py-3 px-4 bg-indigo-500/30 border border-white/20 text-white font-bold rounded-lg hover:bg-indigo-500/50 transition-all flex items-center justify-center gap-3",children:[e.jsx(Ye,{size:18}),e.jsx("span",{children:"Email Driver"})]}):null,t.phone&&e.jsxs("button",{onClick:L,className:"w-full py-3 px-4 bg-[#24A1DE] text-white font-bold rounded-lg hover:bg-[#2090C7] transition-all flex items-center justify-center gap-3 shadow-sm",children:[e.jsx(ls,{className:"w-5 h-5 fill-white"}),e.jsx("span",{children:"Telegram"})]})]})]}),e.jsx("div",{className:"absolute -top-10 -right-10 w-40 h-40 bg-white/10 rounded-full blur-2xl"}),e.jsx("div",{className:"absolute -bottom-10 -left-10 w-40 h-40 bg-purple-500/20 rounded-full blur-2xl"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-xl flex items-start gap-3",children:[e.jsx(De,{className:"text-yellow-600 shrink-0 mt-0.5",size:18}),e.jsxs("div",{className:"text-xs text-yellow-800",children:[e.jsx("p",{className:"font-bold mb-1",children:"Lead Pool Rules:"}),e.jsxs("ul",{className:"list-disc pl-3 space-y-1",children:[e.jsxs("li",{children:["Mark as ",e.jsx("strong",{children:"Interested"}),": Send invite link."]}),e.jsxs("li",{children:["Mark as ",e.jsx("strong",{children:"Hired"}),": Removed from pool for 45 days."]}),e.jsxs("li",{children:["Mark as ",e.jsx("strong",{children:"Rejected"}),": Returns to pool in 7 days."]})]})]})]})]})]}),o==="insights"&&e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-purple-50 p-6 rounded-xl border border-purple-100",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-2 flex items-center gap-2",children:[e.jsx(ne,{size:20})," Network Insights"]}),e.jsx("p",{className:"text-sm text-purple-700 mb-4",children:"Anonymized data from other recruiters in the SafeHaul network."}),v?e.jsxs("div",{className:"py-10 text-center text-purple-600 flex flex-col items-center",children:[e.jsx(le,{className:"animate-spin mb-2",size:24}),e.jsx("p",{className:"text-xs",children:"Checking global history..."})]}):e.jsx("div",{className:"space-y-4",children:c&&c.length>0?c.map((y,k)=>e.jsxs("div",{className:"bg-white p-4 rounded-lg border border-purple-100 shadow-sm flex gap-3",children:[e.jsx("div",{className:"mt-1",children:e.jsx("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center text-purple-600",children:e.jsx(oe,{size:14})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-gray-800",children:"Previous Recruiter Note"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:y.text}),e.jsx("p",{className:"text-xs text-gray-400 mt-2",children:y.date?.seconds?new Date(y.date.seconds*1e3).toLocaleDateString():"Past Activity"})]})]},k)):e.jsxs("div",{className:"text-center py-10 bg-white rounded-xl border border-dashed border-gray-300",children:[e.jsx(ne,{size:32,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-gray-500",children:"No shared history available for this driver."})]})})]})})]})]})})}function is(){const[t,r]=a.useState([]),[l,o]=a.useState(""),[x,p]=a.useState("actively_looking"),[i,v]=a.useState([]),[b,f]=a.useState(!1),[h,g]=a.useState(""),[d,s]=a.useState(1),[u,C]=a.useState(20),S=N=>{if(N==="CLEAR_ALL"){r([]);return}t.includes(N)?r(t.filter(w=>w!==N)):r([...t,N])},j=async()=>{f(!0),g(""),v([]),s(1);try{const N=X(R,"drivers"),w=[];x&&w.push(H("driverProfile.availability","==",x)),t.length>0&&w.push(H("driverProfile.type","in",t)),w.push(ie("createdAt","desc")),w.push(be(500));const L=Z(N,...w);let k=(await ae(L)).docs.map(z=>({id:z.id,...z.data()}));l&&(k=k.filter(z=>z.personalInfo?.state?.toUpperCase()===l)),v(k),k.length===0&&g("No drivers found matching your criteria.")}catch(N){console.error("Search error:",N),g("Search failed. Ensure you have created the required Index in Firebase Console.")}finally{f(!1)}},n=Math.ceil(i.length/u),c=a.useMemo(()=>{const N=(d-1)*u;return i.slice(N,N+u)},[i,d,u]);return{selectedTypes:t,selectedState:l,setSelectedState:o,statusFilter:x,setStatusFilter:p,results:i,loading:b,error:h,currentPage:d,setCurrentPage:s,itemsPerPage:u,setItemsPerPage:C,paginatedData:c,totalPages:n,toggleType:S,handleSearch:j}}function os({driver:t,onBack:r,activeTab:l,setActiveTab:o}){const x=t.personalInfo||{};return e.jsxs("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("button",{onClick:r,className:"p-2 hover:bg-white rounded-full border border-transparent hover:border-gray-200 transition",children:e.jsx(ht,{size:20,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-800",children:[K(x.firstName)," ",K(x.lastName)]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Driver Profile"})]})]}),e.jsxs("div",{className:"flex space-x-6 px-2",children:[e.jsxs("button",{onClick:()=>o("profile"),className:`pb-2 text-sm font-semibold transition-colors border-b-2 flex items-center gap-2 ${l==="profile"?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(Ce,{size:16})," Profile Info"]}),e.jsxs("button",{onClick:()=>o("network"),className:`pb-2 text-sm font-semibold transition-colors border-b-2 flex items-center gap-2 ${l==="network"?"border-purple-600 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(ne,{size:16})," Network Insights"]})]})]})}function cs({className:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"})]})}function ds({driver:t,onCallStart:r}){const l=t.personalInfo||{},o=t.driverProfile||{},x=i=>{if(!i)return"#";let v=ce(i);return v.length===10&&(v="1"+v),`https://t.me/+${v}`},p=()=>{r();const i=x(l.phone);i&&i!=="#"&&window.open(i,"_blank")};return e.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[e.jsx("div",{className:"w-20 h-20 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 text-2xl font-bold shrink-0 border-4 border-white shadow-sm",children:K(l.firstName).charAt(0)}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-1",children:[e.jsx("span",{className:"bg-blue-100 text-blue-800 px-2.5 py-0.5 rounded-full text-xs font-bold uppercase tracking-wide",children:o.type||"Unidentified"}),e.jsx("span",{className:"bg-green-100 text-green-800 px-2.5 py-0.5 rounded-full text-xs font-bold uppercase tracking-wide",children:o.availability?o.availability.replace("_"," "):"Available"})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-600",children:[e.jsx(ze,{size:16,className:"text-gray-400"}),e.jsxs("span",{children:[K(l.city),", ",K(l.state)]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-3",children:[l.phone&&e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:`tel:${l.phone}`,onClick:r,className:"flex items-center gap-2 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-700 rounded-lg text-sm font-medium transition",children:[e.jsx(re,{size:14})," ",ve(l.phone)]}),e.jsxs("button",{onClick:p,className:"flex items-center gap-2 px-3 py-1.5 bg-sky-50 hover:bg-sky-100 text-sky-700 rounded-lg text-sm font-medium transition",children:[e.jsx(cs,{className:"w-4 h-4"})," Telegram"]})]}),l.email&&!l.email.includes("placeholder.com")&&e.jsxs("a",{href:`mailto:${l.email}`,className:"flex items-center gap-2 px-3 py-1.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg text-sm font-medium transition",children:[e.jsx(Ye,{size:14})," Email"]})]})]})]})}function xs({driver:t}){const r=t.qualifications||{},l=t.driverProfile||{},o=t.licenses||[];return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2 border-b pb-2",children:[e.jsx(Se,{className:"text-blue-600",size:20})," Qualifications"]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Experience"}),e.jsx("span",{className:"font-semibold text-gray-900",children:Le(r.experienceYears)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Legal to Work?"}),e.jsx("span",{className:"font-semibold text-gray-900",children:r.legalWork||"Yes"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Source"}),e.jsx("span",{className:"font-semibold text-gray-900",children:l.isBulkUpload?"SafeHaul Network Leads":"App Signup"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl border border-gray-200 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2 border-b pb-2",children:[e.jsx(oe,{className:"text-blue-600",size:20})," License / CDL"]}),o.length>0?o.map((x,p)=>e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Class"}),e.jsx("span",{className:"font-semibold text-gray-900",children:x.class||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"State"}),e.jsx("span",{className:"font-semibold text-gray-900",children:x.state||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Endorsements"}),e.jsx("span",{className:"font-semibold text-gray-900",children:x.endorsements?.length>0?x.endorsements.join(", "):"None"})]})]},p)):e.jsx("p",{className:"text-sm text-gray-400 italic",children:"No license info on file."})]})]})}function us({onSend:t,sending:r,inviteSent:l}){return e.jsxs("div",{className:"bg-gray-50 border border-gray-200 p-6 rounded-xl flex flex-col sm:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-gray-900",children:"Official System Invite"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Send an automated email invite via SafeHaul."})]}),e.jsxs("button",{onClick:t,disabled:r||l,className:`px-6 py-2.5 font-bold rounded-lg shadow-sm transition flex items-center gap-2
                    ${l?"bg-green-600 text-white cursor-default":"bg-white border border-gray-300 text-gray-700 hover:bg-gray-100"} disabled:opacity-50`,children:[r?e.jsx(le,{className:"animate-spin",size:18}):l?e.jsx(Ne,{size:18}):e.jsx(Pe,{size:18}),r?"Sending...":l?"Invite Sent":"Send System Invite"]})]})}function ms({driver:t}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-purple-50 p-6 rounded-xl border border-purple-100",children:[e.jsxs("h3",{className:"text-lg font-bold text-purple-900 mb-2 flex items-center gap-2",children:[e.jsx(ne,{size:20})," Network Insights"]}),e.jsx("p",{className:"text-sm text-purple-700 mb-4",children:"Shared data from the SafeHaul network to help you make better decisions. Recruiter identities are anonymized."}),e.jsxs("div",{className:"bg-white p-5 rounded-lg border border-purple-100 shadow-sm",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Last Contact Result"}),t.lastNetworkCall?e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-full text-gray-500",children:e.jsx(re,{size:20})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-lg text-gray-900",children:t.lastNetworkCall.outcome}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:["Recorded: ",t.lastNetworkCall.timestamp?.seconds?new Date(t.lastNetworkCall.timestamp.seconds*1e3).toLocaleDateString():"Recently"]})]})]}):e.jsxs("div",{className:"text-center py-6 text-gray-400",children:[e.jsx(De,{size:32,className:"mx-auto mb-2 opacity-20"}),e.jsx("p",{children:"No recent network activity recorded."})]})]})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg border border-yellow-200 flex items-start gap-3",children:[e.jsx(qt,{className:"text-yellow-600 shrink-0 mt-0.5",size:18}),e.jsxs("div",{className:"text-sm text-yellow-800",children:[e.jsx("p",{className:"font-bold",children:"Privacy Note"}),e.jsx("p",{children:"This tab displays anonymized outcomes from other companies in the network. Your internal notes remain private and are never shared here."})]})]})]})}function hs({currentCompanyProfile:t}){const[r,l]=a.useState(null),[o,x]=a.useState(!1),p=window.location.origin;a.useEffect(()=>{(async()=>{if(q.currentUser)try{const f=await J(W(R,"users",q.currentUser.uid));f.exists()&&l(f.data().recruitingCode||q.currentUser.uid)}catch(f){console.error("Error fetching recruiter code",f)}})()},[]);const i=()=>{const b=p.replace(/\/$/,""),f=t?.appSlug||"apply";return`${b}/apply/${f}?r=${r||"general"}`},v=()=>{navigator.clipboard.writeText(i()),x(!0),setTimeout(()=>x(!1),2e3)};return e.jsx("div",{className:"bg-gradient-to-r from-indigo-50 to-blue-50 border border-blue-200 rounded-xl p-5 shadow-sm",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-white rounded-lg border border-blue-100 shadow-sm text-blue-600",children:e.jsx(ut,{size:20})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-blue-900",children:"Your Exclusive Application Link"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1 mb-3",children:["If this lead is interested, send them this link. They will be automatically assigned to ",e.jsx("strong",{children:"YOU"})," in your dashboard when they apply."]}),e.jsxs("div",{className:"flex items-center gap-2 bg-white p-2 rounded-lg border border-blue-200",children:[e.jsx("code",{className:"flex-1 text-xs font-mono text-gray-600 truncate px-2",children:i()}),e.jsxs("button",{onClick:v,className:"px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white text-xs font-bold rounded-md transition-all flex items-center gap-1.5",children:[o?e.jsx(Ne,{size:14}):e.jsx(Ze,{size:14}),o?"Copied":"Copy"]})]})]})]})})}function ps({driver:t,onBack:r,onCallStart:l}){const{currentCompanyProfile:o}=Ae(),[x,p]=a.useState("profile"),[i,v]=a.useState(!1),[b,f]=a.useState(!1),h=t.personalInfo||{},g=async()=>{if(!b){if(!h.email||h.email.includes("placeholder.com")){alert("This driver does not have a valid email address.");return}if(window.confirm(`Send job invite to ${h.firstName}?`)){v(!0);try{const s=await ye(je,"sendDriverInvite")({driverEmail:h.email,driverName:`${h.firstName} ${h.lastName}`,companyName:o?.companyName||"Our Company",message:""});s.data.success?(f(!0),alert("Invite sent successfully!")):alert("Failed to send: "+s.data.error)}catch(d){console.error(d),alert("Error sending invite: "+d.message)}finally{v(!1)}}}};return e.jsxs("div",{className:"flex flex-col h-full bg-white animate-in slide-in-from-right duration-300",children:[e.jsx(os,{driver:t,onBack:r,activeTab:x,setActiveTab:p}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6 md:p-8 space-y-8",children:x==="profile"?e.jsxs(e.Fragment,{children:[e.jsx(ds,{driver:t,onCallStart:l}),e.jsx(hs,{currentCompanyProfile:o}),e.jsx(xs,{driver:t}),e.jsx(us,{onSend:g,sending:i,inviteSent:b})]}):e.jsx(ms,{driver:t})})]})}const et=[{value:"companyDriverSolo",label:"Company Solo"},{value:"companyDriverTeam",label:"Company Team"},{value:"ownerOperatorSolo",label:"Owner Op Solo"},{value:"ownerOperatorTeam",label:"Owner Op Team"},{value:"leaseOperatorSolo",label:"Lease Solo"},{value:"leaseOperatorTeam",label:"Lease Team"},{value:"unidentified",label:"Unidentified"}],gs=["AL","AK","AZ","AR","CA","CO","CT","DE","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PA","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"];function bs({selectedTypes:t,toggleType:r,selectedState:l,setSelectedState:o,loading:x,onSearch:p}){return e.jsx("div",{className:"p-6 bg-gray-50 border-b border-gray-200 flex flex-col gap-4 shrink-0",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-6",children:[e.jsxs("div",{className:"lg:col-span-6",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Driver Types"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[et.map(i=>e.jsx("button",{onClick:()=>r(i.value),className:`px-3 py-1.5 text-xs font-medium rounded-full border transition-all ${t.includes(i.value)?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-gray-600 border-gray-300 hover:border-blue-400"}`,children:i.label},i.value)),t.length>0&&e.jsx("button",{onClick:()=>r("CLEAR_ALL"),className:"px-2 py-1.5 text-xs text-gray-500 underline hover:text-gray-800",children:"Clear"})]})]}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"State"}),e.jsxs("select",{className:"w-full p-2 border border-gray-300 rounded-lg bg-white text-sm focus:ring-2 focus:ring-blue-500 outline-none",value:l,onChange:i=>o(i.target.value),children:[e.jsx("option",{value:"",children:"Any State"}),gs.map(i=>e.jsx("option",{value:i,children:i},i))]})]}),e.jsx("div",{className:"lg:col-span-3 flex items-end",children:e.jsxs("button",{onClick:p,disabled:x,className:"w-full py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-bold rounded-lg flex items-center justify-center gap-2 transition disabled:opacity-50",children:[x?e.jsx(le,{className:"animate-spin",size:18}):e.jsx(we,{size:18}),x?"Searching...":"Search Drivers"]})})]})})}function fs({className:t}){return e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:t,children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4"})]})}function ys({results:t,paginatedData:r,loading:l,error:o,currentPage:x,setCurrentPage:p,itemsPerPage:i,setItemsPerPage:v,totalPages:b,onCallClick:f,onViewClick:h}){const g=s=>{if(!s)return"#";let u=ce(s);return u.length===10&&(u="1"+u),`https://t.me/+${u}`},d=(s,u)=>{f(s);const C=g(u);C&&C!=="#"&&window.open(C,"_blank")};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex-1 overflow-auto bg-white min-h-0",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Driver Name"}),e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Experience"}),e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-200",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-200 text-right",children:"Actions"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[l&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-20 text-gray-400",children:"Loading..."})}),!l&&o&&e.jsx("tr",{children:e.jsx("td",{colSpan:5,className:"text-center py-20 text-red-500",children:o})}),!l&&!o&&r.length===0&&e.jsx("tr",{children:e.jsxs("td",{colSpan:5,className:"text-center py-20 text-gray-400",children:[e.jsx(ot,{className:"mx-auto mb-2",size:32}),e.jsx("p",{children:'Select your filters and click "Search Drivers" to find candidates.'})]})}),!l&&r.map(s=>{const u=s.personalInfo||{},C=s.driverProfile||{},S=s.qualifications||{},j=et.find(n=>n.value===C.type)?.label||C.type||"N/A";return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center text-blue-600 font-bold shrink-0",children:K(u.firstName).charAt(0)}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-800",children:[K(u.firstName)," ",K(u.lastName)]}),e.jsx("p",{className:"text-xs text-gray-400",children:ve(u.phone)})]})]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ze,{size:14,className:"text-gray-400"}),K(u.city),", ",K(u.state)]})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:Le(S.experienceYears)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:j})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>f(s),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-full",title:"Log Phone Call",children:e.jsx(re,{size:18})}),e.jsx("button",{onClick:()=>d(s,u.phone),className:"p-2 text-sky-600 hover:bg-sky-50 rounded-full",title:"Open Telegram",children:e.jsx(fs,{className:"w-[18px] h-[18px]"})}),e.jsx("button",{onClick:()=>h(s),className:"px-3 py-1.5 text-xs font-bold text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-100",children:"View Profile"})]})})]},s.id)})]})]})}),t.length>0&&e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:["Total: ",e.jsx("strong",{children:t.length})]}),e.jsxs("select",{className:"p-1.5 border rounded-md text-sm",value:i,onChange:s=>{v(Number(s.target.value)),p(1)},children:[e.jsx("option",{value:10,children:"10 / page"}),e.jsx("option",{value:20,children:"20 / page"}),e.jsx("option",{value:50,children:"50 / page"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>p(s=>Math.max(1,s-1)),disabled:x===1,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-30",children:e.jsx(ct,{size:16})}),e.jsxs("span",{className:"text-sm font-medium px-2",children:["Page ",x," of ",b||1]}),e.jsx("button",{onClick:()=>p(s=>Math.min(b,s+1)),disabled:x>=b,className:"p-2 border rounded-lg hover:bg-white disabled:opacity-30",children:e.jsx(Qe,{size:16})})]})]})]})}function js({onClose:t}){const{currentCompanyProfile:r}=Ae(),[l,o]=a.useState(null),[x,p]=a.useState(null),{selectedTypes:i,toggleType:v,selectedState:b,setSelectedState:f,results:h,loading:g,error:d,currentPage:s,setCurrentPage:u,itemsPerPage:C,setItemsPerPage:S,paginatedData:j,totalPages:n,handleSearch:c}=is(),N=()=>{o(null),c()},w=y=>{const k=y.personalInfo||{},z=y.driverProfile||{},A={id:y.id,firstName:k.firstName,lastName:k.lastName,phone:k.phone,email:k.email,driverType:z.type,isPlatformLead:!0,source:"Search DB Call",status:"Attempted"};p({lead:A})},L=async()=>{if(c(),l)try{const y=W(R,"drivers",l.id),k=await J(y);k.exists()&&o({id:k.id,...k.data()})}catch(y){console.error("Failed to refresh driver data:",y)}};return e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm z-50 flex items-center justify-center p-4 animate-in fade-in duration-200",children:e.jsxs("div",{className:"bg-white w-full max-w-6xl h-[90vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden relative",children:[e.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 bg-gradient-to-r from-blue-600 to-indigo-700 text-white shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(we,{size:24}),e.jsx("h2",{className:"text-xl font-bold",children:"Driver Search"})]}),e.jsx("button",{onClick:t,className:"p-2 hover:bg-white/20 rounded-full transition",children:e.jsx(se,{size:24})})]}),l?e.jsx(ps,{driver:l,onBack:()=>o(null),onCallStart:()=>w(l)}):e.jsxs(e.Fragment,{children:[e.jsx(bs,{selectedTypes:i,toggleType:v,selectedState:b,setSelectedState:f,loading:g,onSearch:N}),e.jsx(ys,{results:h,paginatedData:j,loading:g,error:d,currentPage:s,setCurrentPage:u,itemsPerPage:C,setItemsPerPage:S,totalPages:n,onCallClick:w,onViewClick:o})]}),x&&e.jsx(Je,{lead:x.lead,onClose:()=>p(null),onDataUpdate:L})]})})}function vs(t,r){const[l,o]=a.useState(!1),[x,p]=a.useState(""),[i,v]=a.useState({created:0,updated:0}),[b,f]=a.useState("upload"),[h,g]=a.useState("unassigned"),[d,s]=a.useState([]),[u,C]=a.useState([]);return a.useEffect(()=>{if(!t)return;(async()=>{try{const c=Z(X(R,"memberships"),H("companyId","==",t)),N=await ae(c),w=[];for(const L of N.docs){const y=await J(W(R,"users",L.data().userId));y.exists()&&w.push({id:y.id,name:y.data().name})}s(w),C(w.map(L=>L.id))}catch(c){console.error("Error fetching team:",c)}})()},[t]),{uploading:l,progress:x,stats:i,step:b,setStep:f,assignmentMode:h,setAssignmentMode:g,teamMembers:d,selectedUserIds:u,setSelectedUserIds:C,uploadLeads:async(n,c)=>{if(h==="specific_user"&&u.length!==1)throw new Error("Please select exactly one user for assignment.");if(h==="round_robin"&&u.length===0)throw new Error("Please select at least one user for Round Robin distribution.");const N=q.currentUser;if(!N)throw new Error("You must be logged in.");const w=N.displayName||N.email||"Admin";o(!0),p("Syncing leads to database...");let L=[];h!=="unassigned"&&(L=d.filter(z=>u.includes(z.id)));let y=0,k=0;try{let A=xe(R),P=0,F=0;for(let I=0;I<n.length;I++){const m=n[I];p(`Processing ${I+1} / ${n.length}...`);let _=null,E=null;if(h!=="unassigned"&&L.length>0){const M=L[F%L.length];_=M.id,E=M.name,F++}const D=X(R,"companies",t,"leads");let T=null;if(!m.isEmailPlaceholder&&m.email){const M=Z(D,H("email","==",m.email)),O=await ae(M);O.empty||(T=O.docs[0])}if(!T&&m.normalizedPhone){const M=Z(D,H("normalizedPhone","==",m.normalizedPhone)),O=await ae(M);O.empty||(T=O.docs[0])}const $={firstName:m.firstName||"",lastName:m.lastName||"",email:m.email||"",phone:m.phone||"",normalizedPhone:m.normalizedPhone||"",experience:m.experience||"",driverType:m.driverType||"",city:m.city||"",state:m.state||"",source:c==="gsheet"?"Company Import (Sheet)":"Company Import (File)",isPlatformLead:!1,isEmailPlaceholder:!!m.isEmailPlaceholder,updatedAt:G()},Y={type:"system",performedBy:N.uid,performedByName:w,timestamp:G()};if(T){A.update(T.ref,$);const M=X(R,"companies",t,"leads",T.id,"activity_logs"),O=W(M);A.set(O,{...Y,action:"Lead Data Updated",details:"Updated via Bulk Upload match."}),k++}else{const M=W(D),O={...$,status:"New Lead",createdAt:G(),assignedTo:_,assignedToName:E};A.set(M,O);const U=X(R,"companies",t,"leads",M.id,"activity_logs"),B=W(U);A.set(B,{...Y,action:"Lead Created",details:"Created via Bulk Upload."}),y++}P++,P>=200&&(await A.commit(),A=xe(R),P=0)}P>0&&await A.commit(),v({created:y,updated:k}),f("success"),setTimeout(()=>{r&&r()},1500)}catch(z){throw console.error("Batch Upload Error:",z),new Error(z.message||"Upload failed. Check permissions.")}finally{o(!1)}},runDataRepair:async()=>{if(t){o(!0),p("Scanning for misformatted data...");try{const n=X(R,"companies",t,"leads"),c=await ae(n);let N=xe(R),w=0,L=0;const y=k=>!k||k.includes("@")||k.includes("placeholder.com")?!1:k.replace(/\D/g,"").length>=7;for(const k of c.docs){const A=k.data().email||"";if(y(A)){const P=A,F=ce(P),I=ve(P),_={email:`no_email_${Date.now()}_${k.id.substring(0,5)}@placeholder.com`,isEmailPlaceholder:!0,phone:I,normalizedPhone:F,updatedAt:G()};N.update(k.ref,_),L++,w++,w>=400&&(await N.commit(),N=xe(R),w=0)}}w>0&&await N.commit(),v({created:0,updated:L}),f("success"),p(`Repaired ${L} records.`),L>0?setTimeout(()=>{r&&r()},1500):(alert("Scan complete. No misformatted records found."),o(!1),f("upload"))}catch(n){console.error("Repair Failed:",n),alert("Repair failed: "+n.message),o(!1)}}}}}function Ns({companyId:t,onClose:r,onUploadComplete:l}){const{csvData:o,step:x,importMethod:p,setImportMethod:i,sheetUrl:v,setSheetUrl:b,processingSheet:f,handleSheetImport:h,handleFileChange:g,reset:d}=wt(),{uploading:s,progress:u,stats:C,step:S,setStep:j,assignmentMode:n,setAssignmentMode:c,teamMembers:N,selectedUserIds:w,setSelectedUserIds:L,uploadLeads:y,runDataRepair:k}=vs(t,l),z=S!=="upload"?S:x,A=async()=>{try{await y(o,p)}catch(D){alert(D.message)}},P=()=>{d(),j("upload")},F=D=>{L(T=>T.includes(D)?T.filter($=>$!==D):[...T,D])},I=()=>{w.length===N.length?L([]):L(N.map(D=>D.id))},m=()=>{confirm("This will scan your leads for 'Email' fields that look like Phone Numbers and move them to the correct field. Continue?")&&k()},_=e.jsx("div",{className:"space-y-6 mb-4",children:e.jsxs("div",{className:"bg-blue-50 p-4 rounded-xl border border-blue-100",children:[e.jsxs("h4",{className:"text-sm font-bold text-blue-900 mb-3 flex items-center gap-2",children:[e.jsx(ue,{size:16})," Lead Assignment"]}),e.jsxs("div",{className:"flex gap-3 mb-4",children:[e.jsx("button",{onClick:()=>c("unassigned"),className:`flex-1 py-2 px-3 text-xs font-semibold rounded border transition-all ${n==="unassigned"?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:"Unassigned (Pool)"}),e.jsx("button",{onClick:()=>c("round_robin"),className:`flex-1 py-2 px-3 text-xs font-semibold rounded border transition-all ${n==="round_robin"?"bg-blue-600 text-white border-blue-600 shadow-sm":"bg-white text-gray-600 border-gray-200 hover:bg-gray-50"}`,children:"Distribute to Team"})]}),n==="round_robin"&&e.jsxs("div",{className:"bg-white rounded-lg border border-blue-200 p-3 animate-in fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 pb-2 border-b border-gray-100",children:[e.jsx("span",{className:"text-xs font-bold text-gray-500 uppercase",children:"Select Recipients"}),e.jsx("button",{onClick:I,className:"text-xs text-blue-600 hover:underline font-medium",children:w.length===N.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2 max-h-40 overflow-y-auto custom-scrollbar",children:N.map(D=>{const T=w.includes(D.id);return e.jsxs("div",{onClick:()=>F(D.id),className:`flex items-center gap-2 p-2 rounded cursor-pointer transition-colors border ${T?"bg-blue-50 border-blue-200":"hover:bg-gray-50 border-transparent"}`,children:[T?e.jsx(Ge,{size:16,className:"text-blue-600"}):e.jsx(Xe,{size:16,className:"text-gray-300"}),e.jsx("span",{className:`text-sm ${T?"text-blue-900 font-medium":"text-gray-600"}`,children:D.name})]},D.id)})}),e.jsxs("p",{className:"text-[10px] text-blue-400 mt-2 text-center",children:["Leads will be distributed equally among the ",w.length," selected member",w.length!==1&&"s","."]})]})]})}),E=z==="upload"&&!s?e.jsxs("button",{onClick:m,className:"flex items-center gap-1 text-xs font-bold text-orange-600 hover:text-orange-800 hover:bg-orange-50 px-3 py-1.5 rounded-lg transition-colors border border-transparent hover:border-orange-200",title:"Fix leads where phone numbers were pasted into the email field",children:[s?e.jsx(le,{className:"animate-spin",size:14}):e.jsx(pt,{size:14})," Fix Data Mismatch"]}):null;return e.jsx(kt,{title:"Import Private Leads",step:z,importMethod:p,setImportMethod:i,sheetUrl:v,setSheetUrl:b,processingSheet:f,handleSheetImport:h,handleFileChange:g,csvData:o,reset:P,onConfirm:A,onClose:r,uploading:s,progress:u,stats:C,children:z==="preview"?_:null,headerAction:E})}function ws({companyId:t}){const[r,l]=a.useState(!1),[o,x]=a.useState([]),[p,i]=a.useState(!1),[v,b]=a.useState(""),f=()=>new Intl.DateTimeFormat("en-CA",{timeZone:"America/Chicago",year:"numeric",month:"2-digit",day:"2-digit"}).format(new Date),[h,g]=a.useState(f),[d,s]=a.useState(f);a.useEffect(()=>{t&&u()},[t]);const u=async()=>{i(!0),b("");try{const n=new Date(`${h}T00:00:00`),c=new Date(`${d}T23:59:59`),N=(P,F)=>{const I=new Date(P);return I.setTime(I.getTime()+F*60*60*1e3),I},w=new Date(h+"T00:00:00Z"),L=new Date(d+"T23:59:59Z"),y=N(w,6),k=N(L,6),A=await ye(je,"getTeamPerformanceHistory")({companyId:t,startDate:y.toISOString(),endDate:k.toISOString()});if(A.data.success){const P=A.data.data.sort((F,I)=>I.dials-F.dials);x(P)}}catch(n){console.error("Failed to fetch performance:",n),b("Failed to load data.")}finally{i(!1)}},C=n=>{n.preventDefault(),u()},S=o.reduce((n,c)=>n+c.dials,0),j=(n,c=!1)=>n===0?e.jsx("span",{className:"text-gray-300",children:"0"}):e.jsx("span",{className:c?"font-bold text-gray-900":"text-gray-700",children:n});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:()=>l(!0),className:"p-4 rounded-xl shadow-sm border bg-white border-gray-200 hover:border-gray-300 hover:shadow-md transition-all cursor-pointer flex flex-col justify-between h-full relative overflow-hidden group min-h-[90px]",children:[e.jsxs("div",{className:"flex justify-between items-start gap-3",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"text-[10px] font-bold uppercase tracking-wider text-gray-500 truncate",children:"Team Activity"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900 mt-1 text-blue-600 truncate",children:S}),e.jsx("p",{className:"text-[9px] text-gray-400 font-medium uppercase truncate",children:"Calls in range (Chicago)"})]}),e.jsx("div",{className:"p-2 rounded-lg bg-blue-50 text-blue-600 group-hover:bg-blue-100 transition-colors shrink-0",children:e.jsx(ue,{size:18})})]}),e.jsx("div",{className:"mt-2 pt-2 border-t border-gray-100 flex items-center gap-2",children:e.jsx("span",{className:"text-[10px] text-blue-600 font-bold hover:underline truncate",children:"Click to view report"})})]}),r&&e.jsx("div",{className:"fixed inset-0 bg-gray-900/60 backdrop-blur-sm flex items-center justify-center p-4 z-[100]",onClick:()=>l(!1),children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl h-[85vh] flex flex-col border border-gray-200 overflow-hidden animate-in zoom-in-95 duration-200",onClick:n=>n.stopPropagation(),children:[e.jsxs("div",{className:"p-5 border-b border-gray-200 flex flex-col md:flex-row justify-between items-start md:items-center bg-gray-50 gap-4 shrink-0",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(Me,{className:"text-yellow-500",size:24}),"Performance Report"]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analyze call metrics per agent (Timezone: Central US)."})]}),e.jsx("button",{onClick:()=>l(!1),className:"p-2 text-gray-400 hover:bg-white hover:text-gray-600 rounded-full transition-colors absolute top-4 right-4 md:static",children:e.jsx(se,{size:24})})]}),e.jsx("div",{className:"p-4 border-b border-gray-200 bg-white flex flex-col sm:flex-row items-center gap-4 shrink-0",children:e.jsxs("div",{className:"flex items-center gap-2 w-full sm:w-auto",children:[e.jsxs("div",{className:"bg-gray-100 p-2 rounded-lg flex items-center gap-2 border border-gray-200",children:[e.jsx(He,{size:16,className:"text-gray-500 ml-1"}),e.jsx("input",{type:"date",value:h,onChange:n=>g(n.target.value),className:"bg-transparent text-sm font-medium text-gray-700 outline-none cursor-pointer"}),e.jsx("span",{className:"text-gray-400",children:"-"}),e.jsx("input",{type:"date",value:d,onChange:n=>s(n.target.value),className:"bg-transparent text-sm font-medium text-gray-700 outline-none cursor-pointer"})]}),e.jsxs("button",{onClick:C,disabled:p,className:"px-4 py-2 bg-blue-600 text-white text-sm font-bold rounded-lg hover:bg-blue-700 transition shadow-sm flex items-center gap-2 disabled:opacity-50",children:[p?e.jsx(le,{className:"animate-spin",size:16}):e.jsx(we,{size:16}),"Filter"]})]})}),e.jsx("div",{className:"flex-1 overflow-auto bg-white p-0",children:e.jsxs("table",{className:"w-full text-left border-collapse",children:[e.jsx("thead",{className:"bg-gray-50 sticky top-0 z-10 shadow-sm text-xs font-bold text-gray-500 uppercase tracking-wider border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 bg-gray-50 w-16 text-center",children:"#"}),e.jsx("th",{className:"px-6 py-4 bg-gray-50",children:"Team Member"}),e.jsx("th",{className:"px-4 py-4 bg-gray-50 text-center",children:"Dials"}),e.jsx("th",{className:"px-4 py-4 bg-gray-50 text-center text-green-700",children:"Connected"}),e.jsx("th",{className:"px-4 py-4 bg-gray-50 text-center text-blue-700",children:"Callback"}),e.jsx("th",{className:"px-4 py-4 bg-gray-50 text-center text-gray-600",children:"Not Int."}),e.jsx("th",{className:"px-4 py-4 bg-gray-50 text-center text-orange-600",children:"Not Qual."}),e.jsx("th",{className:"px-4 py-4 bg-gray-50 text-center text-yellow-600",children:"VM / No Ans"})]})}),e.jsxs("tbody",{className:"divide-y divide-gray-100",children:[o.map((n,c)=>e.jsxs("tr",{className:"hover:bg-blue-50/50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 text-center",children:e.jsx("span",{className:`
                              inline-flex items-center justify-center w-6 h-6 rounded-full text-xs font-bold
                              ${c===0?"bg-yellow-100 text-yellow-700 ring-4 ring-yellow-50":c===1?"bg-gray-200 text-gray-700":c===2?"bg-orange-100 text-orange-800":"text-gray-400 bg-gray-50"}
                            `,children:c+1})}),e.jsxs("td",{className:"px-6 py-4 font-medium text-gray-900 flex items-center gap-2",children:[c===0&&e.jsx(Me,{size:14,className:"text-yellow-500 fill-yellow-500"}),n.name]}),e.jsx("td",{className:"px-4 py-4 text-center font-bold text-gray-900 bg-gray-50/50",children:j(n.dials,!0)}),e.jsx("td",{className:"px-4 py-4 text-center text-green-700 font-medium bg-green-50/30",children:j(n.connected)}),e.jsx("td",{className:"px-4 py-4 text-center text-blue-700",children:j(n.callback)}),e.jsx("td",{className:"px-4 py-4 text-center text-gray-600",children:j(n.notInt)}),e.jsx("td",{className:"px-4 py-4 text-center text-orange-600",children:j(n.notQual)}),e.jsx("td",{className:"px-4 py-4 text-center text-yellow-600",children:j(n.vm)})]},n.id)),o.length===0&&!p&&e.jsx("tr",{children:e.jsx("td",{colSpan:"8",className:"p-10 text-center text-gray-400 italic",children:"No activity found for this date range."})})]})]})}),e.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-200 text-right shrink-0",children:e.jsx("button",{onClick:()=>l(!1),className:"px-6 py-2 bg-white border border-gray-300 text-gray-700 font-bold rounded-lg hover:bg-gray-100 transition shadow-sm",children:"Close"})})]})})]})}function ks({companyId:t,selectedLeadIds:r,onClose:l,onSuccess:o}){const[x,p]=a.useState([]),[i,v]=a.useState(!0),[b,f]=a.useState(!1),[h,g]=a.useState("manual"),[d,s]=a.useState(""),[u,C]=a.useState([]);a.useEffect(()=>{(async()=>{try{const c=Z(X(R,"memberships"),H("companyId","==",t)),N=await ae(c),w=[];for(const L of N.docs)try{const y=await J(W(R,"users",L.data().userId));y.exists()&&w.push({id:y.id,name:y.data().name})}catch(y){console.error(y)}w.sort((L,y)=>(L.name||"").localeCompare(y.name||"")),p(w),C(w.map(L=>L.id))}catch(c){console.error("Error loading team:",c)}finally{v(!1)}})()},[t]);const S=async()=>{if(h==="manual"&&!d)return alert("Please select a recruiter.");if(h==="round_robin"&&u.length===0)return alert("Please select at least one recruiter.");f(!0);try{const n=xe(R),c=q.currentUser,N=c?.displayName||c?.email||"Admin";let w=0;const L=h==="round_robin"?x.filter(y=>u.includes(y.id)):[];r.forEach(y=>{const k=W(R,"companies",t,"leads",y);let z,A;if(h==="manual")z=d,A=x.find(P=>P.id===d)?.name||"Unknown";else{if(L.length===0)return;const P=L[w%L.length];z=P.id,A=P.name,w++}n.update(k,{assignedTo:z,assignedToName:A,assignedAt:G(),updatedAt:G()})}),await n.commit(),await Promise.all(r.map(y=>St(t,"leads",y,"Lead Assigned",`Assigned to ${h==="manual"?"specific user":"round-robin pool"}`,"assignment"))),o(),l()}catch(n){console.error("Assignment error:",n),alert("Failed to assign leads.")}finally{f(!1)}},j=n=>{C(c=>c.includes(n)?c.filter(N=>N!==n):[...c,n])};return e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[60] backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-lg border border-gray-200 overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-5 border-b border-gray-200 flex justify-between items-center bg-gray-50",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(ue,{className:"text-blue-600",size:20})," Assign Leads"]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Assigning ",e.jsx("strong",{className:"text-gray-800",children:r.length})," selected leads"]})]}),e.jsx("button",{onClick:l,className:"p-2 hover:bg-gray-200 rounded-full",children:e.jsx(se,{size:20})})]}),e.jsx("div",{className:"p-6 overflow-y-auto",children:i?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(le,{className:"animate-spin text-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>g("manual"),className:`flex-1 py-3 px-2 border rounded-xl flex flex-col items-center gap-2 transition-all ${h==="manual"?"bg-blue-50 border-blue-500 text-blue-700 ring-1 ring-blue-500":"bg-white border-gray-200 text-gray-600 hover:border-gray-300"}`,children:[e.jsx(Te,{size:20}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Manual Pick"})]}),e.jsxs("button",{onClick:()=>g("round_robin"),className:`flex-1 py-3 px-2 border rounded-xl flex flex-col items-center gap-2 transition-all ${h==="round_robin"?"bg-purple-50 border-purple-500 text-purple-700 ring-1 ring-purple-500":"bg-white border-gray-200 text-gray-600 hover:border-gray-300"}`,children:[e.jsx(ue,{size:20}),e.jsx("span",{className:"text-xs font-bold uppercase",children:"Round Robin"})]})]}),h==="manual"&&e.jsxs("div",{className:"space-y-2 animate-in fade-in",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Select Recruiter"}),e.jsxs("select",{className:`w-full p-3 border border-gray-300 
 rounded-lg outline-none focus:ring-2 focus:ring-blue-500`,value:d,onChange:n=>s(n.target.value),children:[e.jsx("option",{value:"",children:"-- Choose User --"}),x.map(n=>e.jsx("option",{value:n.id,children:n.name},n.id))]})]}),h==="round_robin"&&e.jsxs("div",{className:"space-y-2 animate-in fade-in",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase",children:"Distribute Amongst"}),e.jsx("button",{type:"button",onClick:()=>C(x.map(n=>n.id)),className:"text-xs text-purple-600 hover:underline font-bold",children:"Select All"})]}),e.jsx("div",{className:"border border-gray-200 rounded-lg max-h-48 overflow-y-auto",children:x.map(n=>{const c=u.includes(n.id);return e.jsxs("div",{onClick:()=>j(n.id),className:`flex items-center gap-3 p-3 border-b last:border-0 cursor-pointer transition-colors ${c?"bg-purple-50":"hover:bg-gray-50"}`,children:[c?e.jsx(Ge,{size:16,className:"text-purple-600"}):e.jsx(Xe,{size:16,className:"text-gray-400"}),e.jsx("span",{className:`text-sm ${c?"text-purple-900 font-medium":"text-gray-600"}`,children:n.name})]},n.id)})})]})]})}),e.jsxs("div",{className:"p-4 border-t border-gray-200 bg-gray-50 flex justify-end gap-3",children:[e.jsx("button",{onClick:l,className:"px-4 py-2 text-gray-600 font-bold hover:bg-gray-200 rounded-lg transition-colors",children:"Cancel"}),e.jsxs("button",{onClick:S,disabled:b||i,className:"px-6 py-2 bg-blue-600 text-white font-bold rounded-lg hover:bg-blue-700 transition-colors shadow-sm disabled:opacity-50 flex items-center gap-2",children:[b?e.jsx(le,{className:"animate-spin",size:16}):e.jsx(Ne,{size:16}),b?"Assigning...":"Confirm Assignment"]})]})]})})}function Ss(t){const[r,l]=a.useState(!1),[o,x]=a.useState(!0);return a.useEffect(()=>{let i=!0;async function v(){if(!t?.uid){x(!1);return}try{const b=W(R,"users",t.uid),f=await J(b);if(f.exists()){const h=f.data();i&&l(!h.onboardingTourCompleted)}else i&&l(!0)}catch(b){console.error("Error checking onboarding status:",b)}finally{i&&x(!1)}}return v(),()=>{i=!1}},[t]),{showTour:r,loading:o,completeTour:async()=>{if(t?.uid){l(!1);try{const i=W(R,"users",t.uid);await We(i,{onboardingTourCompleted:!0,tourCompletedAt:G()})}catch(i){console.error("Failed to mark tour as complete:",i)}}}}}const de=[{target:null,title:"Welcome to SafeHaul",content:"Let's take a quick tour of your new recruiting dashboard to get you started.",position:"center"},{target:"stat-card-applications",title:"Direct Applications",content:"View full applications submitted directly to your company here.",position:"bottom"},{target:"stat-card-find_driver",title:"SafeHaul Leads",content:"Access our exclusive pool of high-intent drivers. These leads are time-sensitive!",position:"bottom"},{target:"stat-card-company_leads",title:"Imported Leads",content:"Manage leads you've imported via Excel or Google Sheets.",position:"bottom"},{target:"user-menu-btn",title:"Settings & Profile",content:"Update your company profile, manage your team, and configure email settings here.",position:"left"}];function Cs({onComplete:t}){const[r,l]=a.useState(0),[o,x]=a.useState({top:0,left:0}),[p,i]=a.useState(!1),v=de[r],b=()=>{if(v.position==="center"){i(!0);return}const g=document.getElementById(v.target);if(g){const d=g.getBoundingClientRect(),s=window.scrollY,u=window.scrollX;let C=0,S=0;v.position==="bottom"?(C=d.bottom+s+15,S=d.left+u+d.width/2-160):v.position==="left"&&(C=d.top+s,S=d.left+u-340),S<10&&(S=10),x({top:C,left:S}),i(!0),g.scrollIntoView({behavior:"smooth",block:"center"})}else console.warn(`Target ${v.target} not found, skipping.`),f()};a.useEffect(()=>{const g=setTimeout(b,500);return window.addEventListener("resize",b),()=>{clearTimeout(g),window.removeEventListener("resize",b)}},[r]);const f=()=>{r<de.length-1?(i(!1),l(g=>g+1)):t()};if(!p&&v.position!=="center")return null;const h=v.position==="center";return e.jsxs("div",{className:"fixed inset-0 z-[100] pointer-events-none",children:[h&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm pointer-events-auto transition-opacity duration-500"}),e.jsxs("div",{className:`absolute pointer-events-auto bg-white rounded-xl shadow-2xl border border-blue-100 p-6 w-80 transition-all duration-500 ease-in-out ${h?"top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2":""}`,style:h?{}:{top:o.top,left:o.left},children:[!h&&v.position==="bottom"&&e.jsx("div",{className:"absolute -top-2 left-1/2 -translate-x-1/2 w-4 h-4 bg-white border-t border-l border-blue-100 transform rotate-45"}),!h&&v.position==="left"&&e.jsx("div",{className:"absolute top-6 -right-2 w-4 h-4 bg-white border-t border-r border-blue-100 transform rotate-45"}),e.jsxs("div",{className:"flex justify-between items-start mb-3 relative z-10",children:[e.jsx("div",{className:"bg-yellow-100 p-2 rounded-lg text-yellow-700",children:e.jsx(De,{size:20,fill:"currentColor",className:"text-yellow-500/20"})}),e.jsx("button",{onClick:t,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(se,{size:18})})]}),e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-2",children:v.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-6 leading-relaxed",children:v.content}),e.jsxs("div",{className:"flex justify-between items-center relative z-10",children:[e.jsx("div",{className:"flex gap-1",children:de.map((g,d)=>e.jsx("div",{className:`w-2 h-2 rounded-full transition-colors ${d===r?"bg-blue-600":"bg-gray-200"}`},d))}),e.jsxs("button",{onClick:f,className:"flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-bold rounded-lg hover:bg-blue-700 transition-all shadow-md hover:shadow-lg hover:-translate-y-0.5",children:[r===de.length-1?"Finish":"Next",r===de.length-1?e.jsx(me,{size:16}):e.jsx(Qe,{size:16})]})]})]})]})}function Is(){const{currentCompanyProfile:t,handleLogout:r,returnToCompanyChooser:l,currentUserClaims:o,currentUser:x}=Ae(),{showError:p,showSuccess:i}=Ve(),v=Be(),{showTour:b,completeTour:f}=Ss(x),h=t?.id,g=t?.companyName,d=o?.roles?.[h]==="company_admin"||o?.roles?.globalRole==="super_admin",s=Gt(h),[u,C]=a.useState("Admin User"),[S,j]=a.useState(""),[n,c]=a.useState(!1),[N,w]=a.useState(null),[L,y]=a.useState(!1),[k,z]=a.useState(!1),[A,P]=a.useState(null),[F,I]=a.useState(!1),[m,_]=a.useState(!1),[E,D]=a.useState([]);a.useEffect(()=>{const V=q.onAuthStateChanged(async Q=>{if(Q){j(Q.email);const ke=await mt(Q.uid);ke&&ke.name&&C(ke.name)}});return()=>V()},[]);const T=(V,Q)=>{V&&V.stopPropagation(),Q&&Q.phone?P({lead:Q}):p("No phone number available for this driver.")},$=()=>{t?.features?.searchDB===!0?y(!0):_(!0)},Y=()=>{_(!1),s.setActiveTab("find_driver")},M=V=>{D(V)},O=()=>{i("Leads assigned successfully."),s.refreshData()},U=()=>{switch(s.activeTab){case"applications":return e.jsx(Ce,{size:18,className:"text-blue-600"});case"find_driver":return e.jsx(fe,{size:18,className:"text-purple-600"});case"company_leads":return e.jsx(oe,{size:18,className:"text-orange-600"});case"my_leads":return e.jsx(Fe,{size:18,className:"text-green-600"});default:return e.jsx(Ot,{size:18,className:"text-gray-600"})}},B=()=>N?s.activeTab==="find_driver"||N.isPlatformLead?e.jsx(ns,{lead:N,onClose:()=>w(null),onCallStart:()=>T(null,N)}):e.jsx(Ct,{companyId:h,applicationId:N.id,onClosePanel:()=>w(null),onStatusUpdate:s.refreshData,isCompanyAdmin:d,onPhoneClick:V=>T(V,N)},N.id):null,ee=d&&(s.activeTab==="find_driver"||s.activeTab==="company_leads");return e.jsxs(e.Fragment,{children:[e.jsxs("div",{id:"company-admin-container",className:"h-screen bg-gray-50 flex flex-col font-sans",children:[e.jsx("header",{className:"sticky top-0 z-50 bg-white border-b border-gray-200 shrink-0 px-6 py-3 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-center max-w-[1600px] mx-auto w-full",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-10 w-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold shadow-blue-200 shadow-lg",children:g?g.charAt(0):"C"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-bold text-gray-900 leading-tight",children:g||"Company Dashboard"}),e.jsx("p",{className:"text-xs text-gray-500 font-medium",children:"Recruiter Workspace"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[d&&e.jsxs("button",{onClick:()=>z(!0),className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-white border border-gray-200 text-gray-700 text-sm font-semibold rounded-lg hover:bg-gray-50 hover:border-gray-300 transition-all shadow-sm",children:[e.jsx(Dt,{size:16})," Import Leads"]}),e.jsxs("button",{onClick:$,className:"hidden sm:flex items-center gap-2 px-4 py-2 bg-blue-600 text-white text-sm font-semibold rounded-lg hover:bg-blue-700 transition-all shadow-md hover:shadow-lg",children:[e.jsx(we,{size:16})," Search For Drivers"]}),e.jsx("div",{className:"h-8 w-px bg-gray-200 mx-1"}),e.jsx(Qt,{userId:q.currentUser?.uid}),e.jsxs("div",{className:"relative ml-2",children:[e.jsx("button",{id:"user-menu-btn",onClick:()=>c(!n),className:"flex items-center gap-2 focus:outline-none",children:e.jsx("div",{className:"w-9 h-9 rounded-full bg-gray-100 border border-gray-200 text-gray-600 flex items-center justify-center font-bold text-sm hover:bg-gray-200 transition",children:u.charAt(0).toUpperCase()})}),n&&e.jsxs("div",{className:"absolute top-full right-0 mt-2 w-56 bg-white rounded-xl shadow-xl border border-gray-100 overflow-hidden z-50 animate-in fade-in zoom-in-95 duration-100",onClick:()=>c(!1),children:[e.jsxs("div",{className:"p-3 border-b border-gray-100 bg-gray-50",children:[e.jsx("p",{className:"text-sm font-bold text-gray-900 truncate",children:u}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:S})]}),e.jsxs("nav",{className:"p-1",children:[e.jsxs("button",{onClick:()=>v("/company/settings"),className:"w-full text-left flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(gt,{size:16})," Settings"]}),e.jsxs("button",{onClick:l,className:"w-full text-left flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-gray-700 hover:bg-gray-100 transition-colors",children:[e.jsx(Ht,{size:16})," Switch Company"]}),e.jsx("div",{className:"h-px bg-gray-100 my-1"}),e.jsxs("button",{onClick:r,className:"w-full text-left flex items-center gap-2 px-3 py-2 rounded-lg text-sm text-red-600 hover:bg-red-50 transition-colors",children:[e.jsx(dt,{size:16})," Logout"]})]})]})]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-hidden flex flex-col max-w-[1600px] mx-auto w-full p-4 sm:p-6",children:[e.jsxs("div",{className:"md:hidden mb-4 shrink-0",children:[e.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 px-1",children:"Current View"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:U()}),e.jsxs("select",{value:s.activeTab,onChange:V=>s.setActiveTab(V.target.value),className:"w-full pl-10 pr-10 py-3 bg-white border border-gray-300 rounded-xl shadow-sm appearance-none font-bold text-gray-800 focus:ring-2 focus:ring-blue-500 outline-none transition-shadow",children:[e.jsxs("option",{value:"applications",children:["Applications (",s.counts?.applications||0,")"]}),e.jsxs("option",{value:"find_driver",children:["SafeHaul Leads (",s.counts?.platformLeads||0,")"]}),e.jsxs("option",{value:"company_leads",children:["Company Leads (",s.counts?.companyLeads||0,")"]}),e.jsxs("option",{value:"my_leads",children:["My Leads (",s.counts?.myLeads||0,")"]})]}),e.jsx("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none text-gray-500",children:e.jsx(It,{size:16})})]})]}),e.jsxs("div",{className:"hidden md:grid md:grid-cols-3 lg:grid-cols-5 gap-3 mb-6 shrink-0",children:[e.jsx(ge,{id:"stat-card-applications",title:"Applications",value:s.counts?.applications||0,icon:e.jsx(Ce,{size:20}),active:s.activeTab==="applications",colorClass:"ring-blue-500 bg-blue-500",onClick:()=>s.setActiveTab("applications")}),e.jsx(ge,{id:"stat-card-find_driver",title:"SafeHaul Leads",value:s.counts?.platformLeads||0,icon:e.jsx(fe,{size:20}),active:s.activeTab==="find_driver",colorClass:"ring-purple-500 bg-purple-500",onClick:()=>s.setActiveTab("find_driver")}),e.jsx(ge,{id:"stat-card-company_leads",title:"Company Leads",value:s.counts?.companyLeads||0,icon:e.jsx(oe,{size:20}),active:s.activeTab==="company_leads",colorClass:"ring-orange-500 bg-orange-500",onClick:()=>s.setActiveTab("company_leads")}),e.jsx(ge,{id:"stat-card-my_leads",title:"My Leads",value:s.counts?.myLeads||0,icon:e.jsx(Fe,{size:20}),active:s.activeTab==="my_leads",colorClass:"ring-green-500 bg-green-500",onClick:()=>s.setActiveTab("my_leads")}),e.jsx("div",{className:"md:col-span-3 lg:col-span-1",children:e.jsx(ws,{companyId:h})})]}),e.jsx("div",{className:"flex-1 flex flex-col overflow-hidden min-h-0 bg-white rounded-xl shadow-sm border border-gray-200",children:e.jsx(xt,{activeTab:s.activeTab,loading:s.loading,data:s.paginatedData,totalCount:s.totalCount,selectedId:N?.id,onSelect:w,onPhoneClick:T,searchQuery:s.searchQuery,setSearchQuery:s.setSearchQuery,filters:s.filters,setFilters:s.setFilters,currentPage:s.currentPage,itemsPerPage:s.itemsPerPage,totalPages:s.totalPages,setItemsPerPage:s.setItemsPerPage,nextPage:s.nextPage,prevPage:s.prevPage,latestBatchTime:s.latestBatchTime,onShowSafeHaulInfo:()=>I(!0),canAssign:ee,onAssignLeads:M})})]})]}),B(),L&&e.jsx(js,{onClose:()=>y(!1)}),A&&e.jsx(Je,{lead:A.lead,companyId:h,onClose:()=>P(null),onUpdate:s.refreshData}),k&&d&&e.jsx(Ns,{companyId:h,onClose:()=>z(!1),onUploadComplete:s.refreshData}),F&&e.jsx(rs,{onClose:()=>I(!1)}),m&&e.jsx(Xt,{onClose:()=>_(!1),onGoToLeads:Y,featureName:"Search For Drivers"}),E.length>0&&e.jsx(ks,{companyId:h,selectedLeadIds:E,onClose:()=>D([]),onSuccess:O}),b&&e.jsx(Cs,{onComplete:f})]})}function Fe({size:t,className:r}){return e.jsx(ue,{size:t,className:r})}export{Is as CompanyAdminDashboard};
