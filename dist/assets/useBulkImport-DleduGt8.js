import{c as S,C as s}from"./index-Eut2KIY5.js";const M=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],x=S("file-spreadsheet",M);function A(){const[f,n]=s.useState([]),[u,i]=s.useState(!1),[m,l]=s.useState("upload"),[y,k]=s.useState("file"),[c,d]=s.useState(""),p=async r=>new Promise((o,t)=>{try{const e=new Worker(new URL("/assets/import.worker-NAgz6X5H.js",import.meta.url),{type:"module"});e.onmessage=a=>{const{success:g,data:w,error:h}=a.data;g?(n(w),l("preview"),o()):(console.error("Worker Parse Error:",h),alert("Error reading file: "+h),t(new Error(h))),e.terminate()},e.onerror=a=>{console.error("Worker Error:",a),alert("Worker failed to process file."),e.terminate(),t(a)},e.postMessage({buffer:r})}catch(e){console.error("Main Thread Error:",e),alert("Failed to start import worker."),t(e)}});return{csvData:f,step:m,setStep:l,importMethod:y,setImportMethod:k,sheetUrl:c,setSheetUrl:d,processingSheet:u,handleFileChange:async r=>{const o=r.target.files[0];if(!o)return;n([]);const t=new FileReader;t.onload=async e=>await p(e.target.result),t.readAsArrayBuffer(o),r.target.value=""},handleSheetImport:async()=>{if(!c)return alert("Please enter a Google Sheet URL.");const r=c.match(/\/d\/([a-zA-Z0-9-_]+)/);if(!r||!r[1])return alert("Invalid Google Sheet URL.");const t=`https://docs.google.com/spreadsheets/d/${r[1]}/export?format=xlsx`;i(!0);try{const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch sheet. Check permissions (Anyone with link).");const a=await e.arrayBuffer();await p(a)}catch(e){console.error("Sheet Error:",e),alert("Error importing sheet: "+e.message)}finally{i(!1)}},reset:()=>{n([]),l("upload"),d("")}}}export{x as F,A as u};
